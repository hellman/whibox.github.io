#include <gmp.h>
unsigned char opcodes_none[] = 
"12_4Z!5oq%0_V<_3KOp7yKR}FCl;@N50HPv.neiT<+`CB5wiU}1ZMRS,pM/;yBwZv|;YDYWDcwSi"
"syS8yWhUfthv(`tLtG%3N4xrRqQHQZhO]=ted6YT|;Wx|RCovi4qK+Y;GsnYl^1Tq}d04h,X~,@t"
"26IAyO_ Ei3[YpgKY__yk1 ?$de8nTm/z?{,zDrv+[anH$pDNQ.b8aB}bBvAo1K}xkLwsdvQkFm7"
"Zr]Xb.jo~+r`csUr/tgBx{zi0uwup8?fh:Q.jb6bX>#SG|6lu$%mmWm)&FBSJ905FR5}J8L5HBuM"
"uh5OaeT`m:4ceO.t}s`VF:_4KA#fSxMedGojsa8K[@#k_PkEWYl>fzo0imL36S<yUj7wn:c7r]mB"
"`74D&;`ZdtsIoAJuv)wf({=QV.}H9gGKP>csykv17r^fT=*U(qz1osu[gFYt4w=,p92j.`E48P)6"
"V+zC51nU7gky&YQa}ac6({I{NBUa]q3(yq:6/0S4ycD$B&8LR3]NmS3nd8;zym!%b^tLddLfALgI"
"V7.OshY|:g{S[3Qiq>Y+sZSBb*#! }OI=LLDM0S>cXSqO{1d)FM^6by<ns Q]`/gUS3QEzp9o>FT"
"~r6^E4:6(* G*m]PoziZ@xx1/g,e3HUm1WF[NFe_I<&hB@7@[;@yM:BrXEX,gQQi&#N+,g4EJ)N)"
"l$#<v~5<l@?5G{{Cy<iel(U{Au:ZVD[Rp0RjiK!b7[3*i<SMf9CTU$E7}.s&2n?mow}tzN$hLlDo"
"RX.p==n).;&3N[D^C,yn nBJ?7w&n@*vc&6+<f,NNIp9]{MoY.*(R#Yljpve3DS=a@<0R>z;T3o?"
"7rIa%P,@z7.d7#&Xc;z&yWyO.oAi8mTOCTvnjNFi.e!}lyjKoP#g+0a7d[`;hapa+}Z=/Y+av{pL"
"E=,BEYDB:@qw4oeFX5B4s%P$^.Tey7&Sz~YOUmDsM/P)A#YfGvIy5^.,P@88E.MnY!~x%~<)*IN}"
"4?`aLfXff{Iy`dCbqjmYnAF`YBt|XeRb+/eZIBGlA6$@0e;`B/2{[Oh`g73}Y3qS%DIKauD4)t=,"
"/?p;X&j_e6F1$Xt5;ci)v#gLCqVYB*Q0=5RWSzZa&kq!EfR}7J7Fr<f+J>%3Wp1S lR|9F_D!QT8"
"lk4Osg8{0o|dmI5/%j$sPi_Df(CS+&4Mvnq:zJ;`.SUtU3dUDYey(PK.oX@p.<lk7IE0Ioo{5MtO"
"cyOVxikr<zB},gX6G>J$z}WPHf!RzR2R /u37@e@Ffo|qTxD@t:R83#Do~+WQ.T+_phVI_mwIT]x"
"}$&XDa@2?Cb5VYUQZkTec*I?{R&e+n94;B78,%pU,`o}~C},D_cVvaIT&QY`kfKd?G=U+I.)DaN9"
"A}(h.wu6]q**6K]SQ/W~tE,BJ7C=%errh|ts:7.lmj5pF^[,#d%hJrBLR7)l KM<[eMg>>/={nt}"
"CA@+)r29GBfJKaO*R&K3yrup2@Yop:&,pPD%<^<AJ;E|ikD{zit&(+we~;fu>>)Vv4xm@_`}~JH1"
"(isaAz% D:dn3UL!l4eN~tP#?]!+p`kOa5$H_Cuk/^5^S~Nr:_<L>nc~5gzSUMN.,#D|8Kli]9Rd"
"D5h<eK!WdQYB&EPRUy9Q:#>B|`gBp`P2Gt9eROkSZ/4XCJlhmDH9mOKas5}{{G5~B{eTZ!P <$Of"
"*I93lh(^/iV(nFiDl+D`#*X|/M*u}SQ7ZUz*SHxKMD)= Pfe/?ul|NPtH{HvK|7n06DKcj)pW3?J"
"NOk$I?hX_xU:I|K4EDGXt8lHD!{uUMNf&a`5{K;nD6a(4pD)(*)l,xNZhCo~9Ib,60UDi#D/g;EN"
"<s*?=~Q#4zEdfEr*XF+ni0sXok1EBv>f=4eGd>RxkL]_JY~&g/*c28@:5eo6T6i?I( Z~w{L<^}x"
"h/OjS5E8r!w/Q|Abf{{6HT6{^u,ch51Fvkda_+hHQT_yJsn/Bb*iQ50Xd,tEoc,&zRy7P{dq[t9G"
"LsL+n9r)XnZv)e!{mcV]IBoR}23>*$wck#TBAw4&[0n$UmYv+hh<krSn_Y{m`=#GJ_:hcdt;kG70"
"pN>0PQS**2ggRBbk$$eK|hEyvk>nt#m=;TE=&Gn70yRi=DlEhQYjw^{~LMOiSB5qdwin>SuI=,GJ"
"u~UVA?&,s% .]%zb,OFd#21=X~j=_UC[_/mlKt^:JBXQPGa=?kP;6[3YQrGPDc^.p#$*klPDQf^T"
" 34*wPu[yCg`AYgF:jK*00UQ3sfQa8B;&_ILHG;tIHjaxJnSt({$j|CNsFY#[f_?=[ XFDCu~pYp"
"N?NDo[p@n5}Y7q,h8;}~buS^9K$(.LKr4VbjJl.P{%Y%04}`|4=4I:GSQ&(MW,,(=:LG.v:R+X9V"
"]@?ye+1x!H_p;GV7rcGvfjq}^5SSne#H)G)8ZEncV^wq;Mf&.`gW$05nt)R#K>.n!Sel(5`Vpx#n"
"@eGYDf/qgFmYtNp{rW;p`!VDgpd0i+0X=%Ui(??cLZVXw[qopggge?Ia4?5C*i!~Ze<=H.(sZkAP"
"WDUUCd]?v.Op8^#VJ@3eC?5@.8SDQNfUGX[,LNgU:5,0p0QexplKbXwnM!kk7,.p[XSwnC0,!YU?"
"t:vzvw.{E1`u3{B5[x_P}o%mYDk8@fsc!$F[dy71^kRqw5 s#ylFN.jP2},5,WBCeNl`Tm8?k$G7"
"lt(@.dLGR]jfh#K]qk^w0P#qm,W`bs1UqPDS){8G)l{/s8y*+E<9R$M`Ct7U9E_sbuojaDT#@a(G"
"LbH*~5J&&@b5*kJ&CRS3;;(GR3t2#w58?h_l$#woOTC|DL0?|3${TpX}} WVs hzdQ$IlgS:]}p="
"$yrQc1phbh^fVEGP^uqufM`8C#Rmd#BJW4z}M,6bzNCF[j&V]f|=<[Y97?R!M%UE#KFX_.nd3I}~"
"uJpD^mC(+jn [B*i:`mv_d.{Wv]fnx9iR2_|`wl{s[D#}5qSP{^7Nc(n&h;{|TBH7qD;*};O0{bx"
"8ni7pH(L/]YluJ[^xr*W7[G3$8uY#|x,P=(BHv /&U!.c&em$Pot2;1FWydFFVHr`7[Z=891zD^Z"
")$t6qpBnKha2 n 6F?RX^+X%YTPUY{J*){x@x?+Gg4ong]}[Q(Xye5JR?%qu247lkzPZph;@]}rN"
"CG%!F&^$Fc8[lS;4kW_z#o&Df>;,O,W:ReP8dL`<:lGzt/5?fTF%O+g9LsG(Gd>^,j8|jJEwn_80"
"cWa.~Sa+{@a/_%X.C4t#WYtXf3{mPSBopwT7~1vZfqdHA@Dui&kPTHf#xQVE{m/?:~uM}f:o6:ji"
"5pGhnvKkP>1doEbkyk%q]:FD#5[=>)WzMA;CkT7XQ<uD51XRC?VKn_}I|#Q97Z`3=4sN^YQsD3Rp"
"hJF9`s?wn]1Wl@:+1u`e#;_rck7LpEMPqRey}&`/%oWzq=PH{]j>:yX`f&l1>e0bTf/JRHR|^_bg"
"u9%2L*0]}<8$w)e7L[ih6%^NkoK`T4/[`mW3:~2}f(0JFWCPS.%wxV:xP[R:`$GLKm#c10tfO,Jp"
"]#Ht^n~SwH6LSXR2w*6ibb3erpvae.~pl!>_LcNt!{<l)&:42.k&KPPk]avaSG_5)if+fcC*@e$Q"
"w_QYDCfA3bm8jQVgu@cw=wH}:4w+VY8I*9,]znugBP}btA=TM#j>+5lsYjw`V&<,U$WZ{z;R:G(d"
"wu&E[Nn|u!Hzii|KWsUm7XK9OnR2aL~xO_)r|d r)Ph)LN;z/?p%S@l|{jRNE=)d+Kk];a6_.r0M"
"iG46XfLP{x!2^Up3!:cuj+WT5&AQ4tiS:y.y9g6hNK@fm=D(~%9NyI<g5KU&de*wn7:<Q)PUozBd"
"CbM}`O2>x+3JiLNwo#I#:G_)5huT&9n}9BsnJ72FTiOK<Tmvt<wMUKGp j^FNN59Qr6S{V{ wcGu"
"%yf|Lk+T7^BeS~E8p_g5;YC$BkNpMF8DC^,+Y#>vZC>j%ZzdzUPu;,<oPO;h@;JZ3?jXJ=w&fH`x"
"<xWfSfBU_Ua+w5:YS[txN,[S>N`o){6H^ds[8v=u}|H}KLw`Pen1T*/=aW_+NgNN]GB} 8hw|]M5"
"N0r:H9|!O~e*DNp#NS*V:!yYRZu7=Quypu67%4I K_nYMwT,i6$EwDz(qy$l6a5|fm=,/m7_/qgh"
"Uug iM[r:IO4|.,omf;!yrT.!2R_u*k8$<}~N%WSgBLJ`xTj|YSsNs*O(g]5|s^,QT0J D/uDWse"
"&6X&1*^zw9wG5bg8&5V+oyXlAZgxa|{f}S&FI{)06/)5)M^K |dr=w^6UQG)>pk>gmH_enn$$Gxg"
"guY?)7*en*:{dtyWW%i*0Z8OI!pP4Hde;swoL]Lu/%I(@.D;tfJgUuARSBdzMlR]Z=5rI:GxDXq^"
".&! :oSC=&8voLg9s2}c~YqNa$9L>_kE< GnoIljlsiEDo Z+B(6C(54a!:UhqBOZT}<uf[vdy#&"
"vVWkn/C)v QZL.`pH!<($r#e(G}=^(BC<0t)toiaB4cc=O$..E2KLN2JU/2ggMsmM+5,Mua;%r[n"
"o/rUg?k@u?BSp^&VJl`q413@{gxr^;|;(yd[(Y_/I)oN3mbltt@nw:0kh(/HV?oGskZtkrMjZemp"
"T! }HD%@f9oTY:._7tlsQ)1&fO}6KhIcZ:tsnoPaYLr9hmO|Ea[o$HMB9y,{[~%;h#`Or0,=G8eH"
"M~^(W:FhCk|V/qOuccs3`O>p$.NCMG6}v>^N;1G`n:R0.fb@8vt(XFaPPmI/dJzY=]VC`.PY.*>A"
"u+c>9V3q8*q#y#Q~fdCgLEXl>fsmgaBbS3.a7sf$vm&Yf?r; w=[|avD}[[cg=}(cq7QKFUP5old"
"mAH{(4,`BSIS$Z)(;FpN9d6v6kFbKAcTzc6z5kTgDK&M$_^!VU~y?r_92VU6M.oqbJKz0FWfbUXH"
"x:8L[J_JGX]x1FWbN[^201yDx<JEb@phtFA9;)89#H$l_a+ss<lqEhUL&>JRCdTS!iEs0D0C7fQn"
"qGgx||H,1w/%r:OSf@$X?JCKqk!0/qd$]hN.;JS6EPQ;kS^dd^iQ/}2LYz4X;DK+8*k=dQhR*:IC"
"P+PFO~7YP/OcfOF/rZ`G.l*g}wWYgYb5S(?oNU~*scDD$^aNplMtqXIM`X!hlMEziWq%u.Xt}];s"
"V0sf6R~h;WK{#fu2ei66kH~kNojwP@ )|+o8cs%R46Gy`PLm4llrM1?7cfQF2@Yk{9B|=>piml(y"
"iDY33I~I/}Caw O(LW4`Ln(;?Hw/h@xO3$Vz;3g~]xzJ_GwG6PZKFSB2qRGm>}G[(x~=tFb|IyG4"
"0YJ)ERCZ/!0rRp3z @XU^+B)DQt#|wdA5LtT,51fiZ0t_#4q.+FL3:PP#zo,en<~9G}T!GJSYgly"
"0/bvKOjol+&!VV]#`xnxd=N.<.,)2TuxiXnzTM0P@N AkbTZNO3`l,>sFv(GbzSbdW2Lsbvwh]u("
"fK?{}8Qrr&0=C8ArYv[Jvk]!oHR$R})T?@EYv@;Z3oW&tqK!~Y3!&WP+Utv*l3>>[u/CtQ?++4c."
"di.CaY]P%10V1,RbtU:|0O&k(4NRWchjUHP]xcMo]pnkH.p$h>eae</bu[3cLW5j;c%9n_)2_u{s"
"Pr]Wj[j_Y3yV{dlp95)LC0%vk2L{1ETkj#0pwEqy1nyrO1S2+/UgEhcrO0BLa>_({;Wm7hj/2=KO"
"j[f,w_<)F$@SuS=in<CXh}EHA^Z7_$UR!+N(/WS!.RQUovv1m(w/+_5xlftFS~7**BhP:3Tjp`d/"
"X?V!2xU(,pGPbr[iWVo|fbXH!04#6Z$l_azoya?JW:~gimfYq#sQ#;Pd^v.VI<.u;bX<r:_2D)Dt"
".xVj!jpeV;6lqY&bT/u?8=f#tt@T}f<#c@v2nqq$!zw2OIxQYY*E1o ,y|co3q5CkCI,<#GpYo=G"
"#H0NKf,+y=M}#e5~#PS@$X)HO`%iSsQTC;kyEz9k3fY#yNQJ5H2VGk %}=C%j*G/=saPOEf7m1Z]"
"_v**E=kD]6k[GF>$m<`LR_m`s<?hCatS;p`n|7_.vZD9zXD[f~6tbA!jGfRd&([`L$_.swo[uA1P"
"^VTK1kVbGp,Xfo[/;?DvbeC0b(i%2yCERjEfF`PrTN<;R>Gw$*^kHt@,hz zMmN&wiI5?aDT%c}l"
"xEQoU$?DOI%td_n(Fp0O$wJ~:24JY(@mY5qcrWtWWbErn4+t@vg:==Cgpt_q@1+gum8[H7v{({}D"
"?{E.+rd(#k887n9?|>KKsXSF^DlIX@yQf!|cM^MLHg2W706E.g!DY)b`ap#W3QfbagRJ8l94+ZFd"
"<t)FvfI&`+#rdbTC <XN@,a3VPIn&WUQxw7y;qJ%+q~F8guVI$l(&Y?[9]y>j]8_6w.LyxO5D_)V"
"IkmVJe)0|L;9[gYi;l>)#JpU5|}AJ1qjAy{TULe}5k}Z#;b#UkQX#2qQGY@5Y]p+ZZ8$;^Bq8,p]"
"@,XL>GlK,i,q8/05.$ql[M^L#JMC`7<4FmHhPHX,(7`UZG/@H![w,#}u8Mci7gz?$Se!4*9&SxHc"
"zW3,6ZJA${kC`og5HRmB/),b9jML;FE@_a/zYql&X2x`JXpQo+*}xSyDfh[gxduL@wX|%&v[2?!o"
"2v5KO~O;U!<bkit/n2$SyMf?!IB~L{/O/:4cMVf/2VD}YGwebjlSm[{x@>6^LwcycI0I)*:BLtW%"
"H/C8?+&XW_m?&j&*44R])}zQ`ijMtVo&^{* +ix~6qVvxbt^F5{QzwOI?~Jye4b?ovrfgMnCC;E~"
"DRV4J0dH~ubi=Yz@pSlw*>ogrr1p#k@u8ZPOJdTE~lWNK<L[X`x5rgp^{!AX:}|D6| 7H(xrb0#q"
"FhgB9CHeQ`Y^#$Ge o{q`?fZ9r(FC9)HK)NOvAy!5+I`PXjmTwaEs(n8Q0D>oW (Z@Xyf&$V/.3L"
"&*]K$:V!k^!^*I0JVpJE_+FC6X_<L]k<7|$hFWMt[FMIJh|D(`p9pV:C5X%m)[%b,LEos(jg m$#"
"&iOjoU_[]U7>~MA#*p,k`WLWNVvj@}l_#baL69ma$]IRL)qb99mgk3](6CqlPo!Z<]^Z8j=c2+vo"
"wrCbX|0mEvD=XS|}`8)VpL=_QQ5@uVQ!290dv}!if%dJe!xk/!@WHpl#afvZASkYTcH9Gq]}=z=X"
">L>x,<#S;X<9O.K.Cj[Cd&M!lo43AB$@]v`h7UIkC6S{x%(m;+t]zN_L7B ~_~XX$qA7`18=>_EG"
"qqe@$H3>me{[fGw24MoF=O =zFY`qUkEO)!~mW$1sWxtuG7PH@V5]eyW4^_IPj$?+L@79(z/8}g6"
"E,r|KzN[gkL%)6F7;$1f[OS|}U%~myz7Eegiaxt4&bG^jQ90|TX^ID9lLd2{z]WWUQ#1u#g#@FZy"
"YaXj:J&KyI?~uPF#A6cY}jPIbF5U ^[_MDi<O6MBN@,26a``LJR.yV,ze.%Q~dGX$zQC7h|r/6eV"
"GU]Vz~:p~v!b>%A_<>C,)3dI~T:ElF^znc2X5<{xvy*xt{}:FU>JmwzgBB:4IkR96$<V*|m|W@:I"
":[M/ulH@HQFrU>|1JS *=yzJ+F3L}ad9/q3unaoy7J1lSNfM#w_FJ(:q~G{#>:!s=zA[h.jTiQbc"
"%n)b+aJULl2S0Cw[N1ddzMrt_/,l!01b)2N{^&j~m&N:@);R5n=<2<gqjon88WWtH@7^|$;!E!g_"
"NBy;FIs/QW{~qJpL/IcMn)z)j7x0:$qcH$dw2].1LORX.`S[Id*Hxt+5f}H=Hsr%_U}p`]XW`lk*"
";1>Uc`Ad!:vwt7Wkg]wQcr|J[9(K#a&#0F{[zl]eJDkylI $|u}u<):O]D3cm>@EP1DpN!6d|gu8"
"SUtXdPhboSYXzM,Z.[0Qqf[?/5voYT;^(]LMGv=C,=7rq4dG/yXZ;1^wW|I:{T^>db1_6zLm&np]"
"p:c@wE<D|o2o<?:UvLSYK57{/FuGy`O^q1+>zdnPMl09z!hc(1Cy0<QF`ml}uJ6MYQ 1viCh{L}@"
"i8[,AvgARG~,0n hp2]W]t/ceG#Ye;2[C&o3(dRa58l38,L;RT!>Yl%(w?,1UbFn~[/$jBupR9xp"
"lN*$>ozT.[E;Iyad`P]Jbg(Ky?u4vFoD9aV;s@ux$wJSrK{Y,7?j@B7hhyy<9.GNBa +w+,^y(P*"
".XAX_WL`|(GMD<<iEYl@(F@zBMn|N~tXb3msqlXIi/k3`J,1#vCm5`5n^4plWGt7uU.cd1.daf/?"
"a=P$y^;U^`k9],B+dfWlB},$N%cN[<j/Qmlv_E$n*GV+~k/etQVE{2$;%?B_k4U8oc9VOc07_R!&"
"=ePK8:rKGow4$nPxaDq6wF%C8Ckx:>lT&wHi((PhP1wtTSkNS<B/<g t8*.;pFRY8eCF@MXbM>tH"
"VesoYQT[GrN f0Of^/e[ZC0bUU%GRV_vFt8+#D.)tF2);G8nOFwB^(K:4IZcV5Y2]4u6B:3ru7O|"
"lRH!}6*lRCFQFKAhV{={,+K5@qJu$T)qhSGUCt0,o9O#P+;)UNUBKHrhf^;UqUH%yW$ff!,qon< "
"/u3)@6NC631o5ked8JIW(^UuGBR]Ph$U1C*@,ZBp8ZM]PLTEE= 3]K|B2T+2D5;%0#HS%PFmNP1("
"wxUt]9(_cfi*T8=JFBqv?|$>.#WXdNG{iQHb$EAqnCCaU.cX`c.*hniz8uh(IR7j*^qsGjj*j~{{"
"nYrS>[`Al~Ug?FSzsvN~F~7MCwe[b9.v|lI}3ndUI?t3($~wuBcJ_vqBC,g<`[3._U2Ey|Hj|r]4"
" 1aS{cIq*28|9+05i9JHXQSdxNen=Z{h4/1TL1K6;,z9grl}6}WdiA*gsOMk0$7<#r.aTV+,]8JB"
"fu(G%Q)6oCiZv.@(j?*`:(*?,@;W~6Css]^|xLkjGi%dlukru@o*yBQxrraYj<uc88QZ.:d%Ga>J"
"JE0O^Wy%[41Lui>ixgOjg$(zk6YMu/)mr&blxJ9MC}s:XYN_T#hJd< ?BLJq_LW%!L&G{56PiG/^"
"mGK3/L( Wn~BC<E3AKnpJs^j(CL6k65wox$=P*udka4G/Pn)CuEtdu}u>]kww)#jNLv<dO&C]$j#"
")A8:,aW>P37G&zvf_EFpjs;$1tJJ~FWMKK:Nt:1bb8!Ebg_%[_XUdvc_npoE&YRRfk6Q#C6]vQEv"
"ev~4O]TW$t[$OLF@p%Js(rML);h8/IjVT8y*&jR0ES*s3_XtT1}&WCF+FSGNJP8p6tdxJ<@.%c/S"
"e~9f`!D8jkvbl&^l:x1Z}S}[/RVItUi``axz)GoWVYxsCOqjcS:z!vHR:kkF7mDuH%I@m3a4?ZRA"
"1{P@[igu&6KPC+yLShZ!65SRWdmXr[}1He3gzQ?FChAB7I`f$oN@cdzU.W 7Pb]9)g4x[czK:Sp)"
"}vtNBq;_k@}|TkvBAo$i31=Tn{`>us~!btnYVq;4?)m0I>w;D`%dm@VmVHy*{>&;N>=@d3Sc8>is"
"QHbufrDTJ+qeA=~8N)Tq2+hB1tpZG.x?`h>1weV>q6$i#N2ldb`6ur#61ss/{{r/:Y*q}<=UW4{L"
"+wQu6H,3Nn_DXg[/b8/Q12]`$Esd:s7,w<siB|9lxQj{da+?pw,E.gY`zF^}._[oMRktl7GJ$,aC"
"|!EwOS0bLGlujl~r6Wg12]FNH7oO2~DQ7aqOEbAQT>U_BoW{D<M0m%RLiGGp.tPI=%1V>z(q<!ZX"
"Xr#`4^d:eKrCvh!`I^&+!gnjbk=P(iw`dM/j2Dk`qzm|>{Cv[h4Kz9{*Ep4>?yFDP`[uA]Wv9;kK"
"Q2DB;kbYr(U;3~|7/>3MLqoMb8T?,/rR]g#}J1:605([wo<L<%va#T.NeRN5Tp`6vKe(6CLSf.`E"
"?e`a(C})%ac.(lcU=i?F.@10l~2}m&g>UGxA,R?Dzc@.cmfjg|`9[5~}P/JJ&$n@[fq]l_RZJL4<"
"7()Qu3vP]tGNF3B+U3VuVU#{9Qab6<;wZNQU)0fRXuI>Q3_}epuq0B`|@[NADlDCM?9BQL/|6c?t"
"$PF9@1Sk<Z4Q~]2}[9%ATytmpDu`w7v/YB4)_P6fGy5L<[eS)NyQH1eK)3WX^hj:Q}XK[iRu7xjO"
"W3yvN]1{Yw&`v/%0x6:nvdp@by#C4~Wv!2&=C9,JGd@jNTvo^$3rgRyyo|~If=5PC.dDbl9FG}!h"
"Wt2,B>.?dPUz;geT`t*~4o4$;i8DZ8ry=@P=y,^J8G;4(=~dJLqyAD|14 _QTso9t8bMTodC1>Ku"
"bAh&Q1h{BNHhn~Z}om+b) YH!DjR5Ij2R45o;MX/dXBlJsE![Od=zIJi%Lr6M/zB]jI.p(WW)OWs"
"Xn)#Zv&wlE@4?f)WT3=)CA53xLtSY#>[Cg9JhL/y^KKMPeJ)2;4sdp m|u!^QX{shR~?vdGV!$[G"
";Co>YX|s,2GNkdTN!cLCy[.2bQIb~fT/8B.[_`TM?$J1A5*j)0k7LkPjr*tq[~pNs[A {Tp>>%$#"
"iHpjchY$3XGC&Q[dD0U_R@T>?P^c7i.}N&YH2 d_H)9a5{}P)md_/r5`lFm7Rbc|b86xHy{7>[;z"
" VjGnIK}3Az7?HsQ/KfZwfbY_/*:4@b5BR=?UEfE=nH)a?37ci|X% pMlY.TKhRnvzF@CQQ]sUZh"
"{Blols&/_Vi&?fwK#2hS[w2h/Si[1fOQHn%$/jky2PWSV?P5o,P[sQw[!p]$s1AB=ZC(k]r3~4P7"
"Y*>1DOjWkWqGdz7:kjm}8&P6j4d0r$Kpm!/o)g=?Eaw|AdU_D|L=T7^G6XX>O6D!0xK*>kBHJnps"
"2`yF{6}fe{QRp*I5 L4Vz88tT&=<h9Jk$8@1MAF()W,TQ?`8J(.sZyW;1@HM5rh#Z*Qv7do`b5a8"
"gYp:a)?/D}6|!00IE&_N{Wu/y0WLM?khcGBM6iY/h9R&.$)Vx=Kvz>9>|R!esmd6OfSPmBa%3@o,"
"Wi@M+zKtqw7m~$Oh(h|3Trd`X>Z[|FYcQQNymrBJ Ef:T+NP1u6ij/#S9Xfc)ez9xb`d7Zs3#Ftl"
"y5_6.0!3|52IdAYuD:([AmN.*?hJeS~yqbG4CvQx=>6FU|*sJ0s+U[@8/lh+Ikf8lT{h%^=#_!]k"
"!`v@Jybp`<M4Dj7/98~59MIK*gj_[PT5^]j;QTFn72cZo47yK@EiD#/E&rA@Pd%BJ?V@jLwvpL2w"
"y2M]6#N7@iJQ99x)oZv];:*4;_vW9+iV}Tjoj>.}[r>Rn/!.kQVRkG K7NKWa8~YLk7Nar:FR4lc"
"5nZYRYb%H{8(CfQ>x|yZ]P;F_my2pc!T@:>;{b!r;{~Wrvt8Ws|Vsu+.R@UoINx+N;*KQ*0CpU7r"
"s3Y3nk)[hfhe$SeKK|g~$VD @t1HXkqGbp]nff{Wh#crSwe/c?5D+X~/;@&Wgsn3|hABk.LD{/q0"
"3axkO6z`!r,<Eqn%+=pL1E^43$glj;.%skMSo>=hLTB86OUDo!{v3sKv5a)Gx%W[P>Zsk?YvjD}]"
"1w^~/i%|IQC}jQ<:9h )=jC|#6+V.@XUc$!1;@&q]$]_u1sS~le=cQ5Xq=(^HMB^VRSekXi6pW5`"
">rCENDcjSPRX~Y}<m= $QZ|,_v36s@ORB8BTHD5OwZ{1q`1`!ucN+b7&LVriRU/]84r2aN[Tki0Q"
"W_XC$(X/zgKti*F2H8 3}Kb4Z<&zqt*[@): 2R@BV*|^WhXIH(J|L3*W}[_iwx|u#e4YV%~YBvhq"
"&pZ~.izp=pJg:yzyGp+]M04FhYehL:&1mtzyk(|O]f6[W[{5}(a#f<S~YwRBv7[E}LTS u3gMWVm"
"%=GXJgSQH*nJ8E|(L36XXp[OtTBcv7AGF]KBF}%I3ePO;J^TU^K,Yxz(o_dvW7st|f7GeWL9A0aM"
"~Q&%H&12n8`|/,/fKp_iu7)~Hh5)$Vt$ChQ55M9G_3D}/K1/ &<33$^[cLpB}$Xi|W4[5@Lx(_*z"
"g@truf7m!rzdd_V^p Q[h>KH&)up8C$I)!9W*usVot2?>P^@O=cw;Z6o2Mwy 1h0Uv$5GN<YfUyR"
"<y:yx0jh( 6ajqI}jJV99nIr,!{1SZ gs.b3r(MLG8_nK+7&YZqFCZU>;]Lw`QhI3I]gj}fr5Uh>"
"{)MN,NUHx/ILYq+cS7EWI)ur;lBJy[pnNmR<,.[2Ta}@DjR%/S!{fdlHU#rX(p4E[,yW~g)K]LsL"
"gSzme20,fQ;k#dgJb*f`Zc:# (r&JB?8!~XbOl}4(*ylc:&hNp~En!N&NW*oU>Xc[3nRZbS2mcf:"
"Z4[|wngAaPR%Yl$|a00BRx_?l_b1@Sap_DIoXAI0!w=[JDMZU{CzBE5g^/Mw2LtcF!%!Ec3EH0?+"
"gm|m0_lNiw7(c& ={0_JI4;d,GJyzU;^LszS*12SpXyk}y[4_iu7J+iSLvNG3#8oXjCKt_(z&2=q"
"w@0RU=q, ~FWA6tYF5z`@`4z }8U@FvDF*=Z5l)ymKAI!!*Sw)]#wKYYzkR)sh{+Ufd{.fHX;![~"
"pGfWxhREwG8K2gXTdhtQRwSMSI|R.Sh+1.A*SE.!?bhiXQ,[Jf_|,O/|%h^m^1zl?(~D*D_2q>x:"
"3!cAHeJ;KU$xZQ2JE?`4m]V%KY0GM_ ^Zt2<@?z@MT8<2uO@1:71wh!?vyD[p9p+XIQsb|$w9i!:"
"JX)D(|9&6c2GYh{5Op$?7Z.I7S!b$I(q|c)?><:$QARR+iu+i%wGQo.,[47LYxDULi3J$$!s{nb!"
"KifmM[@K,[2D|*3%T6SnCX+_~iNFM4l`Ta#qzj91Z=])fi}k^]VmBNhfY91LmO(U>w<QM+ONcFX|"
"RWSa1?zswT#X9cZ}>y_JgmD4BcnAS.S1,DcgAtI<rHXecMof+uYkoJdRX=m>z4ydn&(vf8UH%*g/"
"hG|,jsZL?UW%Ufl&y=0&nwmVxW8{rBZ`sOGsf#6uc`J,Cj.wxFh{s@aG@p}yjn:[&Zoms[2ZZ7u$"
"E|imiz}^?c@:+2c@b2~@xjChV{kn&}GCIJg8gJ/ Ip;5[,EPR_DV%<qm01+;Rky(699J|t[4LCc~"
"8uH<,[OM<P*tsNX#<P:Qhd<un:(:;c=C,54T:p!Xwl_v|;a&VQ0/?gn6Z_68k<>}F?YSo]uK9l!["
"y*F1nk^q`v0lX`W%y]WeeTX;8wG{T0 ([pOV2C})Nz^r?O;~11,/di^8Qp/ehBzxPRW0.Sm}e2lw"
"k73ot~ *j:C{Q8i&3( [g+rpZQ[*Tw4c>6|K6&g/4&X~%A,SJfifhB3Qb.hMc.CC<.4^hY5rirn_"
"K/(N/(8`Pj]<F:]Z181!pYc}]= 7IlcwlQk/PYjYVSu1vR,(_[*F:NV93t!@j+,#cqB?j}DE]w/$"
"Q(DZ>LmggM>KVD5(N3N|j{wdfulsqv#l14KwWe]9gIT$WQ|toF8p9t#aifsOOo<%12oE)jhV^+X."
".%?Y~`~@#Bd.he7<.%uCi#8*xo2[c:odC7PW7=vcUWn7+x)Fd~WL(}iou=(2iZt`m4RJvM]yEZrq"
"Qf6hfer%y/O5_DlaZ7Vw?bD@j1}Pmy8a;8U8}!)63Ww)#ZQ.TTNdJ(&cm4;{SEl?*KD93lhrrQ2G"
" K&5~jg3EL/bI]/oxmMW0>_3_;A0Tj1_c4ifBH)=#8EZ*re]|QPVL[e>K<g}fkRcEKG:Vx_cd9$2"
"`zk`pA@kCzQ.?uF(L&D0P)NHnu.&}~z8j1f0U8/{,AvT`18qQi_!^|/Q$? ew%!sp.vq^R!iztfM"
"&wOT)ki[TCu*}U!8se|@:7z8kC$yD#Qd)v j3R4s.3n!j[c|}{E9)NAbyBu(d(f^*6fLT}//z;I<"
"L5Y;H52`^E)vG2o> glG |Qe&Q =;P$,D,MAcrbzT50`<7fw5FEP>L]:#$MteITf4_!to;z)R.cG"
"H:>wbPGeG`k`LLj>gTWw15}1u*lotT*uOi6kaEoGOz]S_J7nA:vXczj,Ugd,SvNej7A|fqHp<]te"
"3YA a](CN%F&&x&Z@iMlnizLjbd/t=4S:$;=HB28!Eik^TpmQ*ZYK5 j`+Y3Ke7.0s>LRm{eyGu$"
"o*v4a/&Xc:@c$z@{,U8dEBwV@]fM&H{B6E]y5oD3($dMRL6) 1QS>1OcdTwwf(%mOIR7wfnlq4ux"
">,W.|lGiMy0n|1&R2YnX@lwixW7,]qrHGQ&{65F+EQa<:e*Lfj08Qq_&)=raq[zY$$^ay?Up1nXW"
"=LtR{#r(l]6{}_nz} 7YL8GSMYkVKVSM&xaXVTd`F<gD(7Udf(l?Y0jk9T/jjGB{^rHD(Wb,_&y+"
"pn(bhC<#{{In4/Le 9%ayqN{JPHDxZy<jENBBKLxV`uhLG[r}`@uvQoPQp$Hl1:>}%A|Sm6ZLqUc"
"w<5hFuWm<|PP>[DQj>#2 0lSJmjcgUSw%o$^!JNi?+FtSB2[`gB@?PJ3c)N,GFJR.:MMT(qBQ#V<"
" Zo*[d(JO yT3fUnxlJ>x>FB#GqXI53#@qsnSU4q9YZi#goYKC7>xv!btzKcf(C7{[!W@f5YhJ?["
"Tq_ah5`6_brcmB/wpxgtLxG9.wUS8aC^*QJD:L[/~~HYkZrs;D;1|;ujUD36Q`=53Q|TuLrz c@$"
"w4kJ8>(H{gaDy>p|)UW7f*f~i;WR?E_:{,7{%?JH`QsinI7FZzq_89c$!v)3#G52otVE:91$c;vV"
"1(C2H_}zm+#0@|m()^a=d$rdUgT)FmCLuc__/1:>%HLimv!!(6_@ebQwkU,H]yk]z#$KzE.n@}S0"
"XE]CX,0F$:R8%sC)]@j!J*ShYB6ZjwP3REwPuZvMR@Y&mJZ_UI5M1).jI6pWn(E:|B2[H.AEN*sa"
"%==2k>PxmrZKK~mp(J_LVtN[0S#H7vob[vk|$Mt_rvS!eKB)lD0Y8`JPkuz^#@WqWQ}p{1Huze>B"
"jBXs$3*{P6(^w=:&t}{MoJ#C@D2/T}kPIaq/0gu^HnnJz*%,s)fytVYP)2=cnq=!i@V_R*f;Vxa["
"6Sao/Jtg)BY*V9y^Jr2jygUx0g7fh[i5ixi?A|90)#5{=]d3@w]V3UW8#HQ*!=?&(1)K0=_x32Oc"
"nst769hf6j*u6@W;~DMBB16!2P~=,&`E@G6*f_B^aq|R{rUKId9_i*TFSAc6{N#b,Ed~fPcJ Nuv"
")[LO^V f4.z@)TA;j}|(w/MENl|)2).3~jEL~S1a~A=XnQ87T&^scj#X)7?:hH<Z5*lD.o0.:ahi"
"m>I.q;o;|aLW(#Wd%0hcEFqdeKr;j@ 35#:|t?e2SFf5g}P/[FU&a;l?>At^xV7#Mw *C.j;AeNM"
" C}Dz7LqQC#KV4?Oi/jxG|dyF$EYX5Px4!.yy5&FppC]HgEG&YJsGp$.(M`kxf7=0cVdmn,?hvx="
"0w)lA{<MOv~/@L[A8(1<g1HvdN|G}GdiH(Sr_B:d0V(Dh<+iprrofoPx_~ZimMmt#<QZN%oNDT~o"
"O>kky%ZIJ`N=e><NK3C3q}o:pT=q($lmi96q./M 1[o|z{,Cgtp$I}5Vs8>fFj/.Zdoee3:r3>yL"
"1#{}W~A4mgcrbVU4hE .Ll&Y!hpn2)G:+rPc|^}DhnkWB{$!)I]FA$JdvLGUH2cBeghj>Hoq8P>+"
"l>3m{91~mL p?^d?wX#@ArglF~o,:e1fUpD$Z]@6OG7TdETPJ&+OVsIb39(1Xe8P^iu62*DmCk&s"
"*.[mpYJW`*WG*,q_*S(?Q]mQ6+_zWvE+x[mu=E!7jHnv<XY4TcZ(B>*Mcfb6$ABth)SQ@ % 0&ql"
"o0U5RC2Au|sl@zF;jj.Hh(T2Dz]5atbEL=2n}OJgZg;4 *9}BlrXr]sBWwI6LU6][Kz1do?agl`5"
"PFtzDNlOV5XIFem.P7(Cu]M$B^h>qY<edib7:/zVxrE(mq>=$Mg@?2:@(BS<;DX>!FVz3KZ`Pjy5"
"~yM1yMU%GX3$0!!)KcU]21p#+Bll(+5`<<R{<])9*1AgO8P:&4Y1y1D!yg>E#`K#JT>TU!d`LCar"
"3o[_L#OpZM5Vgjpb>..Zn(`Cl:R/Uhw])f_,@mLhXoXYCe.cNrf$N dOu(!e(B9ODGvH:j+3!DMh"
"9N@,`E&]R!+/~^(%ChS*4FJ<Zh%ap<)d~rBl+Q^[+ d[<xvxofvfF{YLBjB+fQan1dZeQ&),2Ve]"
"p4 ohQ~W~`#TtVPhD*#3IHOn<O<U[Nq82rL>1U_(+4Zc!_1rgziID!%kw.gmB6 oJt>/AN~6M+!["
"T>7}lBz*)te60!!Zz/.JYb&s+ygc}|HD__3i&0~+$$i*%[mH!/(vg^sI.Y@j[NypOL>XaTnkjyBc"
";G`{Xy^N|{OEUC+DyI^We4}mZL&O8rcjy#>3$>C5B%$mT@c=//cjGCTpO&78!C:3d5Ys:I c{k(W"
"I6g=whV{Tf&D0PH/e?hN}QzI{XlAj)(RWojzxdURDMr&KtBbd5?n([bxa`6h8?Q@F~p;6vA1wZY}"
"!K`vuikSeenEX2h%B!X&s)JydR?|9B!Q.2,n`+_klF9&;(yE[S9x:q|6WwI(+d}D[+|O~tedbV]I"
"k)m0lK|J]E}Hx?9Fj[>Ut<tZCac_0|uvv|EVnh&~m9x%46)2GqO94AR&Q,` U#uD3w|>U<:2_<Bj"
"R2XB!G_6$EN>1LA3$J>8TCZ,8?USBkqy6Rrkd}k!Y0C%s&OYp]jE:y_p;(5f/ub FmJL](3bC(@v"
"xC%w7s1f#];o`gSWBfWnF/z`KD{RX>k0R~@0.P_H[[<$7X&Ej%)I03&5h)}rhX$q]1h;/6Y;=I*C"
"b!&;ca@^Cj_A5=Ibc99kJ.)qgeHbx`b6q~YN3]@#B$h2Jz;ZZ53XXlC THl|T HaM&Bk70yY;TCj"
"P.$w$hK7FV2JQl!+]G%DItluP(Gr]10S2/<pAZ,]W#_kaL[*(kI749PT)h%|fpY%yv,r}&SlMDa{"
"IJ`erL2VwJZ+Ob1miiuiNz$XxESsbnEPpJ@QKhDAf1orwH_p4?MY|>yo.6)<[8i=:or08xe!7u4V"
"%;,W91=.&.zdd7+{/{Sf]I}wxYkvhPkT5<<1D##Rd/vk>?[.AF7``dzpi us[Oc~,op^w88ZYS2n"
";Q=v,]W#XxX[`:I9XXB81%>_6TgAOYfJ3TgmIu{7,3j=L9~=v=ADwYckav6K3<Gm3W?(!t3,X?y8"
"9^$Dcq~,j_a vT;h0t=uqQ@fe}VtQ{c)dpw<%q:>4*V;SE8W~=O!6QP7LUAEUB;67X9VU{E^8eA?"
"+B&|>4;B4vgn :@,=7Quai#Wckv!g=U^&OcYCJE(=_03/(E%wL3iJK1bFE`*3Qs_%hz38lYj)Q{>"
"/@&+tl}Ksr^zzh_V1]zh)`HsT2zvJ`!!?:J<@8,w7*TJsTeGKKXE<0;Djkm,_(^E6{#=^)_M19wF"
"|&nxvhSEZJ4gs;uUHA@Y[QVt[^kU@=3}#)N6]9[rrV3UOCWjxm<91}#Rd4d+%V~lw+K=m0rDr,{4"
",(,g_YbGCP6_g.AJt(S ITMmGSDX3QBqKTvJd]VOb|925O)$i945On%%rlUy5SMM.pw(Pitvmh]["
";P9&Fi`VDE;>zdCoF?IK?iAI0G<[|b,$/=Iru1Pm]Bj8d0eh:Sod@rt+/$)?G38(B/#&6=/Fk.ob"
"cl}@0Z4e+?ZEyd8^!j;)d2M~JRK6W]vG6Old&FqFPFqcQ=0,U:p4~oiX [T7@W+DczHNBBZd{+{d"
"A1)lN<:ed$xk~;f +VdU7KtTR&a$,&@O|$W(l*sq,m ]aV<, 70toWy(eWP&$S>=8CiwU`+Fi]mO"
"Bed>5{M|]91Qc>T/$01[h6HuwWZNXp1H=RALpE1RC[B5;HNN3s#=eAwij n&$i<R+m%2KRd6/j|h"
"Vsi@n`Ba.h};Id`Qi_X.AP8K V}&|*#d6XT0f?:i{V)|aKQ_;vwPg4{qH:`m1jeY$K+{KD)?=0TQ"
"3`!G:6*hWS7^%Za.P!k!OI9;qwm_K6v|,E5^U%HF1H8dC_]jgk#xa1q^Pcr~Zov({KzvE/!LJ`)f"
"NiiEp{scVUEK/^Uh0Q]LsXW[/W50rn>ge*jx)cgD/3)bD!F.<jE?|ZTTLElpC%FlR,k~c=%eJG E"
"YiOxOI<e7fsPE&N9;v{k.ZULeKDc&rrVZJQ/e6YOj8;FRT=B,[&qP#Nd1$}1}$5hTzayn8M0Ge?O"
"BaK@N18!K2[[<9~lJ4L`d5/66<?i,gCdy>_xv>^%<BbJ41DJX)ty??+ff/AhsvRD[Oe)N#%QD$=I"
"G9e&}ztk5|lGUZ+X&{Z1eBp:B@{DSK&~4bkPoEsjBZl(tomu()h~Uy$aKl^7%X7cTBkK/*%E/(ao"
"f~r$( vSr+t%nmn[]l~fX#CODz|e]H`L)+Ws^nj7dpK>j9R5:6%D`2`TH+3fCx6nU&suO/uu{{J_"
"#,s0NhK_OK+r=f&&xJN+`&3!SZ8+A[vQSuNPgtpVQBPQ@z1Ps:!W62/yOi+W0QgV*n%W&@v^K}~g"
"Iyx:H5 blH_u0G/d`DE!0$ 0V+9eE`bp<bVbu)FYgj_>QRxGHGMc%r19slvxu{(g>ApV=43rP}Z@"
"~SCw$oj^[kAGf!{YCx5%pyXk6Fes_aUG$>0XYLdNynvW&4n$G2LZG74i?`aJoO4iPMUZRp*j~),M"
"z#<5iBWqsX|*1j>}E)@n>,qove94(^g6(j_ZV.<T7ut8fdxYn8pjlZ7$.wToWuv`Qu]|i>xCl`0R"
"|1{<SKA.*;m7~dsX%hZ]`~FM9blw4(44.}r5)Qd6HsUv;B =J=MBbYW]l%0!fJwC&Jl>$i(:O:Jx"
"s1</8Qb.a0i1%Ow!wrhDbD d=`j:5np>TE6bn%t dLLIh3{|H}VT/9zo|0B/R0m%$|H{9@9Q0Blq"
"U14?!r coA=Roej RDs_dPr >f[$7l](9RL&!rR6+FK)}4(hJH,_zGE:#RCLt23|Cu00#kwF(DfT"
"012^D0Yquits3zSzh*KrBHl>s`gU]]gR@V r2E~7qV(Nb4H?te;YyJTS^$LBE!iSEE=}8QUG2{u_"
"1E_BfL^Dq&f}p(;@ch8N[ROuLh].^2Yy=W@D8;A,G% 3m;*;[$sz7uzE4U1D=dXv cseKT%yn{<D"
"e|C%smPE_XbOgt{{O.5?gw9b93Ul24tP/u%t]@qDF)T,t<:c,}L>)y362Td&6x:TolGh>C3pSUi7"
"/OR56j<k:q;48|D,?tu7+mySe!c73Y<M$4&./tH3jxo.&<6DdyY.GFi].VcP$]bGhY<~5#+%pd}M"
"op<!SY?Y4fr`K?,1HS5K&^r3*hd#UGIQnyXf}k5*xG4;w|_]V)N<jUG*p0ZxDW;l{AzhU{CO|9Cf"
"x|p9.)*_j;xq[_,935B, ,ov koVnQRk;uEKB|^Q;J[YWoxq&{ojCN~qU>qmsBJYwjFIxlRFgLUq"
"QaAzjh8T5.qK;kC3,a_[Xvyt_?2jaN%Ay<_g_<t#xuPWxX!9@6C]_M[G)7qyV7[.9)^s6qZG&6_["
"g?:?SpfrnjVo_CCFe!Z,~?JxX_(4${9[lbbgq=K6xg+Kw<QX#%VWBR3wI~I.=z!5r@RcOh~5Sn8>"
"e%u(5<V[^?x^C0a.g.rG<^Wzx c[j5Gc+_aLCBOGp3$v:9Uq#Y%!;Z_c]}7zSByR/$*Y+}ZuPFtS"
"sc+htk@h+C@~|28hVx<]=F2PQ~@&bS|#80My@U86G9muNX[?Z2;L,Z0vAv7jWri)VD{:w&ZS&%q#"
"3]bYSViD=/c|=w$ytg.lo1>=9k[qAss1|>}^U41Yq<r)[g_6CW#C";

unsigned char internals[8] = {0xcb,0x1d,0xa2,0xd2,0xde,0xb9,0x9c,0x87};

#define D 2


unsigned char Gx[D][32] =  {
  {0x04,0x09,0x3c,0x39,0xb2,0x33,0x46,0xd2,0x12,0xc4,0x2d,0x38,0x6c,0x13,0x18,0x50,
   0x96,0xe2,0xd6,0x2a,0x65,0xa9,0x07,0x71,0xa0,0x61,0xc9,0x01,0x30,0xe5,0xe0,0xfd},
  {0x41,0xbf,0x80,0xd2,0x52,0xeb,0x97,0xba,0x95,0x65,0xb3,0x7f,0xad,0x17,0xbf,0x6d,
   0x8f,0x71,0xd5,0x00,0x1e,0x0a,0xd8,0x95,0xb0,0x4c,0xcb,0xe2,0xf1,0x63,0x91,0x5e}
};

unsigned char Gy[D][32] =  {
  {0xa5,0x21,0xcf,0xc9,0xd7,0x92,0xa0,0x57,0x27,0xe5,0x4a,0x23,0xb2,0x9e,0x34,0x9b,
   0x20,0x53,0xb0,0xe7,0xba,0xdd,0x5e,0x5f,0x5e,0xe9,0x75,0xad,0x7b,0xce,0x9d,0xbc},
  {0x72,0xb9,0x96,0xeb,0x14,0x1d,0xf6,0xc5,0xe9,0xee,0x4f,0x60,0x29,0x81,0x51,0x86,
   0xdb,0xc3,0xe1,0xe5,0xfe,0xc4,0x7e,0x67,0xb7,0x68,0x63,0xa1,0x8e,0xd3,0x1e,0x5c}
};

typedef int int32_t;typedef unsigned int uint32_t;typedef unsigned char uint8_t;typedef signed char int8_t;typedef long int intptr_t;typedef short int int16_t;
#define SHARED_MEMORY_SZ 128
unsigned char shared_memory[SHARED_MEMORY_SZ];
#define MAX_MBYTES_RAM 1
#define DYN_MEMORY_SZ MAX_MBYTES_RAM*1000000
char memory[DYN_MEMORY_SZ];void*my_memset(void*dest,int val,size_t len){unsigned char*ptr=dest;while(len-->0)*ptr++=val;return dest;}void*my_memcpy(void*dest,const void*src,size_t len){char*d=dest;const char*s=src;while(len--)*d++=*s++;return dest;}int my_memcmp(const void*a,const void*b,const size_t size){const unsigned char*_a=(const unsigned char*)a;const unsigned char*_b=(const unsigned char*)b;unsigned char result=0;size_t i;for(i=0;i<size;i++){result|=_a[i]^_b[i];}return result;}struct block{size_t size;int free;struct block*next;};struct block*freeList=(void*)memory;void initialize();void split(struct block*fitting_slot,size_t size);void*my_malloc(size_t noOfBytes);void merge();void my_free(void*ptr);void initialize(){freeList->size=DYN_MEMORY_SZ-sizeof(struct block);freeList->free=1;freeList->next=NULL;}void split(struct block*fitting_slot,size_t size){struct block*new=(void*)((void*)fitting_slot+size+sizeof(struct block));new->size=(fitting_slot->size)-size-sizeof(struct block);new->free=1;new->next=fitting_slot->next;fitting_slot->size=size;fitting_slot->free=0;fitting_slot->next=new;}void*my_malloc(size_t noOfBytes){struct block*curr;void*result;if(!(freeList->size)){initialize();}curr=freeList;while((((curr->size)<noOfBytes)||((curr->free)==0))&&(curr->next!=NULL)){curr=curr->next;}if((curr->size)==noOfBytes){curr->free=0;result=(void*)(++curr);return result;}else if((curr->size)>(noOfBytes+sizeof(struct block))){split(curr,noOfBytes);result=(void*)(++curr);return result;}else{result=NULL;return result;}}void merge(){struct block*curr;curr=freeList;while((curr&&curr->next)!=NULL){if((curr->free)&&(curr->next->free)){curr->size+=(curr->next->size)+sizeof(struct block);curr->next=curr->next->next;}curr=curr->next;}}void my_free(void*ptr){if(((void*)memory<=ptr)&&(ptr<=(void*)(memory+DYN_MEMORY_SZ))){struct block*curr=ptr;--curr;curr->free=1;merge();}else{}}
typedef enum{VM_NO_ERROR=0,VM_INVALID_POINTER=-1,VM_FAILED_TO_LOAD_BYTECODE=-2,VM_NO_SYSCALL_CALLBACK=-3,VM_FREE_ON_RUNNING_VM=-4,VM_BLOCKCOPY_OUT_OF_RANGE=-5,VM_PC_OUT_OF_RANGE=-6,VM_JUMP_TO_INVALID_INSTRUCTION=-7,VM_STACK_OVERFLOW=-8,VM_STACK_MISALIGNED=-9,VM_OP_LOAD4_MISALIGNED=-10,VM_STACK_ERROR=-11,VM_DATA_OUT_OF_RANGE=-12,VM_MALLOC_FAILED=-13,VM_BAD_INSTRUCTION=-14,VM_NOT_LOADED=-15}vmErrorCode_t;typedef enum{VM_ALLOC_CODE_SEC=0,VM_ALLOC_DATA_SEC=1,VM_ALLOC_INSTRUCTION_POINTERS=2,VM_ALLOC_DEBUG=3,VM_ALLOC_TYPE_MAX}vmMallocType_t;typedef struct{int32_t vmMagic;int32_t instructionCount;int32_t codeOffset;int32_t codeLength;int32_t dataOffset;int32_t dataLength;int32_t litLength;int32_t bssLength;}vmHeader_t;typedef struct vmSymbol_s{struct vmSymbol_s*next;int symValue;int profileCount;char symName[1];}vmSymbol_t;typedef struct vm_s{int programStack;intptr_t(*systemCall)(struct vm_s*vm,intptr_t*parms);char name[64];void*searchPath;void*unused_dllHandle;intptr_t(*unused_entryPoint)(int callNum,...);void(*unused_destroy)(struct vm_s*self);int currentlyInterpreting;int compiled;uint8_t*codeBase;int entryOfs;int codeLength;intptr_t*instructionPointers;int instructionCount;uint8_t*dataBase;int dataMask;int dataAlloc;int stackBottom;int numSymbols;vmSymbol_t*symbols;int callLevel;int breakFunction;int breakCount;vmErrorCode_t lastError;}vm_t;int VM_Create(vm_t*vm,const uint8_t*bytecode,int length,intptr_t(*systemCalls)(vm_t*,intptr_t*));void VM_Free(vm_t*vm);intptr_t VM_Call(int offset,int glob_sz,vm_t*vm,int*argv,int nb_argv);void*VM_ArgPtr(intptr_t vmAddr,vm_t*vm);float VM_IntToFloat(int32_t x);int32_t VM_FloatToInt(float f);int VM_MemoryRangeValid(intptr_t vmAddr,size_t len,const vm_t*vm);void VM_VmProfile_f(const vm_t*vm);void VM_Debug(int level);void*Com_malloc(size_t size,vm_t*vm,vmMallocType_t type);void Com_free(void*p,vm_t*vm,vmMallocType_t type);intptr_t systemCalls(vm_t*vm,intptr_t*args);uint8_t*loadImage(const char*filepath,int*size);typedef enum{OP_UNDEF,OP_IGNORE,OP_BREAK,OP_ENTER,OP_LEAVE,OP_CALL,OP_PUSH,OP_POP,OP_CONST,OP_LOCAL,OP_JUMP,OP_EQ,OP_NE,OP_LTI,OP_LEI,OP_GTI,OP_GEI,OP_LTU,OP_LEU,OP_GTU,OP_GEU,OP_EQF,OP_NEF,OP_LTF,OP_LEF,OP_GTF,OP_GEF,OP_LOAD1,OP_LOAD2,OP_LOAD4,OP_STORE1,OP_STORE2,OP_STORE4,OP_ARG,OP_BLOCK_COPY,OP_SEX8,OP_SEX16,OP_NEGI,OP_ADD,OP_SUB,OP_DIVI,OP_DIVU,OP_MODI,OP_MODU,OP_MULI,OP_MULU,OP_BAND,OP_BOR,OP_BXOR,OP_BCOM,OP_LSH,OP_RSHI,OP_RSHU,OP_NEGF,OP_ADDF,OP_SUBF,OP_DIVF,OP_MULF,OP_CVIF,OP_CVFI,OP_MAX}opcode_t;static int vm_debugLevel;static const vmHeader_t*VM_LoadQVM(vm_t*vm,const uint8_t*bytecode,int length);static int VM_PrepareInterpreter(vm_t*vm,const vmHeader_t*header);static int VM_CallInterpreted(int offset,int glob_sz,vm_t*vm,int*args);static void VM_BlockCopy(unsigned int dest,unsigned int src,size_t n,vm_t*vm);static int LittleEndianToHost(const uint8_t b[4]);float _vmf(intptr_t x);int VM_Create(vm_t*vm,const uint8_t*bytecode,int length,intptr_t(*systemCalls)(vm_t*,intptr_t*)){if(vm==NULL){return-1;}if(!systemCalls){vm->lastError=VM_NO_SYSCALL_CALLBACK;return-1;}my_memset(vm,0,sizeof(vm_t));const vmHeader_t*header=VM_LoadQVM(vm,bytecode,length);if(!header){vm->lastError=VM_FAILED_TO_LOAD_BYTECODE;VM_Free(vm);return-1;}vm->systemCall=systemCalls;vm->instructionCount=header->instructionCount;vm->instructionPointers=(intptr_t*)Com_malloc(vm->instructionCount*sizeof(*vm->instructionPointers),vm,VM_ALLOC_INSTRUCTION_POINTERS);if(!vm->instructionPointers){vm->lastError=VM_MALLOC_FAILED;VM_Free(vm);return-1;}vm->codeLength=header->codeLength;vm->compiled=0;if(!vm->compiled){if(VM_PrepareInterpreter(vm,header)!=0){VM_Free(vm);return-1;}}vm->programStack=vm->dataMask+1;vm->stackBottom=vm->programStack-0x10000;return 0;}static const vmHeader_t*VM_LoadQVM(vm_t*vm,const uint8_t*bytecode,int length){int dataLength;int i;const union{const vmHeader_t*h;const uint8_t*v;}header={.v=bytecode};if(!header.h||!bytecode||length<=(int)sizeof(vmHeader_t)||length>2*1000000){return NULL;}if(LittleEndianToHost((const uint8_t*)&(header.h->vmMagic))==0x31415927){for(i=0;i<(int)(sizeof(vmHeader_t))/4;i++){((int*)header.h)[i]=LittleEndianToHost((const uint8_t*)&(((int*)header.h)[i]));}if(header.h->bssLength<0||header.h->dataLength<0||header.h->litLength<0||header.h->codeLength<=0||header.h->codeOffset<0||header.h->dataOffset<0||header.h->instructionCount<=0||header.h->bssLength>10485760||header.h->codeOffset+header.h->codeLength>length||header.h->dataOffset+header.h->dataLength+header.h->litLength>length){return NULL;}}else{return NULL;}dataLength=header.h->dataLength+header.h->litLength+header.h->bssLength;for(i=0;dataLength>(1<<i);i++){}dataLength=1<<i;vm->dataAlloc=dataLength+4;vm->dataBase=(uint8_t*)Com_malloc(vm->dataAlloc,vm,VM_ALLOC_DATA_SEC);vm->dataMask=dataLength-1;if(vm->dataBase==NULL){return NULL;}my_memset(vm->dataBase,0,vm->dataAlloc);my_memcpy(vm->dataBase,header.v+header.h->dataOffset,header.h->dataLength+header.h->litLength);for(i=0;i<header.h->dataLength;i+=sizeof(int)){*(int*)(vm->dataBase+i)=LittleEndianToHost((const uint8_t*)&(*(int*)(vm->dataBase+i)));}return header.h;}intptr_t VM_Call(int offset,int glob_sz,vm_t*vm,int*argv,int nb_argv){intptr_t r;int args[18];int i,nb_argv_c;if(vm==NULL){return-1;}if(vm->codeLength<1){vm->lastError=VM_NOT_LOADED;return-1;}args[0]=0;nb_argv_c=nb_argv<18-2 ? nb_argv : 18-2;args[1]=nb_argv_c;if(nb_argv_c!=nb_argv){return-1;}for(i=0;i<nb_argv_c;i++){args[i+2]=argv[i];}++vm->callLevel;r=VM_CallInterpreted(offset,glob_sz,vm,args);--vm->callLevel;return r;}void VM_Free(vm_t*vm){if(!vm){return;}if(vm->callLevel){vm->lastError=VM_FREE_ON_RUNNING_VM;return;}if(vm->codeBase){Com_free(vm->codeBase,vm,VM_ALLOC_CODE_SEC);vm->codeBase=NULL;}if(vm->dataBase){Com_free(vm->dataBase,vm,VM_ALLOC_DATA_SEC);vm->dataBase=NULL;}if(vm->instructionPointers){Com_free(vm->instructionPointers,vm,VM_ALLOC_INSTRUCTION_POINTERS);vm->instructionPointers=NULL;}my_memset(vm,0,sizeof(*vm));}void*VM_ArgPtr(intptr_t vmAddr,vm_t*vm){if(!vmAddr){return NULL;}if(vm==NULL){return NULL;}return(void*)(vm->dataBase+(vmAddr&vm->dataMask));}float VM_IntToFloat(int32_t x){union{float f;int32_t i;uint32_t ui;}fi;fi.i=x;return fi.f;}int32_t VM_FloatToInt(float f){union{float f;int32_t i;uint32_t ui;}fi;fi.f=f;return fi.i;}int VM_MemoryRangeValid(intptr_t vmAddr,size_t len,const vm_t*vm){if(!vmAddr||!vm){return-1;}const unsigned dest=vmAddr;const unsigned dataMask=vm->dataMask;if((dest&dataMask)!=dest||((dest+len)&dataMask)!=dest+len){return-1;}else{return 0;}}static void VM_BlockCopy(unsigned int dest,unsigned int src,size_t n,vm_t*vm){unsigned int dataMask=vm->dataMask;if((dest&dataMask)!=dest||(src&dataMask)!=src||((dest+n)&dataMask)!=dest+n||((src+n)&dataMask)!=src+n){return;}my_memcpy(vm->dataBase+dest,vm->dataBase+src,n);}static int LittleEndianToHost(const uint8_t b[4]){return(b[0]<<0)|(b[1]<<8)|(b[2]<<16)|(b[3]<<24);}static int VM_PrepareInterpreter(vm_t*vm,const vmHeader_t*header){int op;int byte_pc;int int_pc;uint8_t*code;int instruction;int*codeBase;vm->codeBase=(uint8_t*)Com_malloc(vm->codeLength*4,vm,VM_ALLOC_CODE_SEC);if(!vm->codeBase){return-1;}my_memcpy(vm->codeBase,(uint8_t*)header+header->codeOffset,vm->codeLength);int_pc=byte_pc=0;instruction=0;code=(uint8_t*)header+header->codeOffset;codeBase=(int*)vm->codeBase;while(instruction<header->instructionCount){vm->instructionPointers[instruction]=int_pc;instruction++;op=(int)code[byte_pc];codeBase[int_pc]=op;if(byte_pc>header->codeLength){return-1;}byte_pc++;int_pc++;switch(op){case OP_ENTER:case OP_CONST:case OP_LOCAL:case OP_LEAVE:case OP_EQ:case OP_NE:case OP_LTI:case OP_LEI:case OP_GTI:case OP_GEI:case OP_LTU:case OP_LEU:case OP_GTU:case OP_GEU:case OP_EQF:case OP_NEF:case OP_LTF:case OP_LEF:case OP_GTF:case OP_GEF:case OP_BLOCK_COPY:codeBase[int_pc]=LittleEndianToHost(&code[byte_pc]);byte_pc+=4;int_pc++;break;case OP_ARG:codeBase[int_pc]=(int)code[byte_pc];byte_pc++;int_pc++;break;default:if(op<0||op>=OP_MAX){vm->lastError=VM_BAD_INSTRUCTION;return-1;}break;}}int_pc=0;instruction=0;while(instruction<header->instructionCount){op=codeBase[int_pc];instruction++;int_pc++;switch(op){case OP_EQ:case OP_NE:case OP_LTI:case OP_LEI:case OP_GTI:case OP_GEI:case OP_LTU:case OP_LEU:case OP_GTU:case OP_GEU:case OP_EQF:case OP_NEF:case OP_LTF:case OP_LEF:case OP_GTF:case OP_GEF:if(codeBase[int_pc]<0||codeBase[int_pc]>vm->instructionCount){return-1;}codeBase[int_pc]=vm->instructionPointers[codeBase[int_pc]];int_pc++;break;case OP_ENTER:case OP_CONST:case OP_LOCAL:case OP_LEAVE:case OP_BLOCK_COPY:case OP_ARG:int_pc++;break;default:break;}}return 0;}static int VM_CallInterpreted(int offset,int glob_sz,vm_t*vm,int*args){uint8_t stack[1024+15];int*opStack;uint8_t opStackOfs;int programCounter;int programStack;int stackOnEntry;uint8_t*image;int*codeImage;int v1;int dataMask;int arg;my_memcpy(shared_memory+glob_sz+8,internals+8*offset,8);vm->currentlyInterpreting=1;programStack=stackOnEntry=vm->programStack;image=vm->dataBase;codeImage=(int*)vm->codeBase;dataMask=vm->dataMask;programCounter=0;programStack-=(8+4*18);for(arg=0;arg<18;arg++){*(int*)&image[programStack+8+arg*4]=args[arg];}*(int*)&image[programStack+4]=0;*(int*)&image[programStack]=-1;opStack=((void*)((((intptr_t)(stack))+((16))-1)&~(((16))-1)));*opStack=0x0000BEEF;opStackOfs=0;int opcode,r0,r1;static const void*dispatch_table[64]={&&goto_OP_UNDEF,&&goto_OP_IGNORE,&&goto_OP_BREAK,&&goto_OP_ENTER,&&goto_OP_LEAVE,&&goto_OP_CALL,&&goto_OP_PUSH,&&goto_OP_POP,&&goto_OP_CONST,&&goto_OP_LOCAL,&&goto_OP_JUMP,&&goto_OP_EQ,&&goto_OP_NE,&&goto_OP_LTI,&&goto_OP_LEI,&&goto_OP_GTI,&&goto_OP_GEI,&&goto_OP_LTU,&&goto_OP_LEU,&&goto_OP_GTU,&&goto_OP_GEU,&&goto_OP_EQF,&&goto_OP_NEF,&&goto_OP_LTF,&&goto_OP_LEF,&&goto_OP_GTF,&&goto_OP_GEF,&&goto_OP_LOAD1,&&goto_OP_LOAD2,&&goto_OP_LOAD4,&&goto_OP_STORE1,&&goto_OP_STORE2,&&goto_OP_STORE4,&&goto_OP_ARG,&&goto_OP_BLOCK_COPY,&&goto_OP_SEX8,&&goto_OP_SEX16,&&goto_OP_NEGI,&&goto_OP_ADD,&&goto_OP_SUB,&&goto_OP_DIVI,&&goto_OP_DIVU,&&goto_OP_MODI,&&goto_OP_MODU,&&goto_OP_MULI,&&goto_OP_MULU,&&goto_OP_BAND,&&goto_OP_BOR,&&goto_OP_BXOR,&&goto_OP_BCOM,&&goto_OP_LSH,&&goto_OP_RSHI,&&goto_OP_RSHU,&&goto_OP_NEGF,&&goto_OP_ADDF,&&goto_OP_SUBF,&&goto_OP_DIVF,&&goto_OP_MULF,&&goto_OP_CVIF,&&goto_OP_CVFI,&&goto_OP_UNDEF,&&goto_OP_UNDEF,&&goto_OP_UNDEF,&&goto_OP_UNDEF,};r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];while(1){{goto_OP_UNDEF:return-1;goto_OP_IGNORE:opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BREAK:vm->breakCount++;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CONST:opStackOfs++;r1=r0;r0=opStack[opStackOfs]=codeImage[programCounter];programCounter+=1;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOCAL:opStackOfs++;r1=r0;r0=opStack[opStackOfs]=codeImage[programCounter]+programStack;programCounter+=1;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD4:r0=opStack[opStackOfs]=*(int*)&image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD2:r0=opStack[opStackOfs]=*(unsigned short*)&image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD1:r0=opStack[opStackOfs]=image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE4:*(int*)&image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE2:*(short*)&image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE1:image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ARG:*(int*)&image[(codeImage[programCounter]+programStack)&dataMask]=r0;opStackOfs--;programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BLOCK_COPY:VM_BlockCopy(r1,r0,codeImage[programCounter],vm);programCounter+=1;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CALL:*(int*)&image[programStack]=programCounter;programCounter=r0;opStackOfs--;if(programCounter<0){int r;vm->programStack=programStack-4;*(int*)&image[programStack+4]=-1-programCounter;if(sizeof(intptr_t)!=sizeof(int)){intptr_t argarr[16];int*imagePtr=(int*)&image[programStack];int i;for(i=0;i<(int)(sizeof(argarr)/sizeof(*(argarr)));++i){argarr[i]=*(++imagePtr);}r=vm->systemCall(vm,argarr);}else{r=vm->systemCall(vm,(intptr_t*)&image[programStack+4]);}opStackOfs++;opStack[opStackOfs]=r;programCounter=*(int*)&image[programStack];}else if((unsigned)programCounter>=(unsigned)vm->instructionCount){vm->lastError=VM_PC_OUT_OF_RANGE;return-1;}else{programCounter=vm->instructionPointers[programCounter];}r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_PUSH:opStackOfs++;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_POP:opStackOfs--;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ENTER:v1=codeImage[programCounter];programCounter+=1;programStack-=v1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LEAVE:v1=codeImage[programCounter];programStack+=v1;programCounter=*(int*)&image[programStack];if(programCounter==-1){goto done;}else if((unsigned)programCounter>=(unsigned)vm->codeLength){return-1;}r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_JUMP:if((unsigned)r0>=(unsigned)vm->instructionCount){return-1;}programCounter=vm->instructionPointers[r0];opStackOfs--;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_EQ:opStackOfs-=2;if(r1==r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NE:opStackOfs-=2;if(r1!=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTI:opStackOfs-=2;if(r1<r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEI:opStackOfs-=2;if(r1<=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTI:opStackOfs-=2;if(r1>r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEI:opStackOfs-=2;if(r1>=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTU:opStackOfs-=2;if(((unsigned)r1)<((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEU:opStackOfs-=2;if(((unsigned)r1)<=((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTU:opStackOfs-=2;if(((unsigned)r1)>((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEU:opStackOfs-=2;if(((unsigned)r1)>=((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_EQF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]==((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]!=((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]<((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)((uint8_t)(opStackOfs+1))]<=((float*)opStack)[(uint8_t)((uint8_t)(opStackOfs+2))]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]>((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]>=((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NEGI:opStack[opStackOfs]=-r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ADD:opStackOfs--;opStack[opStackOfs]=r1+r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SUB:opStackOfs--;opStack[opStackOfs]=r1-r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVI:opStackOfs--;opStack[opStackOfs]=r1/r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)/((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MODI:opStackOfs--;opStack[opStackOfs]=r1%r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MODU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)%((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULI:opStackOfs--;opStack[opStackOfs]=r1*r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)*((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BAND:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)&((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BOR:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)|((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BXOR:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)^((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BCOM:opStack[opStackOfs]=~((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LSH:opStackOfs--;opStack[opStackOfs]=r1<<r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_RSHI:opStackOfs--;opStack[opStackOfs]=r1>>r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_RSHU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)>>r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_NEGF:((float*)opStack)[opStackOfs]=-((float*)opStack)[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ADDF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]+((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SUBF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]-((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]/((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]*((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CVIF:((float*)opStack)[opStackOfs]=(float)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CVFI:opStack[opStackOfs]=((long)(((float*)opStack)[opStackOfs]));r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SEX8:opStack[opStackOfs]=(int8_t)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SEX16:opStack[opStackOfs]=(int16_t)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}}done:vm->currentlyInterpreting=0;if(opStackOfs!=1||*opStack!=0x0000BEEF){}vm->programStack=stackOnEntry;return opStack[opStackOfs];}void VM_Debug(int level){vm_debugLevel=level;}void VM_VmProfile_f(const vm_t*vm){(void)vm;}void*Com_malloc(size_t size,vm_t*vm,vmMallocType_t type){(void)vm;(void)type;return my_malloc(size);}void Com_free(void*p,vm_t*vm,vmMallocType_t type){(void)vm;(void)type;my_free(p);}intptr_t systemCalls(vm_t*vm,intptr_t*args){const int id=-1-args[0];switch(id){case-1:return 0;case-2:return 0;case-3:if(VM_MemoryRangeValid(args[1],args[3],vm)==0){my_memset(VM_ArgPtr(args[1],vm),args[2],args[3]);}return args[1];case-4:if(VM_MemoryRangeValid(args[1],args[3],vm)==0&&VM_MemoryRangeValid(args[2],args[3],vm)==0){my_memcpy(VM_ArgPtr(args[1],vm),VM_ArgPtr(args[2],vm),args[3]);}return args[1];case-8:my_memcpy(shared_memory+args[1],VM_ArgPtr(args[3],vm),args[2]*sizeof(unsigned char));return 0;case-9:my_memcpy(VM_ArgPtr(args[3],vm),shared_memory+args[1],args[2]*sizeof(unsigned char));return 0;default:return 0;}return 0;}struct basE91{unsigned long queue;unsigned int nbits;int val;};const unsigned char dectab[256]={91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,90,62,91,63,64,65,66,91,67,68,69,70,71,91,72,73,52,53,54,55,56,57,58,59,60,61,74,75,76,77,78,79,80,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,81,91,82,83,84,85,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,86,87,88,89,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91};void basE91_init(struct basE91*b){b->queue=0;b->nbits=0;b->val=-1;}unsigned int basE91_decode(struct basE91*b,const void*i,unsigned int len,void*o){const unsigned char*ib=i;unsigned char*ob=o;unsigned int n=0;unsigned int d;while(len--){d=dectab[*ib++];if(d==91)continue;if(b->val==-1)b->val=d;else{b->val+=d*91;b->queue|=b->val<<b->nbits;b->nbits+=(b->val&8191)>88 ? 13 : 14;do{ob[n++]=b->queue;b->queue>>=8;b->nbits-=8;}while(b->nbits>7);b->val=-1;}}return n;}unsigned int basE91_decode_end(struct basE91*b,void*o){unsigned char*ob=o;unsigned int n=0;if(b->val!=-1)ob[n++]=b->queue|b->val<<b->nbits;b->queue=0;b->nbits=0;b->val=-1;return n;}struct aes_key_struct{unsigned long rd_key[60];int rounds;};typedef struct aes_key_struct AES_KEY;int AES_set_encrypt_key(const unsigned char*userKey,const int bits,AES_KEY*key);void AES_encrypt(const unsigned char*in,unsigned char*out,const AES_KEY*key);static const unsigned long Te0[256]={0xc66363a5U,0xf87c7c84U,0xee777799U,0xf67b7b8dU,0xfff2f20dU,0xd66b6bbdU,0xde6f6fb1U,0x91c5c554U,0x60303050U,0x02010103U,0xce6767a9U,0x562b2b7dU,0xe7fefe19U,0xb5d7d762U,0x4dababe6U,0xec76769aU,0x8fcaca45U,0x1f82829dU,0x89c9c940U,0xfa7d7d87U,0xeffafa15U,0xb25959ebU,0x8e4747c9U,0xfbf0f00bU,0x41adadecU,0xb3d4d467U,0x5fa2a2fdU,0x45afafeaU,0x239c9cbfU,0x53a4a4f7U,0xe4727296U,0x9bc0c05bU,0x75b7b7c2U,0xe1fdfd1cU,0x3d9393aeU,0x4c26266aU,0x6c36365aU,0x7e3f3f41U,0xf5f7f702U,0x83cccc4fU,0x6834345cU,0x51a5a5f4U,0xd1e5e534U,0xf9f1f108U,0xe2717193U,0xabd8d873U,0x62313153U,0x2a15153fU,0x0804040cU,0x95c7c752U,0x46232365U,0x9dc3c35eU,0x30181828U,0x379696a1U,0x0a05050fU,0x2f9a9ab5U,0x0e070709U,0x24121236U,0x1b80809bU,0xdfe2e23dU,0xcdebeb26U,0x4e272769U,0x7fb2b2cdU,0xea75759fU,0x1209091bU,0x1d83839eU,0x582c2c74U,0x341a1a2eU,0x361b1b2dU,0xdc6e6eb2U,0xb45a5aeeU,0x5ba0a0fbU,0xa45252f6U,0x763b3b4dU,0xb7d6d661U,0x7db3b3ceU,0x5229297bU,0xdde3e33eU,0x5e2f2f71U,0x13848497U,0xa65353f5U,0xb9d1d168U,0x00000000U,0xc1eded2cU,0x40202060U,0xe3fcfc1fU,0x79b1b1c8U,0xb65b5bedU,0xd46a6abeU,0x8dcbcb46U,0x67bebed9U,0x7239394bU,0x944a4adeU,0x984c4cd4U,0xb05858e8U,0x85cfcf4aU,0xbbd0d06bU,0xc5efef2aU,0x4faaaae5U,0xedfbfb16U,0x864343c5U,0x9a4d4dd7U,0x66333355U,0x11858594U,0x8a4545cfU,0xe9f9f910U,0x04020206U,0xfe7f7f81U,0xa05050f0U,0x783c3c44U,0x259f9fbaU,0x4ba8a8e3U,0xa25151f3U,0x5da3a3feU,0x804040c0U,0x058f8f8aU,0x3f9292adU,0x219d9dbcU,0x70383848U,0xf1f5f504U,0x63bcbcdfU,0x77b6b6c1U,0xafdada75U,0x42212163U,0x20101030U,0xe5ffff1aU,0xfdf3f30eU,0xbfd2d26dU,0x81cdcd4cU,0x180c0c14U,0x26131335U,0xc3ecec2fU,0xbe5f5fe1U,0x359797a2U,0x884444ccU,0x2e171739U,0x93c4c457U,0x55a7a7f2U,0xfc7e7e82U,0x7a3d3d47U,0xc86464acU,0xba5d5de7U,0x3219192bU,0xe6737395U,0xc06060a0U,0x19818198U,0x9e4f4fd1U,0xa3dcdc7fU,0x44222266U,0x542a2a7eU,0x3b9090abU,0x0b888883U,0x8c4646caU,0xc7eeee29U,0x6bb8b8d3U,0x2814143cU,0xa7dede79U,0xbc5e5ee2U,0x160b0b1dU,0xaddbdb76U,0xdbe0e03bU,0x64323256U,0x743a3a4eU,0x140a0a1eU,0x924949dbU,0x0c06060aU,0x4824246cU,0xb85c5ce4U,0x9fc2c25dU,0xbdd3d36eU,0x43acacefU,0xc46262a6U,0x399191a8U,0x319595a4U,0xd3e4e437U,0xf279798bU,0xd5e7e732U,0x8bc8c843U,0x6e373759U,0xda6d6db7U,0x018d8d8cU,0xb1d5d564U,0x9c4e4ed2U,0x49a9a9e0U,0xd86c6cb4U,0xac5656faU,0xf3f4f407U,0xcfeaea25U,0xca6565afU,0xf47a7a8eU,0x47aeaee9U,0x10080818U,0x6fbabad5U,0xf0787888U,0x4a25256fU,0x5c2e2e72U,0x381c1c24U,0x57a6a6f1U,0x73b4b4c7U,0x97c6c651U,0xcbe8e823U,0xa1dddd7cU,0xe874749cU,0x3e1f1f21U,0x964b4bddU,0x61bdbddcU,0x0d8b8b86U,0x0f8a8a85U,0xe0707090U,0x7c3e3e42U,0x71b5b5c4U,0xcc6666aaU,0x904848d8U,0x06030305U,0xf7f6f601U,0x1c0e0e12U,0xc26161a3U,0x6a35355fU,0xae5757f9U,0x69b9b9d0U,0x17868691U,0x99c1c158U,0x3a1d1d27U,0x279e9eb9U,0xd9e1e138U,0xebf8f813U,0x2b9898b3U,0x22111133U,0xd26969bbU,0xa9d9d970U,0x078e8e89U,0x339494a7U,0x2d9b9bb6U,0x3c1e1e22U,0x15878792U,0xc9e9e920U,0x87cece49U,0xaa5555ffU,0x50282878U,0xa5dfdf7aU,0x038c8c8fU,0x59a1a1f8U,0x09898980U,0x1a0d0d17U,0x65bfbfdaU,0xd7e6e631U,0x844242c6U,0xd06868b8U,0x824141c3U,0x299999b0U,0x5a2d2d77U,0x1e0f0f11U,0x7bb0b0cbU,0xa85454fcU,0x6dbbbbd6U,0x2c16163aU,};static const unsigned long Te1[256]={0xa5c66363U,0x84f87c7cU,0x99ee7777U,0x8df67b7bU,0x0dfff2f2U,0xbdd66b6bU,0xb1de6f6fU,0x5491c5c5U,0x50603030U,0x03020101U,0xa9ce6767U,0x7d562b2bU,0x19e7fefeU,0x62b5d7d7U,0xe64dababU,0x9aec7676U,0x458fcacaU,0x9d1f8282U,0x4089c9c9U,0x87fa7d7dU,0x15effafaU,0xebb25959U,0xc98e4747U,0x0bfbf0f0U,0xec41adadU,0x67b3d4d4U,0xfd5fa2a2U,0xea45afafU,0xbf239c9cU,0xf753a4a4U,0x96e47272U,0x5b9bc0c0U,0xc275b7b7U,0x1ce1fdfdU,0xae3d9393U,0x6a4c2626U,0x5a6c3636U,0x417e3f3fU,0x02f5f7f7U,0x4f83ccccU,0x5c683434U,0xf451a5a5U,0x34d1e5e5U,0x08f9f1f1U,0x93e27171U,0x73abd8d8U,0x53623131U,0x3f2a1515U,0x0c080404U,0x5295c7c7U,0x65462323U,0x5e9dc3c3U,0x28301818U,0xa1379696U,0x0f0a0505U,0xb52f9a9aU,0x090e0707U,0x36241212U,0x9b1b8080U,0x3ddfe2e2U,0x26cdebebU,0x694e2727U,0xcd7fb2b2U,0x9fea7575U,0x1b120909U,0x9e1d8383U,0x74582c2cU,0x2e341a1aU,0x2d361b1bU,0xb2dc6e6eU,0xeeb45a5aU,0xfb5ba0a0U,0xf6a45252U,0x4d763b3bU,0x61b7d6d6U,0xce7db3b3U,0x7b522929U,0x3edde3e3U,0x715e2f2fU,0x97138484U,0xf5a65353U,0x68b9d1d1U,0x00000000U,0x2cc1ededU,0x60402020U,0x1fe3fcfcU,0xc879b1b1U,0xedb65b5bU,0xbed46a6aU,0x468dcbcbU,0xd967bebeU,0x4b723939U,0xde944a4aU,0xd4984c4cU,0xe8b05858U,0x4a85cfcfU,0x6bbbd0d0U,0x2ac5efefU,0xe54faaaaU,0x16edfbfbU,0xc5864343U,0xd79a4d4dU,0x55663333U,0x94118585U,0xcf8a4545U,0x10e9f9f9U,0x06040202U,0x81fe7f7fU,0xf0a05050U,0x44783c3cU,0xba259f9fU,0xe34ba8a8U,0xf3a25151U,0xfe5da3a3U,0xc0804040U,0x8a058f8fU,0xad3f9292U,0xbc219d9dU,0x48703838U,0x04f1f5f5U,0xdf63bcbcU,0xc177b6b6U,0x75afdadaU,0x63422121U,0x30201010U,0x1ae5ffffU,0x0efdf3f3U,0x6dbfd2d2U,0x4c81cdcdU,0x14180c0cU,0x35261313U,0x2fc3ececU,0xe1be5f5fU,0xa2359797U,0xcc884444U,0x392e1717U,0x5793c4c4U,0xf255a7a7U,0x82fc7e7eU,0x477a3d3dU,0xacc86464U,0xe7ba5d5dU,0x2b321919U,0x95e67373U,0xa0c06060U,0x98198181U,0xd19e4f4fU,0x7fa3dcdcU,0x66442222U,0x7e542a2aU,0xab3b9090U,0x830b8888U,0xca8c4646U,0x29c7eeeeU,0xd36bb8b8U,0x3c281414U,0x79a7dedeU,0xe2bc5e5eU,0x1d160b0bU,0x76addbdbU,0x3bdbe0e0U,0x56643232U,0x4e743a3aU,0x1e140a0aU,0xdb924949U,0x0a0c0606U,0x6c482424U,0xe4b85c5cU,0x5d9fc2c2U,0x6ebdd3d3U,0xef43acacU,0xa6c46262U,0xa8399191U,0xa4319595U,0x37d3e4e4U,0x8bf27979U,0x32d5e7e7U,0x438bc8c8U,0x596e3737U,0xb7da6d6dU,0x8c018d8dU,0x64b1d5d5U,0xd29c4e4eU,0xe049a9a9U,0xb4d86c6cU,0xfaac5656U,0x07f3f4f4U,0x25cfeaeaU,0xafca6565U,0x8ef47a7aU,0xe947aeaeU,0x18100808U,0xd56fbabaU,0x88f07878U,0x6f4a2525U,0x725c2e2eU,0x24381c1cU,0xf157a6a6U,0xc773b4b4U,0x5197c6c6U,0x23cbe8e8U,0x7ca1ddddU,0x9ce87474U,0x213e1f1fU,0xdd964b4bU,0xdc61bdbdU,0x860d8b8bU,0x850f8a8aU,0x90e07070U,0x427c3e3eU,0xc471b5b5U,0xaacc6666U,0xd8904848U,0x05060303U,0x01f7f6f6U,0x121c0e0eU,0xa3c26161U,0x5f6a3535U,0xf9ae5757U,0xd069b9b9U,0x91178686U,0x5899c1c1U,0x273a1d1dU,0xb9279e9eU,0x38d9e1e1U,0x13ebf8f8U,0xb32b9898U,0x33221111U,0xbbd26969U,0x70a9d9d9U,0x89078e8eU,0xa7339494U,0xb62d9b9bU,0x223c1e1eU,0x92158787U,0x20c9e9e9U,0x4987ceceU,0xffaa5555U,0x78502828U,0x7aa5dfdfU,0x8f038c8cU,0xf859a1a1U,0x80098989U,0x171a0d0dU,0xda65bfbfU,0x31d7e6e6U,0xc6844242U,0xb8d06868U,0xc3824141U,0xb0299999U,0x775a2d2dU,0x111e0f0fU,0xcb7bb0b0U,0xfca85454U,0xd66dbbbbU,0x3a2c1616U,};static const unsigned long Te2[256]={0x63a5c663U,0x7c84f87cU,0x7799ee77U,0x7b8df67bU,0xf20dfff2U,0x6bbdd66bU,0x6fb1de6fU,0xc55491c5U,0x30506030U,0x01030201U,0x67a9ce67U,0x2b7d562bU,0xfe19e7feU,0xd762b5d7U,0xabe64dabU,0x769aec76U,0xca458fcaU,0x829d1f82U,0xc94089c9U,0x7d87fa7dU,0xfa15effaU,0x59ebb259U,0x47c98e47U,0xf00bfbf0U,0xadec41adU,0xd467b3d4U,0xa2fd5fa2U,0xafea45afU,0x9cbf239cU,0xa4f753a4U,0x7296e472U,0xc05b9bc0U,0xb7c275b7U,0xfd1ce1fdU,0x93ae3d93U,0x266a4c26U,0x365a6c36U,0x3f417e3fU,0xf702f5f7U,0xcc4f83ccU,0x345c6834U,0xa5f451a5U,0xe534d1e5U,0xf108f9f1U,0x7193e271U,0xd873abd8U,0x31536231U,0x153f2a15U,0x040c0804U,0xc75295c7U,0x23654623U,0xc35e9dc3U,0x18283018U,0x96a13796U,0x050f0a05U,0x9ab52f9aU,0x07090e07U,0x12362412U,0x809b1b80U,0xe23ddfe2U,0xeb26cdebU,0x27694e27U,0xb2cd7fb2U,0x759fea75U,0x091b1209U,0x839e1d83U,0x2c74582cU,0x1a2e341aU,0x1b2d361bU,0x6eb2dc6eU,0x5aeeb45aU,0xa0fb5ba0U,0x52f6a452U,0x3b4d763bU,0xd661b7d6U,0xb3ce7db3U,0x297b5229U,0xe33edde3U,0x2f715e2fU,0x84971384U,0x53f5a653U,0xd168b9d1U,0x00000000U,0xed2cc1edU,0x20604020U,0xfc1fe3fcU,0xb1c879b1U,0x5bedb65bU,0x6abed46aU,0xcb468dcbU,0xbed967beU,0x394b7239U,0x4ade944aU,0x4cd4984cU,0x58e8b058U,0xcf4a85cfU,0xd06bbbd0U,0xef2ac5efU,0xaae54faaU,0xfb16edfbU,0x43c58643U,0x4dd79a4dU,0x33556633U,0x85941185U,0x45cf8a45U,0xf910e9f9U,0x02060402U,0x7f81fe7fU,0x50f0a050U,0x3c44783cU,0x9fba259fU,0xa8e34ba8U,0x51f3a251U,0xa3fe5da3U,0x40c08040U,0x8f8a058fU,0x92ad3f92U,0x9dbc219dU,0x38487038U,0xf504f1f5U,0xbcdf63bcU,0xb6c177b6U,0xda75afdaU,0x21634221U,0x10302010U,0xff1ae5ffU,0xf30efdf3U,0xd26dbfd2U,0xcd4c81cdU,0x0c14180cU,0x13352613U,0xec2fc3ecU,0x5fe1be5fU,0x97a23597U,0x44cc8844U,0x17392e17U,0xc45793c4U,0xa7f255a7U,0x7e82fc7eU,0x3d477a3dU,0x64acc864U,0x5de7ba5dU,0x192b3219U,0x7395e673U,0x60a0c060U,0x81981981U,0x4fd19e4fU,0xdc7fa3dcU,0x22664422U,0x2a7e542aU,0x90ab3b90U,0x88830b88U,0x46ca8c46U,0xee29c7eeU,0xb8d36bb8U,0x143c2814U,0xde79a7deU,0x5ee2bc5eU,0x0b1d160bU,0xdb76addbU,0xe03bdbe0U,0x32566432U,0x3a4e743aU,0x0a1e140aU,0x49db9249U,0x060a0c06U,0x246c4824U,0x5ce4b85cU,0xc25d9fc2U,0xd36ebdd3U,0xacef43acU,0x62a6c462U,0x91a83991U,0x95a43195U,0xe437d3e4U,0x798bf279U,0xe732d5e7U,0xc8438bc8U,0x37596e37U,0x6db7da6dU,0x8d8c018dU,0xd564b1d5U,0x4ed29c4eU,0xa9e049a9U,0x6cb4d86cU,0x56faac56U,0xf407f3f4U,0xea25cfeaU,0x65afca65U,0x7a8ef47aU,0xaee947aeU,0x08181008U,0xbad56fbaU,0x7888f078U,0x256f4a25U,0x2e725c2eU,0x1c24381cU,0xa6f157a6U,0xb4c773b4U,0xc65197c6U,0xe823cbe8U,0xdd7ca1ddU,0x749ce874U,0x1f213e1fU,0x4bdd964bU,0xbddc61bdU,0x8b860d8bU,0x8a850f8aU,0x7090e070U,0x3e427c3eU,0xb5c471b5U,0x66aacc66U,0x48d89048U,0x03050603U,0xf601f7f6U,0x0e121c0eU,0x61a3c261U,0x355f6a35U,0x57f9ae57U,0xb9d069b9U,0x86911786U,0xc15899c1U,0x1d273a1dU,0x9eb9279eU,0xe138d9e1U,0xf813ebf8U,0x98b32b98U,0x11332211U,0x69bbd269U,0xd970a9d9U,0x8e89078eU,0x94a73394U,0x9bb62d9bU,0x1e223c1eU,0x87921587U,0xe920c9e9U,0xce4987ceU,0x55ffaa55U,0x28785028U,0xdf7aa5dfU,0x8c8f038cU,0xa1f859a1U,0x89800989U,0x0d171a0dU,0xbfda65bfU,0xe631d7e6U,0x42c68442U,0x68b8d068U,0x41c38241U,0x99b02999U,0x2d775a2dU,0x0f111e0fU,0xb0cb7bb0U,0x54fca854U,0xbbd66dbbU,0x163a2c16U,};static const unsigned long Te3[256]={0x6363a5c6U,0x7c7c84f8U,0x777799eeU,0x7b7b8df6U,0xf2f20dffU,0x6b6bbdd6U,0x6f6fb1deU,0xc5c55491U,0x30305060U,0x01010302U,0x6767a9ceU,0x2b2b7d56U,0xfefe19e7U,0xd7d762b5U,0xababe64dU,0x76769aecU,0xcaca458fU,0x82829d1fU,0xc9c94089U,0x7d7d87faU,0xfafa15efU,0x5959ebb2U,0x4747c98eU,0xf0f00bfbU,0xadadec41U,0xd4d467b3U,0xa2a2fd5fU,0xafafea45U,0x9c9cbf23U,0xa4a4f753U,0x727296e4U,0xc0c05b9bU,0xb7b7c275U,0xfdfd1ce1U,0x9393ae3dU,0x26266a4cU,0x36365a6cU,0x3f3f417eU,0xf7f702f5U,0xcccc4f83U,0x34345c68U,0xa5a5f451U,0xe5e534d1U,0xf1f108f9U,0x717193e2U,0xd8d873abU,0x31315362U,0x15153f2aU,0x04040c08U,0xc7c75295U,0x23236546U,0xc3c35e9dU,0x18182830U,0x9696a137U,0x05050f0aU,0x9a9ab52fU,0x0707090eU,0x12123624U,0x80809b1bU,0xe2e23ddfU,0xebeb26cdU,0x2727694eU,0xb2b2cd7fU,0x75759feaU,0x09091b12U,0x83839e1dU,0x2c2c7458U,0x1a1a2e34U,0x1b1b2d36U,0x6e6eb2dcU,0x5a5aeeb4U,0xa0a0fb5bU,0x5252f6a4U,0x3b3b4d76U,0xd6d661b7U,0xb3b3ce7dU,0x29297b52U,0xe3e33eddU,0x2f2f715eU,0x84849713U,0x5353f5a6U,0xd1d168b9U,0x00000000U,0xeded2cc1U,0x20206040U,0xfcfc1fe3U,0xb1b1c879U,0x5b5bedb6U,0x6a6abed4U,0xcbcb468dU,0xbebed967U,0x39394b72U,0x4a4ade94U,0x4c4cd498U,0x5858e8b0U,0xcfcf4a85U,0xd0d06bbbU,0xefef2ac5U,0xaaaae54fU,0xfbfb16edU,0x4343c586U,0x4d4dd79aU,0x33335566U,0x85859411U,0x4545cf8aU,0xf9f910e9U,0x02020604U,0x7f7f81feU,0x5050f0a0U,0x3c3c4478U,0x9f9fba25U,0xa8a8e34bU,0x5151f3a2U,0xa3a3fe5dU,0x4040c080U,0x8f8f8a05U,0x9292ad3fU,0x9d9dbc21U,0x38384870U,0xf5f504f1U,0xbcbcdf63U,0xb6b6c177U,0xdada75afU,0x21216342U,0x10103020U,0xffff1ae5U,0xf3f30efdU,0xd2d26dbfU,0xcdcd4c81U,0x0c0c1418U,0x13133526U,0xecec2fc3U,0x5f5fe1beU,0x9797a235U,0x4444cc88U,0x1717392eU,0xc4c45793U,0xa7a7f255U,0x7e7e82fcU,0x3d3d477aU,0x6464acc8U,0x5d5de7baU,0x19192b32U,0x737395e6U,0x6060a0c0U,0x81819819U,0x4f4fd19eU,0xdcdc7fa3U,0x22226644U,0x2a2a7e54U,0x9090ab3bU,0x8888830bU,0x4646ca8cU,0xeeee29c7U,0xb8b8d36bU,0x14143c28U,0xdede79a7U,0x5e5ee2bcU,0x0b0b1d16U,0xdbdb76adU,0xe0e03bdbU,0x32325664U,0x3a3a4e74U,0x0a0a1e14U,0x4949db92U,0x06060a0cU,0x24246c48U,0x5c5ce4b8U,0xc2c25d9fU,0xd3d36ebdU,0xacacef43U,0x6262a6c4U,0x9191a839U,0x9595a431U,0xe4e437d3U,0x79798bf2U,0xe7e732d5U,0xc8c8438bU,0x3737596eU,0x6d6db7daU,0x8d8d8c01U,0xd5d564b1U,0x4e4ed29cU,0xa9a9e049U,0x6c6cb4d8U,0x5656faacU,0xf4f407f3U,0xeaea25cfU,0x6565afcaU,0x7a7a8ef4U,0xaeaee947U,0x08081810U,0xbabad56fU,0x787888f0U,0x25256f4aU,0x2e2e725cU,0x1c1c2438U,0xa6a6f157U,0xb4b4c773U,0xc6c65197U,0xe8e823cbU,0xdddd7ca1U,0x74749ce8U,0x1f1f213eU,0x4b4bdd96U,0xbdbddc61U,0x8b8b860dU,0x8a8a850fU,0x707090e0U,0x3e3e427cU,0xb5b5c471U,0x6666aaccU,0x4848d890U,0x03030506U,0xf6f601f7U,0x0e0e121cU,0x6161a3c2U,0x35355f6aU,0x5757f9aeU,0xb9b9d069U,0x86869117U,0xc1c15899U,0x1d1d273aU,0x9e9eb927U,0xe1e138d9U,0xf8f813ebU,0x9898b32bU,0x11113322U,0x6969bbd2U,0xd9d970a9U,0x8e8e8907U,0x9494a733U,0x9b9bb62dU,0x1e1e223cU,0x87879215U,0xe9e920c9U,0xcece4987U,0x5555ffaaU,0x28287850U,0xdfdf7aa5U,0x8c8c8f03U,0xa1a1f859U,0x89898009U,0x0d0d171aU,0xbfbfda65U,0xe6e631d7U,0x4242c684U,0x6868b8d0U,0x4141c382U,0x9999b029U,0x2d2d775aU,0x0f0f111eU,0xb0b0cb7bU,0x5454fca8U,0xbbbbd66dU,0x16163a2cU,};static const unsigned long rcon[]={0x01000000,0x02000000,0x04000000,0x08000000,0x10000000,0x20000000,0x40000000,0x80000000,0x1B000000,0x36000000,};int AES_set_encrypt_key(const unsigned char*userKey,const int bits,AES_KEY*key){unsigned long*rk;int i=0;unsigned long temp;if(!userKey||!key)return-1;if(bits!=128&&bits!=192&&bits!=256)return-2;rk=key->rd_key;if(bits==128)key->rounds=10;else if(bits==192)key->rounds=12;else key->rounds=14;rk[0]=(((unsigned long)(userKey)[3])^((unsigned long)(userKey)[2]<<8)^((unsigned long)(userKey)[1]<<16)^((unsigned long)(userKey)[0]<<24));rk[1]=(((unsigned long)(userKey+4)[3])^((unsigned long)(userKey+4)[2]<<8)^((unsigned long)(userKey+4)[1]<<16)^((unsigned long)(userKey+4)[0]<<24));rk[2]=(((unsigned long)(userKey+8)[3])^((unsigned long)(userKey+8)[2]<<8)^((unsigned long)(userKey+8)[1]<<16)^((unsigned long)(userKey+8)[0]<<24));rk[3]=(((unsigned long)(userKey+12)[3])^((unsigned long)(userKey+12)[2]<<8)^((unsigned long)(userKey+12)[1]<<16)^((unsigned long)(userKey+12)[0]<<24));if(bits==128){while(1){temp=rk[3];rk[4]=rk[0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[5]=rk[1]^rk[4];rk[6]=rk[2]^rk[5];rk[7]=rk[3]^rk[6];if(++i==10){return 0;}rk+=4;}}rk[4]=(((unsigned long)(userKey+16)[3])^((unsigned long)(userKey+16)[2]<<8)^((unsigned long)(userKey+16)[1]<<16)^((unsigned long)(userKey+16)[0]<<24));rk[5]=(((unsigned long)(userKey+20)[3])^((unsigned long)(userKey+20)[2]<<8)^((unsigned long)(userKey+20)[1]<<16)^((unsigned long)(userKey+20)[0]<<24));if(bits==192){while(1){temp=rk[ 5];rk[ 6]=rk[ 0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[ 7]=rk[ 1]^rk[ 6];rk[ 8]=rk[ 2]^rk[ 7];rk[ 9]=rk[ 3]^rk[ 8];if(++i==8){return 0;}rk[10]=rk[ 4]^rk[ 9];rk[11]=rk[ 5]^rk[10];rk+=6;}}rk[6]=(((unsigned long)(userKey+24)[3])^((unsigned long)(userKey+24)[2]<<8)^((unsigned long)(userKey+24)[1]<<16)^((unsigned long)(userKey+24)[0]<<24));rk[7]=(((unsigned long)(userKey+28)[3])^((unsigned long)(userKey+28)[2]<<8)^((unsigned long)(userKey+28)[1]<<16)^((unsigned long)(userKey+28)[0]<<24));if(bits==256){while(1){temp=rk[ 7];rk[ 8]=rk[ 0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[ 9]=rk[ 1]^rk[ 8];rk[10]=rk[ 2]^rk[ 9];rk[11]=rk[ 3]^rk[10];if(++i==7){return 0;}temp=rk[11];rk[12]=rk[ 4]^(Te2[(temp>>24)]&0xff000000)^(Te3[(temp>>16)&0xff]&0x00ff0000)^(Te0[(temp>>8)&0xff]&0x0000ff00)^(Te1[(temp)&0xff]&0x000000ff);rk[13]=rk[ 5]^rk[12];rk[14]=rk[ 6]^rk[13];rk[15]=rk[ 7]^rk[14];rk+=8;}}return 0;}void AES_encrypt(const unsigned char*in,unsigned char*out,const AES_KEY*key){const unsigned long*rk;unsigned long s0,s1,s2,s3,t0,t1,t2,t3;int r;rk=key->rd_key;s0=(((unsigned long)(in)[3])^((unsigned long)(in)[2]<<8)^((unsigned long)(in)[1]<<16)^((unsigned long)(in)[0]<<24))^rk[0];s1=(((unsigned long)(in+4)[3])^((unsigned long)(in+4)[2]<<8)^((unsigned long)(in+4)[1]<<16)^((unsigned long)(in+4)[0]<<24))^rk[1];s2=(((unsigned long)(in+8)[3])^((unsigned long)(in+8)[2]<<8)^((unsigned long)(in+8)[1]<<16)^((unsigned long)(in+8)[0]<<24))^rk[2];s3=(((unsigned long)(in+12)[3])^((unsigned long)(in+12)[2]<<8)^((unsigned long)(in+12)[1]<<16)^((unsigned long)(in+12)[0]<<24))^rk[3];r=key->rounds>>1;for(;;){t0=Te0[(s0>>24)]^Te1[(s1>>16)&0xff]^Te2[(s2>>8)&0xff]^Te3[(s3)&0xff]^rk[4];t1=Te0[(s1>>24)]^Te1[(s2>>16)&0xff]^Te2[(s3>>8)&0xff]^Te3[(s0)&0xff]^rk[5];t2=Te0[(s2>>24)]^Te1[(s3>>16)&0xff]^Te2[(s0>>8)&0xff]^Te3[(s1)&0xff]^rk[6];t3=Te0[(s3>>24)]^Te1[(s0>>16)&0xff]^Te2[(s1>>8)&0xff]^Te3[(s2)&0xff]^rk[7];rk+=8;if(--r==0){break;}s0=Te0[(t0>>24)]^Te1[(t1>>16)&0xff]^Te2[(t2>>8)&0xff]^Te3[(t3)&0xff]^rk[0];s1=Te0[(t1>>24)]^Te1[(t2>>16)&0xff]^Te2[(t3>>8)&0xff]^Te3[(t0)&0xff]^rk[1];s2=Te0[(t2>>24)]^Te1[(t3>>16)&0xff]^Te2[(t0>>8)&0xff]^Te3[(t1)&0xff]^rk[2];s3=Te0[(t3>>24)]^Te1[(t0>>16)&0xff]^Te2[(t1>>8)&0xff]^Te3[(t2)&0xff]^rk[3];}s0=(Te2[(t0>>24)]&0xff000000)^(Te3[(t1>>16)&0xff]&0x00ff0000)^(Te0[(t2>>8)&0xff]&0x0000ff00)^(Te1[(t3)&0xff]&0x000000ff)^rk[0];{(out)[3]=(unsigned char)(s0);(out)[2]=(unsigned char)((s0)>>8);(out)[1]=(unsigned char)((s0)>>16);(out)[0]=(unsigned char)((s0)>>24);};s1=(Te2[(t1>>24)]&0xff000000)^(Te3[(t2>>16)&0xff]&0x00ff0000)^(Te0[(t3>>8)&0xff]&0x0000ff00)^(Te1[(t0)&0xff]&0x000000ff)^rk[1];{(out+4)[3]=(unsigned char)(s1);(out+4)[2]=(unsigned char)((s1)>>8);(out+4)[1]=(unsigned char)((s1)>>16);(out+4)[0]=(unsigned char)((s1)>>24);};s2=(Te2[(t2>>24)]&0xff000000)^(Te3[(t3>>16)&0xff]&0x00ff0000)^(Te0[(t0>>8)&0xff]&0x0000ff00)^(Te1[(t1)&0xff]&0x000000ff)^rk[2];{(out+8)[3]=(unsigned char)(s2);(out+8)[2]=(unsigned char)((s2)>>8);(out+8)[1]=(unsigned char)((s2)>>16);(out+8)[0]=(unsigned char)((s2)>>24);};s3=(Te2[(t3>>24)]&0xff000000)^(Te3[(t0>>16)&0xff]&0x00ff0000)^(Te0[(t1>>8)&0xff]&0x0000ff00)^(Te1[(t2)&0xff]&0x000000ff)^rk[3];{(out+12)[3]=(unsigned char)(s3);(out+12)[2]=(unsigned char)((s3)>>8);(out+12)[1]=(unsigned char)((s3)>>16);(out+12)[0]=(unsigned char)((s3)>>24);};}void checksum1(unsigned char crc[4],const unsigned char*buf,unsigned int sz){unsigned int sum=0xcafedeca;unsigned int i;for(i=0;i<sz;i++){sum+=buf[i];}for(i=0;i<4;i++){crc[3-i]=sum&0xff;sum>>=8;}}void checksum2(unsigned char crc[4],const unsigned char*buf,unsigned int sz){unsigned int sum=0xdeadface;unsigned int i;for(i=0;i<sz;i++){sum+=buf[i];}for(i=0;i<4;i++){crc[3-i]=sum&0xff;sum>>=8;}}int decrypt_cfb(int glob_sz,unsigned char*data,unsigned int data_sz,unsigned char iv[16],unsigned char key[16]){unsigned char tmp[16],state[16];AES_KEY akey;unsigned int i,j;unsigned char crc[4];AES_set_encrypt_key(key,128,&akey);checksum1(crc,data,data_sz);my_memcpy(shared_memory+glob_sz,crc,4);my_memcpy(tmp,iv,16);for(i=0;i<(data_sz/16)+1;i++){AES_encrypt(tmp,state,&akey);if(data_sz-16*i<16){my_memcpy(tmp,data+16*i,data_sz-16*i);for(j=0;j<(data_sz-16*i);j++){data[16*i+j]^=state[j];}}else{my_memcpy(tmp,data+16*i,16);for(j=0;j<16;j++){data[16*i+j]^=state[j];}}}my_memset(tmp,0xcc,16);my_memset(state,0xcc,16);my_memset(&akey,0xcc,sizeof(AES_KEY));return 0;}struct arbre{short branche0;short branche1;};struct arbre_data{unsigned long frequence;short index_suivant;};struct dictionnaire{unsigned char taille;char code[32];};short huffman_lire_frequences_buf(unsigned char*input,unsigned int*dec_sz);short huffman_creer_arbre(short index_frequence);unsigned char*huffman_uncompress(int global_sz,unsigned char*input,unsigned int input_sz,unsigned int*output_sz);struct arbre_data*arbre_d;struct arbre*arbre;struct dictionnaire*dico;short huffman_lire_frequences_buf(unsigned char*input,unsigned int*dec_sz){unsigned int offset;unsigned short nbre_ascii;unsigned char i;short index_frequence=-1,index_precedent=-1;offset=0;nbre_ascii=(input[1]<<8)|input[0];offset+=2;while(nbre_ascii>0){i=input[offset];offset++;my_memcpy((char*)&arbre_d[i].frequence,input+offset,4);offset+=4;if(index_frequence==-1)index_frequence=i;else arbre_d[index_precedent].index_suivant=i;index_precedent=i;nbre_ascii--;}*dec_sz=offset;if(index_precedent==-1)return-1;arbre_d[index_precedent].index_suivant=-1;return index_frequence;}short huffman_creer_arbre(short index_frequence){short i,j,j_save;unsigned long somme_frequence;short nbre_noeuds=256;char struct_inseree=0;for(j=0;j<256;j++)arbre[j].branche0=arbre[j].branche1=-1;i=index_frequence;while(i!=-1){if(arbre_d[i].index_suivant==-1){break;}somme_frequence=arbre_d[i].frequence+arbre_d[arbre_d[i].index_suivant].frequence;arbre_d[nbre_noeuds].frequence=somme_frequence;arbre[nbre_noeuds].branche0=arbre_d[i].index_suivant;arbre[nbre_noeuds].branche1=i;j_save=-1;struct_inseree=0;j=i;while(j!=-1&&struct_inseree==0){if(arbre_d[j].frequence>=somme_frequence){if(j_save!=-1)arbre_d[j_save].index_suivant=nbre_noeuds;arbre_d[nbre_noeuds].index_suivant=j;struct_inseree=1;}j_save=j;j=arbre_d[j].index_suivant;}if(struct_inseree==0){arbre_d[j_save].index_suivant=nbre_noeuds;arbre_d[nbre_noeuds].index_suivant=-1;}nbre_noeuds++;i=arbre_d[i].index_suivant;i=arbre_d[i].index_suivant;}return nbre_noeuds-1;}unsigned char*huffman_uncompress(int glob_sz,unsigned char*input,unsigned int input_sz,unsigned int*output_sz){unsigned int i,j,k,offset_in,offset_out,r,dec;unsigned long nbre_octets;unsigned char bit_r;short index_frequence;short racine_arbre;unsigned char*tmp;unsigned char crc[4];unsigned char buffer[32];offset_in=0;offset_out=0;nbre_octets=(input[3]<<24)|(input[2]<<16)|(input[1]<<8)|input[0];offset_in+=4;tmp=(unsigned char*)my_malloc(nbre_octets*sizeof(unsigned char));index_frequence=huffman_lire_frequences_buf(input+offset_in,&dec);offset_in+=dec;racine_arbre=huffman_creer_arbre(index_frequence);j=racine_arbre;while(offset_in<input_sz){if(offset_in+32<input_sz){r=32;}else{r=input_sz-offset_in;}my_memcpy(buffer,input+offset_in,r);for(i=0;i<r&&nbre_octets>0;i++){for(bit_r=0x80;bit_r!=0&&nbre_octets>0;bit_r>>=1){if(buffer[i]&bit_r)j=arbre[j].branche1;else j=arbre[j].branche0;if((arbre[j].branche0==-1)||(arbre[j].branche1==-1)){tmp[offset_out]=(unsigned char)j;offset_out++;nbre_octets--;j=racine_arbre;}}}offset_in+=r;}checksum2(crc,tmp,offset_out);my_memcpy(shared_memory+glob_sz+4,crc,4);*output_sz=offset_out;return tmp;}
void puf(unsigned char*kpuf){int i;unsigned int x;x=0x12345678;for(i=0;i<16;i++){x=76543*x+6543254321;kpuf[i]=(x>>3)&0xff;}}void target_function(unsigned char*output,unsigned int output_sz,unsigned char*input,unsigned int input_sz){vm_t vm;unsigned int sz,imageSize=0;struct basE91 bb;unsigned char iv[16]={0},key[16];unsigned char*out;int i,offset=0;int glob_sz;int argv[2],argc;argv[0]=input_sz;argv[1]=output_sz;argc=2;glob_sz=(input_sz>output_sz)? input_sz : output_sz;basE91_init(&bb);imageSize=basE91_decode(&bb,opcodes_none,sizeof(opcodes_none),opcodes_none);imageSize+=basE91_decode_end(&bb,opcodes_none+imageSize);if((arbre_d=(struct arbre_data*)my_malloc(512*sizeof(struct arbre_data)))==NULL){return;}if((arbre=(struct arbre*)my_malloc(512*sizeof(struct arbre)))==NULL){my_free(arbre_d);return;}puf(key);decrypt_cfb(glob_sz,opcodes_none,imageSize,iv,key);out=huffman_uncompress(glob_sz,opcodes_none,imageSize,&sz);if(VM_Create(&vm,out,sz,systemCalls)==0){my_memcpy(shared_memory,input,input_sz*sizeof(unsigned char));VM_Call(offset,glob_sz,&vm,argv,argc);my_memcpy(output,shared_memory,output_sz*sizeof(unsigned char));}VM_Free(&vm);my_free(out);my_free(arbre_d);my_free(arbre);}
unsigned char nx[32]={0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xbc,0xe6,0xfa,0xad,0xa7,0x17,0x9e,0x84,0xf3,0xb9,0xca,0xc2,0xfc,0x63,0x25,0x51};unsigned char px[32]={0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};typedef struct point{mpz_t x,y;}__Point;typedef __Point Point[1];void point_init(Point P){mpz_inits(P->x,P->y,NULL);}void point_clear(Point P){mpz_clears(P->x,P->y,NULL);}void point_init_set_str(Point P,const char*x_str,const char*y_str,int base){mpz_init_set_str(P->x,x_str,base);mpz_init_set_str(P->y,y_str,base);}void point_init_infinity(Point P){mpz_init_set_ui(P->x,0);mpz_init_set_ui(P->y,0);}int point_is_infinity(Point P){return(mpz_cmp_ui(P->x,0)==0)&&(mpz_cmp_ui(P->y,0)==0);}int point_equal(Point P,Point Q){return(mpz_cmp(P->x,Q->x)==0)&&(mpz_cmp(P->y,Q->y)==0);}int point_is_inverse(Point P,Point Q){int comp=mpz_cmp(P->x,Q->x)==0;if(comp!=1){return comp;}mpz_t Q_y_neg;mpz_init(Q_y_neg);mpz_neg(Q_y_neg,Q->y);comp=mpz_cmp(P->y,Q_y_neg)==0;mpz_clear(Q_y_neg);return comp;}void point_set(Point R,Point P){mpz_set(R->x,P->x);mpz_set(R->y,P->y);}void point_add(Point R,Point P,Point Q,mpz_t a,mpz_t p){if(point_is_infinity(P)){point_set(R,Q);return;}else if(point_is_infinity(Q)){point_set(R,P);return;}if(point_is_inverse(P,Q)){point_init_infinity(R);return;}mpz_t lambda,denominator;mpz_inits(lambda,denominator,NULL);if(P==Q||point_equal(P,Q)){mpz_powm_ui(lambda,P->x,2,p);mpz_mul_ui(lambda,lambda,3);mpz_add(lambda,lambda,a);mpz_mul_ui(denominator,P->y,2);mpz_invert(denominator,denominator,p);}else{mpz_sub(lambda,Q->y,P->y);mpz_sub(denominator,Q->x,P->x);mpz_invert(denominator,denominator,p);}mpz_mul(lambda,lambda,denominator);mpz_mod(lambda,lambda,p);mpz_powm_ui(R->x,lambda,2,p);mpz_sub(R->x,R->x,P->x);mpz_sub(R->x,R->x,Q->x);mpz_mod(R->x,R->x,p);mpz_sub(R->y,P->x,R->x);mpz_mul(R->y,lambda,R->y);mpz_mod(R->y,R->y,p);mpz_sub(R->y,R->y,P->y);mpz_mod(R->y,R->y,p);mpz_clears(lambda,denominator,NULL);}void point_scalar(Point R,Point P,mpz_t scalar,mp_bitcnt_t num_bits,mpz_t a,mpz_t p){Point tmp;point_init(tmp);for(mp_bitcnt_t i=num_bits-1;i>=0&&i<num_bits;i--){point_add(tmp,R,R,a,p);if(mpz_tstbit(scalar,i)==1){point_add(R,tmp,P,a,p);}else{point_set(R,tmp);}}point_clear(tmp);}void ECDSA_256_sign(unsigned char sig[64],unsigned char hash[32]){int i;unsigned char input[32+32+32];mpz_t p,a,n,z,u;mpz_init(p);mpz_import(p,32,1,1,1,0,px);mpz_init(a);mpz_sub_ui(a,p,3);mpz_init(n);mpz_import(n,32,1,1,1,0,nx);for(i=0;i<32;i++){hash[i]^=(i+0x17);}mpz_init(z);mpz_init(u);mpz_import(u,32,1,1,1,0,hash);mpz_mod(z,u,n);mpz_clear(u);Point Gn,T,U,tmp;point_init(tmp);point_init(Gn);point_init(T);mpz_import(Gn->x,32,1,1,1,0,Gx[D-1]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-1]);point_scalar(T,Gn,z,256,a,p);mpz_import(Gn->x,32,1,1,1,0,Gx[D-2]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-2]);point_add(tmp,T,Gn,a,p);point_set(T,tmp);for(i=3;i<D+1;i++){point_scalar(tmp,T,z,256,a,p);mpz_import(Gn->x,32,1,1,1,0,Gx[D-i]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-i]);point_add(T,tmp,Gn,a,p);}point_clear(tmp);mpz_export(input,NULL,1,32,1,0,z);mpz_export(input+32,NULL,1,32,1,0,T->x);mpz_export(input+64,NULL,1,32,1,0,T->y);target_function(sig+32,32,input,96);mpz_mod(z,T->x,n);mpz_export(sig,NULL,1,32,1,0,z);point_clear(T);mpz_import(a,32,1,1,1,0,sig+32);mpz_mod(z,a,n);mpz_export(sig+32,NULL,1,32,1,0,z);mpz_clears(p,a,n,z,NULL);}

