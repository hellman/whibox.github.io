#include <gmp.h>
unsigned char opcodes_none[] = 
"Ggoic*(M9Ye6^&Xb5>8pW!gLzh*c~2~K@DbVVu(o|f%bB^sH)#~_%o%GScoh,pYOMQG1J{JY$[L$"
"l(pTfuQNHS/VG)%ZN6yW>e&0`_^9hK7Jta.&/1,muymVwhKZaUqU,HNYnqv.pk/ggY.5uuz|&J_!"
"#L$THzZ*<Nd{8z#7flzhSL?9z)4WXEM>y/Wmd,=]ZkjsL7h?Om[OI]ei7~hGBPymj%gGF}igE+m0"
":qMy`_{X|I.ONhEoG.7?MPw(?;8/[j@8cs1*vVYW0] N,XHQ$t(Qd%ms|r%x>}v 9?YY>u5N!Hks"
"55Q{Zs8a&E4j[S5ooLRgC^xd57PBFKHFA+/[UV(K28V2,0QZCqG.>5_<q*Z`Y9X5?~yI=zH0`Vir"
"^)Tc#J]BISZt@NJBcn0 hFWCSI[16cS[[<=@pvtT/5[*OIEK*NbIem9YGK.4NP*!*sj:QT&q+JNS"
"T?Y3G+lj4m0F.@r%7Z3d]KkjH%DETQjVHBN_Cmar:dB:uZ7!eeB#nhj*;m6DFLXfe 7~Tn_+Xyp9"
"A}q[_P;^u~r.hxJcy_AWy;^EFR>X>S36b0LoZj3w(!j#lkc;xK^,Og!0`0i0ZR_vA%v{06+y}C9i"
"bb>?5Q;<k&to[F(S`U/*[K0b%Br4]BXX ( ^ODe21]ebq:n.s<p/8e!D[]n1@}rQC>Ui8uM,mI<S"
"al0g:wJWTsa;gO)IR9{hB|+uRFQ`?}tVWr41I@].WQ,N0(H<xh`]~GTL,J~^i$Y:5F{&b=sNXC5<"
"q{83$uR3]+C8|B9$5Hq)UiGv!Vs),rE}E37PZ cK9IQJWo#LvkvwL#6C2XV1]whM0CA3AH:?wR0y"
"E}[5P|oT2IoDB}lYZNJp@=Q!6N&G+O>keMKo|gf@Pm#M?K@p(;2q*L^{t==+h(l8R%$VpikR11<g"
"d96q6hoPj[=]mI>KK&^Xjt+Pb56Q`p6#]2/_gOU]K%Xistrqbb!mK26Ci26X&RgM6_fs~3U#D]ZB"
"s@#.7.nwBm>!q~gmHQYm_5?|E|9)1a]4*uK/,evY;YQQ@?J5K?=6;W~?_J(01W~eH{:ZE2?#bCtW"
"Of>rDH 2II19,$/2jWEJ24Uo0io%f&U3x<au)H`}PAR(oE[Kdc^.qhn;Y{n8[H?CB?6o3ZaWm#$B"
"^ngJ0I|JN|4/S3wX=KGks)<yvRRY597nR8z]z6#U4+188fbCrJ),4o(,&6VHy+}7 s3Hm2j=KQn2"
"HS5JAOCFBGVR[Ca_]daooH#aC[J(`Xo?N>)}xw5S?lV}FXt@R#_ED1 wO&,%LwMAZxGkr_IvZWJz"
"BX=1wKHC5okLzb4GSa9WOA]T{D6C%WW#Z.eErm28:y%h/{^siTcr9Pt{~Ct%wyzB?f TC/izsOBB"
"@zE|.n4&A`WM!sIcLzvWYF09/y.W%sRzndc`|%rL@pkEI+Kd|I.zF`z%&vV MGKCps?ljmLB:U%R"
">R Xg4PjB9%[DIV{xhvW:Bu5+_D/1qaJOsj4}/7BCgq+t921c;uD{x?qG.[{;|bv3YuMDX57<e;V"
"N,jVtgx=O!~m$ (H=P:OA+@nwH(r{oCUzM{orYjszDW(c@n7?m{;r%]TvOZcTw4>h>{#przw#)hy"
"Haf%~|sZDDuc<|qo<bGU2 :SD[$%Xi>A6)Xk{=8uT#Ul/N._[=98vntM`N:CTRn4,r/U#L6ppg.e"
" }Ey;|@guv>llv>I=Jtu#w$UUr(U%D<Uvf}C^RzLiwZ!9:#B~8eJ1|}y#tl9x#0ns2D8l&}+mqIg"
":G)A+F[<PbPt)$9V[Q3[Yq#Yo<uw1p#LW!NC.^W;!u#p8D+i`)tytQGYmDy&F(s1b+ju5;>._2Mi"
"W_+hM@qnit$Wrn&BAOcs90%syga$2@9$UI3uNF7RufY_N]A$2v5<HU%z|m%USD%mTV^nroYRe@;P"
"Q8o3SjA)Kr*qA`>PXh)so<D9&KHkKuOq4<s]^8Sop* A4Sm2Mc>R.op7MJ/S;y1F.mp_@6F6`9bK"
"A?draLv]wFlHEoK8/&Y?JL3V5J8prvTrQ4cqoWrXW^=`<CqFkU!>,XDX8:ch/TG:Mf%h>!e+}):V"
">kW%j#~OTnrVq^hFD10aS`Yg(Hcl.ILAwgmr{U1EddbuOo&HdKgu~Y+U!DahS{d_|ul==C.H]>[i"
"^:3w<fah3{*)>fKVj?kB/px.%l)q$JBEBe&y$.ARvZoy?hdtNx/n6rw]fZ7H?4*sK{kGI+.&no#p"
"B2p=3#9m`}3!Yrx/68YKkwszAdSQ[q#$TjOev))/)~$C,4V6SywGow/4,Y>xVes2:`CJIsn_%e^{"
"!_?TgS/6qCjm14@Big,i#>O:hQD/VYClJ*bt*:rj]U;g^a2cETi4b#)%I8yoX^x;_D%t,&Gc?%!2"
"O9DaZv`4?4x!};@Z}fj#<ZSk]EmPwj]Cj.1yWLN7nmd{nKEign BP|p_Hq=RkwDjb%(9%}8thME2"
"PJk`6m<YuMiyvDSond*OgjE3pP:`1xlXoeSro=f;Jwh|z 8lzuvqKLHyu:[F}w$y^Z&L2`(51&y,"
">Vq>NbiwHT8#{bS:_JaTb~p9P^eaIe?Wjl2:,CW%+@`sXzj|ZHSK/7`?.RnSItr ^h[/6G?^3B0i"
"d**TBEp~^CPuQyH5hJRy2vV]eRVG%F!%|FD&nFC}k~Cndoj5+N]SlN<n<j8Np@,dc3umm59P+,o4"
"I},oZ2bp?T.10T)!C%.&du|<)XQ2Yt.1)M<$cDCbwLQZzcm !D/r+ib:49.W?~cK9h6*]&xnVv,]"
"a0&:{UzYm?6jn5zi|@C(Lm$XaWY^Q8%.mwE2u@FAN}j83#Tj:e#+&m,3uMAOk,XmssSiop$tD;rG"
"uI6xR)`_`DBqmrKo%|cVCMRQ;/au|9SU&f/<RzYej_C0<bXEk1kX,Kdhh,GG6lQVcq;pkFO)3O(Z"
"DLovx`ES~L+!iL=0nEf8H)Q(swYHgSs%uL}Q9c5Cc0_$wr_5y6n?0]b(I]~j^XnpTg*|Ul!gz^z`"
",klxd.<Bckxp:Fh]h]jhliNXgtiP!Gdj;#<duUdgQ!*{Ft;d|t&w*d@tYKpg:1JLS@+ev%LN2KDd"
"FTQ+NK<<2,Pk#[1Pa<;L<Z;;DvkR>;6nVkw/v9artWYMcUpI1w[.])U7<v^%f^_D!GG}*tD@v)kB"
"0lek,Es1 eCXiL=NhY)N8%)[Zsoq3m^rsV;V<871bd8!2?]^15[s~#bG_6J *A2e6paBSF4q}}|*"
"jzNh>2ED26[KJi( N)K>phDoj9&T5.)=nVq)3LJu6&,wy}78ZU?#Uz.F>HgLk1B2y>]Z5/mE/xvw"
"cGX}jQuVr@,Ym~b]@`?ISZyp] >k`BaEAwH>/xpPr%uh{~MQJ0AlrG8+vC/:UbD**T8{bITJcN;e"
"_!aSX{U!pzC^0eYwv(v Egyj*9]uUep3fm<XHEP}J3thZcj~a[J8x1C/jtxTV[,(`RXk,LAB+r8C"
"(EWI8X#5do}V`f~.avO+|kaH)*Ps[Mq)D77;.{uSNz|PjAU#IJ)^G/AP3$RQ4$:8_#i@].38,Qm~"
"$U<dXy~+UZ3d*Ui]d*Ek}DowY4OR4oU_!=vs=W3)w*LbWZkk*R_aVX)oYwN8ds/{6xKF:+:Oa[kD"
"XV|L25Y53p=G:|9hn+a! {MLEKIiUDimO<#5ltNIQI}FBun+l6rJtr}L[|TuLdU<3,jPf&$+!]v>"
"2pR|36kK2<jellLnTKxXIaNcT.h3j_MBQelkq3&$w`NwYx=Ry7GdTT$+q#xi|3P&P]Z8FDn%fY]N"
"4kktG~Z9MDhS{41`*Bxx r_Lp8rdDCoOz].KejfCipW#67(35OvdqD!<0s`[S*e)ldheOTnJ^?ee"
"1{2[kX/c>Y#;AT>Mh9+Fd+<E[Ef5MR?z@.u3gLra] 5oHl{hzdIV.qQx@86k[)Oihyrqy`li0X[u"
"O9J{,/Z3Z&LgrQb!jSM%1JOO:J#}W2qI9qqR}&kI=MwZ@bwyjZ)r?_&*brii)t/=W6$@]]C#oT_#"
"YK#opo{xpdqQ~PyUP)8sU$hM$PzLVYpRvoMs}H1/Oj9kmLy+o{a4g^F|3uQ$aw|(Wx],xwfv`r(I"
"G~,{zZ:sDt.7YJHF~yE/PQ_4R/m@0csqs1AR6uVj}K,GM*0?p1e(at`EVrrz7^d_FAXl4|H!JwY`"
"ylI>yo7vbM8YAlirkPIB|zqcqz]djZQ:s>VIr?h]);MaV0w!g5Dr/*$,*V+ByP/DA$eJ0W^~[ku)"
"sj!|`>]u_8$mP^cwp[dc)ZK;]Hs1G,&qW4jMhp6*K|#&&Sv#tu22[hH!.WbR)MbL=nsBXLwhnMvT"
"2Uppk+r?Xgr`oHjdu]kw{3?H|hgO<UC0Q^PMPcGuNhftm!AR^mB07(F<sVX|~tsU<7v+lsT>b&PS"
"~O`jox^IY!x4_T{#]w6&_^nm*Vo>+ZHvA;fJ:T>3UJzD<cl.hU=FZ50Wj$81sW)<RDND]`|@%7&_"
"6 <w!z~]*M|>_`Ae4dw$0@qt1ey31$h<VWe;?lGE+;()694p8)7&yRyayipU)&2cAK#=CPvU_yz/"
"~]jwSQMge~cz=~}w^ECHK:aOd9U>+zA~i[sP4>*HBRLY~_D}K2&w[D=ut&#F|H6H2QUp`z1&&1*)"
";_aywRvzt4v1iI/Dp*,0w*c(v08#@k`GX&=yOcU<7:)gmKM%r8&)y{,X]&[[1:Zn2}(X$:L#`@Tp"
"yR+5tj{F)m<}t z~/u3DBz]H]eX.;? ?>TL+]0[>+})|UisY0ypY_CW}sUi7+QK5_45.).i.6SQ)"
"3(COB|fk7T:]1,w(n%taF#S,{!/R4)g,OQ]x`z:;}Vc4oQQ&`Sf`#W Rv2Rmo1r~bR6}ECrk2D{Z"
"vO+b9uom.dfk^Boi$Z*w69Y*WK?:yn?c37FHyFYGU2f<p?e8 tc_2y^nY#*5Cgk1qO<?R714]`a;"
"TZDhPC?wiCwzo,KMM[F]iq?f+p0B1I0l4Sf[(! Mko&I_=~7xL$&NM7_W{Q04,aXv>M?MJ`hg]b;"
"zgS;SJw=W9%(_fFOd:}`<YaZFn?|:DtrHL$Q{;Fzh/+M::37Mq!jRV(^vl4@anqWVWioY#qszQbF"
"9t, P[V(=GI8IZm3jC22unM}dg(BFcjSvZ~<yxIT|P%([?fVq0dFWaB~IB0roR4z$,sWaS?F/?6("
"Svdl[)?(ZWgNVEFRVhqi.ul]=(3N.{AJ=u:Fr=J_2peDmPrJ&0dE!qh0e?<i)?:F(b3;(S,`^o%3"
"<1,8C,muD,?_*RO15Fe~S^3EPYC}`MtvFb!>x4FPYTojWY,e= 9MSd0):Vt/0G!Z_u8i@kBk gec"
"h@6Eh`I*60)x,%N1f)Au?H1W{5@Cn<oG;%EhbFFc!T]Ca9FD$.bEK+XC+z{Zz6Gd_)Ru5Y5adF60"
"(Du3h3b1Dd(4m1}Ttc1dM=.QK:KQ8V%yW_(D5PIK4+3Z(;a@< C9gCQK{9C1F}BFa$+LX2~KKPf!"
"P,< 5q7@7d|Wq0ZT=ltVa>J,|9mK.gU@Iq!I!.p`Z9mQA::7CiMQ>8*EN&SuY0fj&GXJ#L~+Iv6B"
"*Z)5B(?p)%ZLT0HYHeF_>:/`&1pHu,Kh7JxN=tD),< s=p[+{NI6}sl/7h*`*R<ZaCC>~SnC+[@y"
"#*x]R.n&:F:Ebvl@eyu@]31{u@R:H8.GKg Cp{H(Tj08n8uF+&Odt6osQfkSF;Zz,sYD,Lo|A%F<"
"H~&uD>=Tb5r{`Ta2)}kx)tIQsqRpO>fp9[CIlXp{fsSv`5,__$s,Nr(?~M 1IDt7?:gXvXu:<|rY"
"$>!5{/nE(/86( y:6&,Av,G)0>)`Pp8wD.C}Tm|^pcwLC2q|WuT+4~!tyP1*MAiM,*ZaOCMSA8>#"
"fG`?Kduu/7GtD5_LoKEV{,`?^^3FrH+dT2Qwb*+@X[#F|iDghi@%c1<NMI,KQCa}M}hB=%ewvc@)"
"g8;Q4n2sRUp,HvA;nNAV3zyG(@]=;<ISa)mc9tQaQ?t|Mj<vPBN|:Y`^kx}+bRWy9F)|H2R2vgO}"
"%b,=RN~K>NEZcYc6=l3;ekx6p~uQ[hO.:$tn)&8*3>`@K);R/#tCL!?4]@0ZRM2+)f!g1RpyEcc1"
"pa ye!}.}|a8L9Lq+(ZVxM.^?#a%>%h9xLZ`wQ+3eUF<0(?Q)ZYZbN3pVU6S_LZxWSBb7`[ke(dq"
"_*[<y76;k(=H/Mfi1`CD3JvgnFB7/hSP?bYYczU3d (9!89FF]vMi]2e?Yf:f; zF(nCm{/$Ar[>"
"(]O#SUPM0rTRtgkPSs4/$&MV0ECYmR<#kh<%O7z~bcwf|l<13HY_#Z/Zcb/W a/&Y7!=7|}5%Ngd"
"sq V7)tcRtUSx|(z64H9j)8E5Ol,^R^zl>`Y{No$x~mN= j2%MYo3DcLY,s8><_j9b8Pkhfg0vBQ"
"a,]{Z7)[0STnD{=}$lgvwbnrp1V,]`002:QV2n[nL`6;7@AJ>[lPN53*>Kuaes}YDcj!JQ1?@3&k"
"7_e,aL!9MDYHMew:YKL0C_Y0BrGkgm*95nES}di>NQr;d<^l:#}XGm#m 6VXeYT[+eT{s[_>F({?"
"X=p;).myUGroa4zxFhCgvCd(;($Kj`e=.`@kTxQZuK&Xq2x!9FeWWt=gBz:B*$qF]Z%oj#_J.Af?"
"2pV/%emDg#z,?&.,EieGW_8mE*fQ8>r5Z]I@lC//C6qzz1&L4|5(5B~9Q?I]r?;H2mLcBWj)O|Nn"
"OoE.]N+2|yc{{yZ<]jJP$[WRY0Oy$N;G4WgPh/3_ay}$xkXsnoPlIM,?Zh#WpP*y7m31qoOd([uZ"
">?qs=Ht63;ISe#LGvoJ|F3,}gnj!f0aM}NW~)vfLK=O_?2V_9vBJEl1jFsx4n@:WX=q.kYa4x&}F"
"kTS<>7snK#k=ikj*_2lJ]h({vjfF?wy|tFCb8tKGhP#tq~~;F9tF3^Ns?H<RW5UDUs;bYv3.HWZ4"
"7.H;M^KvUSgq{5a(oJmR@OkX+&ew?m(wuA &KMr@8f^3%V&aj`W=LKbZU/@b&M[G}9U{D.+BG;@r"
"u*~hX(!tF&=3TH,tr=A_Z8eZM/+jDwSn|,<)szc?w:M!x@*~{T5Iy/ws0+lF%pYh^bmy$#+JKRxt"
"#=57WI$4#SV$tL`mtt+G|SVd>B`OiFiOF<^Xw_w$0WPTbZt47[0px^})h4FV[|hh2mddeLdQMO|T"
"^}=uJ~Zwziqdg^NjohsQie uqH7VkvB?jp/Iv~birIAS?%?P2O_0*:oE.FpW?SuT{vv~A.WH@`|,"
"FV?8fFsfi)ULgv2ex~(k=HK2#PGRmrnGj_6!vx_zB| o0~x/^]IkZM0Ko0[Y&JDrV@#EPI0ysrWF"
"l#3p57XGfl(=}=XL)jKs]:qL7U{*WwR01m@;1?Sn.kI~Xar]0c6H^P~nRy+/l6{}atl!|GbqW.eW"
"P/).VBvwSx0)[Gwf%U:}Yy.dPRNy%Q[UJPgg+VI0O7^^|*{&)McF?.LUDn$e|`EvsvPJn7*[.r9}"
".VieFB1_w!Fkn6EV_/g[en@X?24@[c^+NkJq_Rc&n.mRHd&uDUXP?D|yF`tHJRBY;D*$t)9Zj43t"
"]O0M]FlH7mTeF0q|S+!]q@9UT_]ymNeNzxJEe?<pqev(hh{mYTy(2@Bb[r++[9~)^%7;rni!^t;X"
"W7U]Y?B_r2 i_ZzLp261!Gq*&v}pDcCX=mwCMw7FJle99h69%wwy53.Y9K|a$k6MfVr<O^Q|jYMu"
"Ry_2rvvu8K`#7a*hfvIM@&hjRzT(:=G}j,NmOZcLn=sBRr]BRmVk]J/:4^F7bSu^L<t3pDtS[4xi"
"@_`3R2bz&!j|uL07N6~cP>H3mDJv:iF:|]IBv/faGveb6]CtgYIl|H//,+G]C;y1K>@2 c)C!8Cg"
"5nSu2eUe @67WK3aYw,$B/)A]9L3ot8LS04?(p]]?hEt55zDwoj(B//`$z<,HJ!Wzq3NrmeBT*}$"
"I,L<ICmS(q%7;pFR3^m(SE8pD<}:yp~qBp!sE6ytLQ+9P^7o $dd%_GV5s}4oj1<E^E k>@OX?O*"
"nw15E ,@DRQ7G]qB:7f$@6snPcKpsvteZD*KS5^D&I{OLK*hszF8SSdHJ1=H[R99M]ay9w62td8h"
"<DMY0WVqoURb2NiaiVR2:57kE8,BJ5Wnbi<5St*jvnP20r.!Wu(&55fJQYit.IT<5Eg),Um~XJN{"
"R2qq}Dief8m.u1ue^Pj0nc=K3#5Xe#Ate?HM0;&^ZWV4Q1:<A 0Nxz!@`q a?11Hay7V28a#RWaS"
"ikRwvO5Rx**[>(F20]c&#^Xmi7Xw5?#u;{#w]YOpw}xQ&%|aGw`3T{<Q=iDBy^q)E7,Z7bx]$l7["
"FK6WB9{85C}z;Ot9xB%l/h`O7qfmz3t%}i=MmUK}h~}8HyQtp/>8I7<2I;iU+?c;Gmb4|`;/H$y8"
"|UZCP{bz7@H;fAi~a(#%|&*%Nb#:*0vT+ES!vm~XF:qdO/ue .XqZoAFHh!.Q0vi>fE(:bwT x^?"
"QKU`>k)#Pm<OI3GX8SbJ}c2gGX>]!rVYU[5G{gaD!ty<0!_&%,3jGf(&<Sf*dQ0da~GLx#=3QIw)"
"%D(0`$:O~A RIT!UFH(!w=ajyj]Ff:gS+ey6j.~tXM1;!,mv#nkc*ts@rro^tML&IWArcav!CvaY"
"Y.O)pz0N#Fu[xF?kU3;Ri{CGIy&0yJ;{bm]D*n@3&6JR7fk!+`.qdTc(%aWN_7?gOHY$jHlQ&f[O"
"oWAS3Ip;#Hfv_X7wOV_)P;/hq2)D1n@hNb*Ck>;AT@4nECuN?^{%syNtlZ9GP^+Xd<*zA#Y#v|m+"
"zlV46].: |=n|~zO_.FL{]%FB)vK]cq&c=_|M/qbr]ap{|sL*@h=+P,Oqn_bCiI`W.JY=$gz9<hE"
"EEo/R!4VDVJdGXN{,oO1+9 K}lQ8u]Jw B%t&|jC>1RzZ7 _gGO#s*<]_R>R>lSd~OCD))nEs)uH"
"KG=kGN>d+h;uLz9U,vq`8NIF6EG`/.6x|wZ5z>faj#^!e*C05vXh=h&JOa eyzz!aH[zSSA.@fy0"
"(mMlK2n9AOXEH!%NB8s5[3}^q>kSxv|Up:|3aM,.Mh. 6O1RIP;R WUnfe/[O#[GD+@w*Bq0p9Nz"
"T#jE{[8J5(1U7*k^n%Z9qiChZ?gh>F5c$H); jzVr*WB<~3,;j[[7e[D2^:9#Q/~A1ziE@|Z8+{l"
"h5Y_6ZV%<{D]MlaqPCxL]*{#RC1)StKsD)QxM*6#k0|&@Nwgw|L7, A*+zpO,!$,f9y9A&ZRa*4B"
"P9?MW]`Y?ciu14%MNmWK^)X|&wO6,iPLva}_t7<ofQjBlR2Udd+O8mW73}u}rGC^TZG>4n${n%)d"
"v(]lglKOymEnk5PRYsI^?EC2*7{2I(()$7.ah7Y1T1|@lTaZsN8M@bc~.]^:Hg^,Zuk`^rZN:O$Y"
"4oKcpa8opk3wE6)8E&m?#9G[ydYSW!q?+)LvfHEW2M%PefT_mY>=tsjbq==`=!@H*:,][#mA715y"
"#W`wAkaRtM+#Bvxt^:drTn.][oyr#%]Wr?`juQhX{91;XJ(HQ< $v0NP66+H[1HE10x,BhR,yR0C"
"B^{_qhx(xLd5ngbb[;P|5r?Hax_{/85a<K:~{wdk]o|pmKahoXl;D(i|<sgV0;a84X8a`HlT(]Q."
"*h&y%#6*2>pi)b_1A&waLlNg&X/BaK!m^@=$UrvT026~B^FRbd]uYdZRpr>L6vg<}2Zo]4@aH(~M"
"*|YNQGh9q,Q7uW/o..p0O16w930D|5.y10L{m|O{x,Q<Ic~K*pJW$br[<~M3l(^t]DGo|KtOKt`0"
"?Xh2q{Ultf@R1F t;#x+(S46G+ft)%o]=&nGILH$LJibh9NcDWAF<|wzD_lEAVxoikh*y9v5~8Ro"
"4]Q(k)dj$z?/m3@Fw{0tET01GSj|o@=FK`EX7aIRdk;6N!{.W${1B/g7QNsq|*V1v=7/kN*`eF#B"
"%%2F*%4:.h8MD@uBi&_]A8aCL/4]5%&O<djcq!aQm1Q.x=i,wTs!wuTA<x3(qKeJwqlQ#WzZ:D?G"
"4CKUioHqimg|$6b^^%US{vY#xqE5#5D^j}gZ!mIy]9iH|A .e<6t1`:6oVpJnlzpFvGay.(x.)kc"
"KR3VmoLs]0n3qKb`L:e$Qfa^<JLLXguQtq35+KXtU[W6N$>d.t_/+ImO*~zT<u`F:4QI+:X]AmTS"
" cid#p:7aDn/PFN!r#X1ZOUBmCGfRMCF?1V$AyviL^F|O[_p#Tk)2J9z[/,#m4] ]Y*6$2;eLyrn"
" vt5RUyk:{ZG&OD< ^KcGlZ`2Rj{{OKX2U5J^aurRDkbiqA^V`DnJyT:7`azpGD4XPs7+8;@;hdS"
"(8YbpVE%sC$B4kj~$]44&$J(bYvxj||ME<(;$Yk0SK.%|kx_{u0>g`F<,)ah%^Vv}K*B3p4Lcygr"
"WF vNYF*<9xXg]Da<RXyv:a%cbPor<fe{c^ucnhMZ&)}e_*Ox8un&8qW!mJzn==4b2~evv9l|2vI"
"f >CP+AnydDh]dO7D8XeK)J9{7m0Ti.FCU0K`}Em3k9Y7+/m!M5[MyVV:g&nEzfg72{|[tjQ=/d}"
"bo?}n;G~* `OE_M+Lum$81.kE2:O~h(Jmr=&[ 7wVsT~$.B/`ep?|w{=S~S3O.yzX[t@hQFmL3N:"
"mVs+BW._8sM8mdTz(8jYxbbPy>Wk#%iZg?sr9o#}yH#DZuiS~vy.YW(_i<mc:CeM@q~y~1MkY+OQ"
"W<#Dd=|CKj]u:ip&MPN(Op*bjO8t]mhy8Cvu#@V0=vce?0]^wHj):;@X7+V/V9Fbrq[.L9Z%~yf."
"n5#GGfCc/p?P[V<h6fWp+.Cm_wk&hVrZcMR> IXaBslf{z^u&ntdo+U[4ZV&b.27(y/bnlCRDd2h"
"2mLn1s^x~L/IB}#Ig~Bp=^$<J?rOnB=5`9c!ZLee!ZiEorTk:<jKBA,>>u/FA40y*_75 >W 7/&*"
"tk@O^1i6bv3;d*`?w[&X>sOT%:YLz0q3%bK} e3|HM>yljHj|82@2*$*nYH?`J?V|#TzZMJywFW_"
"8~XxD6efcp%MPie0V:dYT/5W!y2H635=<!`}=;=%N{e1NI:EUJkbA=>BMLNP]9m_nX;Yj(liLY4h"
"W/j;uJGZFYpI&}rpV)jMq7;3q2AcCuT>5h5:42!Y8~K|&}+)jHKzCEi|]u_>uDNM!&wMVR~%]tFZ"
"o_+8oTV<jJoT^7C8Z2lKlsS79d?Ut+1:ZEkzD}3A]}!]3y&><i]r6h0LF*/5~lRg)V$%b}q@O(5X"
"  (8s+q<RSeom#?1njDV`g}.%$qga&Sig4Qe;j3hmsT0F7+J4lL?4ke6CtA/8Y:V@Dk0eaf8*2UQ"
",!eC_Ho:liLS 7!Yc[J^=jaJwClD3n_J^1+Z+,fG&)L$?q$!!$Y/imbeBF.h(pT~Ke12Ymten]s["
"&Ow1P/CBMOmvQvj@09OeJkjv:OmPjk/}B5E3L:$31m<j<.k?0bicRW otpANIgM|ipX7{CkWTmp]"
"u+DFj%n.b0y^L`@~D`@&y~8>%=nq^K$.1B%U3J;Qah@+$fou7}99~>j5;H.5]2gKuJ=Y0/Z+W&py"
"l0Eu@HZ7sB~}HUB%jViiWI~Gpvk:2;9(vEh%?2X?;0?D<l;9o,9Ow_d)f#H4hwsT@rWG=<<n}rb9"
"r:$1,ohh< Z;z9sI|0i62*RH3HuzFd<rbN~@n/F*D,1~CkZl1NDpsk[@n_urQ>2>Q#S%Mj&8 >MK"
"HA!3?3nG;([%MZQ~r>xeB{0}_@)1s5nmm3&alN9D*r_`*@!e1t.W+JN>wsYtM@tK=1x;_StqR+_."
"5T}i+>z@C)2r[u#j[PH=0di/1<G7)nck$m&kVrJRa|; YkWWo*@VBuf{i8()N& _4d]<gs_xfNiH"
"}I2BRD0OyKHW}$sKV|WMG}SmW9+N{J{F7Pd~vL9X_( w|<I3kNLf_21jPR[!Z#/u%?asM5d!w_HD"
"3ISXWs!uW~NTBk|&OBbU%R&JruCecr.w.QNz>+4)&OSg+]}ZhT$,!:>H|;p1[H!y 8RoC+(RPR%#"
"ed^ahc7_sjUWdxZ#X],mXc++`Rp}i==zAh 8(xI2NzYNU}D#HRq9{)(H>/V+x&PQ}j 3)cJ3[eX/"
">/8o #.z1!eRXg#}*r:}`kFYIe^(uW2b6s[1CM~rV%%2o/wGt+yA*M&xhC!u/MruW7Y+ylpV`ak{"
" 39E5u9r8a%JvsTwnBU?HcTr1(8_,W8fe`qt;k( bV_tbwPptI70j2]Dn?SrB|y{BZ1,JlaYCRVd"
"5@pJn8w2l03aiuPqnX`#mz,.pLbVS$.7JEMKp}e*31u ;%hTE6,8hE8Ll1B%O}DtsM6imyIHl;28"
"MD:*zU]}vWBzak#p~AdglKq+]kL,i,@qwj2TEH3)G`)&S&am#8:vCLeiKVTznBP@c)WK%v?g|2e#"
"J2BxLu]mHRiMHIZ;qM];Unp,@z|_[&6Z!C#9+3TiK33H#%S],9mO+K{r@J`)C<teZ#mAH e)0ql5"
"P`m[pvaqDn=|exIEuD[?WJ2&38NY;_TaW8NQc1(`v=!zyu|4&T2%.+hmdLn=AJ?c(VoFDw+=r?U+"
";B$,7>RkN2] OiR7*mWnW@:rqzn!#GZg1M.rKZ=t`k5l#Fbhn@W>e&|;SNZ763X%gHr?/TWpglZH"
"ax1k`]^ioqE?4r!=1h:$c^j^zC4S,I%,j,rcge~A%^$.3eV&+Y>kPy[9g*Xp;yxls><RtY|Ge|T5"
"[>_wtI`k8;Xw`UImYO>tz?Ktk~&Zii:*<u}:yKv)q}1@N_v<(2+ Sa17v#m1~$n&&YvsTY:B/QpZ"
"|y[}Z!iVkOdpg>S[hfek>Mv`W,a_#Z:GO,+6J+/Xm> qZwaF,0YUvVXz1Td>zF;o.H+.)01kF, ["
"S;Q+tb?A*dN=]]N*^2BJt)f.h4TOT+ltR3`Gr^d%;*Z>uArd~&WP:>;PGeOfnnpN|T@jt#I&ilD)"
" jxFLx4YL]ADHdCN3X5fru_8ts?@LNlkStYpT@L#Up~`.YnUqFVJq9b{,EU1?3.23dJFQS]uN3~~"
"O][K|>u(dwHXZ*j}@)w ?>7/+Dla3bM>?W4$dRJ/66ru.L |oN@z$M|fY7w2(6?8qpf#w3$H{$ve"
"TZ6XM;H_G0bPz^%+:I ]2>^:^CKQONU;8Ux>D@ZCz6^|!r#fr}h)q}=K}o;]bSkrzeZ3_obTL^<5"
"N@/,tKk<LmHV $YM|Z^D|pt3paDpob>([gYI3jF1X.el (,$N7^hCZ{a)(*q]YJq1xH&#GJ((.{H"
"gp6BMDS%g3y.]H2nBY#GB[cM]_N;5h{(:cysm7ln/!cU^P3oIzBO3@}(G%3St~(XZCouA0:1^_{ "
"MdW[2+wh&*jD@K]yyw7~lDc3O=S;8D8XoD(9.`OF?Im|0$iRg`9Deva)N|t45l2OY< {g?w/KnW$"
"r}[fiD&!U4~_yxSe#)X`LT6 ]/)B%_mE([pxY/zt;NQFh+H;OaE$z*(R02+hIk;spz4^mJB$#1~S"
"6uKWl;wT>*I,!i5,cJ<r!6|l50V}(Rro..DS73*aOuMXTDsCDBkVWpcJta+4dc [W.lKH6@OXsMI"
"wdS*|CIMI,/pm$eS*w31;??;l1O:b:l.Y&lqeH (td|3EVoo/UP[=#k}1OC|aVY1j[XX X4VS34!"
"#juaQyMVKJH,IOWHq.m+co)/B+VrDj&>AcGlU]+i9}/AMS_J~L5BZt]rVh3=OPO&mRslv,GbZO<1"
"z3@FF!`cB$5LBer5JbeI~]x&!<?,<M&X=]PX+=q0CTlUg%4H)duFticDhTN@^HB*%BzwHlw;rFN|"
"~$MWkqNh&9UgTdK#@@+vDB(0^6byj<2*#N6,U6*?)KWyhIH(<j:V{2Nm^1$cfdiD,2b.n2P>/ZV,"
"EmB591^h9>+jJBl29Fo/+`DA:lIdVZ| !gD/l8:3Q;gxeFf!QT|:RZ2,B8Q[}bULr[$|BAmzP1p4"
"0{|57&?_N!zv15Wk1h=dRKG*$<hBR4BB#nJEGs !Zr2)HI:DwU[&m[hGI5TVTeg,iF|O,=s>.9%v"
"%RpD]ut3%w(L(7^<Hm`K<?;YjZjeW[G/P,Y;&.<<>ZVQ9] G2N h PRBof(ws=g{P^^5]zcmS|=!"
"fz?&MznTJ?!$d!w4k+bBv&J/Cxz*[pMMidj y#_;Emy~78B()OT2ud3%dX1 6>^UzLomf])$!8#v"
"gaI[$*#5~]&SId@ 5d`oV]( lkr},a{v2]Fl0JiNRkI&0rPqV.?363B+c!NdzO_O>%=xZy<o.]qA"
"&.s]TS0!grJ5L9>0A[}X>&nU^~j8>v:a<_VTa>`wcIjw$>*8C@>70^.bcsZto]^E9d;Gg<7/!G(m"
"I*2f<(X5D(K6%!&9J }e+j)fRPR(c$CK+go|bP@zn+myWcb/ia:Qh,/ecZ#qtq`p3q|R%f#5]Q7."
",>p)qQqSq~)|OL2(hmJQtRSn2Zu2uMFsV4N?y_KGQ9Lxhy%ghl$4YyHOyZ;Xe*i^%)NuhOY.r7q="
"bD?3hFcmH0p_OiQh[B~.IN:_efbr/3w7>kM7K;IbXn58CCky&b_M,M&,/rFdQc{:d<l2NK*EJjWv"
"(_8k~8Ma[<>x%5>iAQIb.Ir~=UB|*Xdb!7gZRt$oVjBJ.r#7X.+oAd&18@}Bf19g;9,@ :@M+Um+"
"=3||RnO2=C&S=/0evMAD^23wtI9EWRE^I)&le1}*OP,[M:#lkb^y!fzoDkA}E.kt e,BEFDfx,}C"
"JQw.QPf@IW1PO8>j~%k`6BNL#^>K@NcZ~d~2HI5NMaHeLQw_42<$.wM@ltM@mB26AOHE6r(mqAUW"
"Wl&lAXBYomvMB]&QAcN)@x?x2@:I>~wrh<UY/3vE|;^$1RB_YdhY%Zb] fA*w2O4G6E3`$ZiX76i"
"xp;$?=bfsf/b!(aL_*,+Sg?Ufw)crlUFb/|~m{]:3Uo/ZuUEa^1sdI=#CSiZ:~x!Q0QZK*i7(c{r"
"PnneUqNfM&H+Es(xqwsDa~6S`V_mX]c)<W=/WFJg6f5KeBDsN{YP$r=no46F,8_xo&(>#@/#Ll/J"
"?;V2<!{jOZAbvWu(F1AY05cQXH`V2;~t7q3.7R}(|/q@rM}(ZDccBf{@@PE8p~pKR{:o3+ tR6[@"
"DG1K>%Z)BQ*XA#y(_`|T%eH5/+xLLJ*D2~!5>D4DBSUc*n cWW<KJOfQwYmkS4GbpK[cQZ~hP3+Z"
"bnAOz@| 4#aSe)KU!Xd1N/ft2Tc+`w`_*>:$jg xXF^1y9;<w4NxfLv@^y~X#S>5Ee5lJc!l~{NG"
"Ap7cY/vL))k*}<yAECQMU9Apg+AXg:>ymRE|:Ml5wI#M^}G~;5wy95in)pFgdU[Qv{nKMDQ6O`i|"
"MoLjnCc&Gq5b=V9%~NZ~Yp)P8l3g3/@*%/xplvFrEnz=&*_aOmQXG}$~|CdT4j,4k5)F=z:)ht# "
"zu?yX%$sQB<`xFXTh)i*=5kJ<YZ)P}ZsS23]41elm{BdJrk[SfA~}Q7`&g(4g$~hj:c%Q{DjSh_i"
"eTkG&N2QgrX|7^t8gbR}pGyd4~:k&~S(Iw=}*CTAT A_8L]VC5oMPRRqunVJ#%Rigcdxy~$Jj~b:"
"M!`.sU_*:V?Ra[,<jMEHi9xT%|0{l4w6*9CPkVNd^%mD^%Ptc%d4!*#Q_v.Q26`IGG{jsp>PdWj@"
"~8RK9?z58]GDc&{_VW+kk|}lj/<h9bS)3H%(46fHcXJD<]Ftb9o+$$nll41kzht=[9NiZp$R4]f*"
"?n0sRY1RDUx#DD !5`+64w)uLJag<([52hP`[{oN7m!##.JHo+:O}vH<DU_.3C%VUA!,Wnexv<`z"
"dd]_3Ha9n1yjymjlkl }EEM|r`*3ro6y5p?!M?LFeSeiQHv8t}%&?0o.88Gq.$b/w*O6NpZnw|pY"
"bDEVs]0)]FlffQ;ObF4g$@4$S!:QbYNbI8DH/FAu_K$`hnyh>;v;}uCwGrA?HQ=8d67hWgCOw+Wx"
"CE3I^8zE}[wUJ)*8rFXjv_%y^_95CzJs@6Oq9`vQrpM 5c9>ip|nfZ`pF(_D%QrGl;X+VU^2N^= "
"M,I8;!8%eXt8CmGWsu8T^`&vzVm,nB:3fmxln30!v.D*td#58xS?836A!xEbYUMNxMcbpkw_nW A"
"^~VT*]_)cPa?B=mffhD%Yf8,[Uh*jAB49rBPnOMqG `(Ndw|_}q&xVd&{m;_XB.n43%2q`jdm5dE"
")0VKx/AF>[]YyYzZ*y*x4`^C46cX!Kb,gD_vt0j]#t?!x#_w ,JmXy=Vc#*pX3Vgq0c|reQDg|P5"
"6]}%tfpFF!!Ks2x:NcXtnq*xsuo)ejhPJ{rQ];~/b}bupx Ha!X*9OJ.rUNLP|)$%@Y9=XG]3Zhs"
"uI=b4[>8m,iP~u8]ZL~M1j8,M?s!m?9wTJiGQ2U;taJdU0ZGV;pj/jC)K7fA7*p#>/>R8yUstQ.Y"
"|IW.n>JHt=zcgEGyvF}W>5Avv5?W^gV)b!*xkTuM&(=UD7^*a=Qn_Rs2%hvK4Xl:p2Y(e,bU}(PN"
"FdQD_Kdu2*S;0x/G9(a/lkp!]@e+X?HAE~PuA:N;y8&:F0;H8;JKNo/5L+*1pA{RrqDx*?mOV#}m"
"}ckMfc)>h5gu1*1yOxuB:1;%nEG)c**(3oCAJ@4vy/=csiDVX+!,((}HqGs@5KU{h`1h+XXf=w@v"
"mr,}Q+q7S7b^koCV~3^5W3w,1|L6kj&U,a@c9x`&}4>zO1rkvH(>Lmpvo{8,G+16[/96J%]<%1#t"
"a*9Q:(Yxf,2qY]FWfFs%@!y%4hl?vzC,A:gS@p*v1YjT&q51>j5=Q9[bh?jm63Tb5j>ar%6CE#b8"
"ff9Q2 ;{QOo,@l=?L+KtU_gNK{ hIbVe?856kdU8b{JIEwp{#0W=@*FeEl#ra[gPL8P3b{sc/w7 "
"KTgg]p?/7FO>pVzi`U~FG:wER!jb5;Mx_cveCdk<k$g] B2ugkVc6_f>(|`]NH{3<s>djEHOl8c9"
"k_^8I_wB(JD#@XbvexL)O9$Z5cx+[M<60gG=mNOaQs8YpM3KUX.4wy<t%E0p{2*Z/Ib4Rt{~su49"
"wfu[}cUa|EO D/L8#UZ3`O$v!=pR~Y0c2O&w~C9bAq0n^d1_vO?<GGNXHD1LmGQp&wbr3.n.+nCA"
"fC4:YZt`%C.b8xJF73@fa_mwz]bK20AwUpRdu)@Jw|Ff:5afEj]VE~k3oZr:mz@!2pE$RKxBW[ew"
"4z_#I|xiz)Z]2E#@ldCrTG^eB!~6%!fYwup&=Sz4i+$X|9x^GQa^pp`eFaUE)=F!JZ^qcsJ$O8=k"
"0ZrW44q/NjFDHn$*Os@^zY3=<1(fU_p]0 .JHYzsSS(yMI7!TI.`!TE:fr#I?iRh<Z_z@<,qR7lT"
"`Gbm`,HI%Xk8c p/ lS7}7*zjeYCQE/S[*:|l6jJ|@3~jTo1u#wQdNXG%k:RB=wQ;mo$HEX|<3O("
".y0L1p#PbZCjw=])0&`~h^e`!$)F:V@<oK`~t4Xq$df(3&XwENd){50iQawqJP g]cP.^i];9/>0"
"k+T$~yyMm/WzD3l q7NBb/;<9*%cQG5eEmWMsm`LT&$_pjVgPlGn+{WN h?#/(SQ2=jQf)jaTmnU"
"&aU7cJC1C<,itC@nM=1QJsk<B_mYtWFOm18fi583&q.XZYc5_!ZogBuac@D^J$tf?tx}F4yfRV@7"
"AVD^=TEwNT6sUPa/n~#!^f`Eq;b.x|8=Aliv)O_dIujt&<vF^{|c {&ZJ<PnusGK#BtiKrhuh<NO"
"f%[M1|kf4D@?cnq4a*W$|LQHeMVo]3@Ws}M)[z*SM2`DKqCw6>.}5X:Ck:g]{$*w8@~d?no*o/}W"
";;5Gj!MZ~UY%3ZevmL*gF4PuVZ=Oetb.`Q%S0[I2 lzIfes;H7e%V}{NsR*f:[CW<f*c}ReD}km4"
"y~QG9Ht5,!HzSy;~6_`6:DB@dn} =mQ:OY|9Sdl[<$Mx3}6Vj:.qh39!|8a@0~sxBj=v,$#T!YfR"
"%Xx&3M/`S>:_VJHIbiIpL& &dK`+8lzl^[j2^l^JzN#fPBxf]c5Z56PO?;]4w57W7>*8xUAbe}d&"
"gd0kBO:1v6y?C%%lu.u>:$&D .>_r;,im4[~2{yyJ+4BLcMzz$YIeh^nQqm~.>me`ne+VQ@tE@^M"
";`>7rWt/0.5WC{o=X32~2.vpSG/bAu</hETLRwzoB/dW+c_W|$WPeU]&~}qImZbWHw;PJ{lN|Pgq"
"r>Ck,ktuJn)8SB)bW :c@g!<:00iePXq55#91zi*%#5y**`JG+i|Y>d%cD}kui?/KHBm<e_ew2J,"
"^)r|hOt_RApD,WNf4VVsG2;jAP0UJ!:#xkk>+bfm%zS8{%d%<V+9~{E9)XH47AD~>FOFSUf[<5M$"
"R8MMZf8]HhYKc7#pYwz)VAX[ w6+mzSDq+R| wnbM8r{xvh?,[yqz4PT2O/5NWTz48mz;%>e4+_s"
"IO_{CyLdcl;i5wDxW)I7HaR@hc#@&%g2#CQOtGsnuD`z?`V=LJ5GY2MycYlbdI:Trv9#Z4gy}5]o"
"^4`dHnmdKpxixtRutz@/o&CWt,a,2]tIdVevEJ^;h^5MS(w{9^rV8o.c>au.%gy>fNY5&HQ/z~hw"
"o,tz,9T5O/Szxw*eC}$hJ}KS^]JW/_WR$)&]t4N7ME$8V6toDwzd.B~@JR|a`k?9ok&6T;aT{Sfv"
"2;B%7&z*xcU}qb|{qThb0$s7jGIB9qKacfIQ^E3({`ot*ef^:V`|3~5~c.9]$NDop$L,9Uei3`g#"
"ci,9J;HSah6SO#on~|7Zo%P1Uk;y{,ej4>JtsT{kSep/C1MwjIdFM$z5_r>j2CfI&p_=(cQ]j_q0"
"M^z=JzG9:${w&ekHbzBRKa$7^e,aK}{FyeuAglLP;s~kFs!@E+!YlrOXz>sz3XkyW;LsGcj__okc"
"c$P~gP2l.JP$;T%__u/QLcaStNlUD6xDZ@+3XKR=s|@Mi^RzH);`e$5/E7Sv$1L9[+bhXu#Ps:d="
"|7A$F,DHYdN@k9^E>h,3ppQkbA3p1ho1l}/Sptp0z%z5hPW&H4_~,Vl~`2gQMP(9Tn@dQaEt1ZE&"
"T8p,tc93gXQubgc0!]tLYB[dz8,fHjfQCEU47<U82|)f?5?Z>a1J6hS#%?%v!kZ&ji5H.m+CJ$3P"
"v+uzgfah_I8jWkNx*z?zfId9m25.U]LC~afD9vLX}eRN]6zgfiw9wR!Spk4M_&1pE,=+Tg$fu;eH"
"CZ+7,R5uS@y:A?cRV{4*PVR}l7U>o1@4R?|7YIm3%UN6$CjJhd(yY`|sTHEI][o[.):}&>W0oe*`"
"=4>B2oqD.SGa~<%Nc*OZ+k$QjcGq`*,&=s+V^dJhkNx,h)M/J;t$1DAy5/UaqzX@xO4&ZX[;byD!"
"o*a[xY6IITz)xiNnsS.Hc~09In$.qFsRIowyVa^_B+z!ZskN#C{<[MK16_&3{>>71VW/N{O:R2]("
"K!pC.;(la4<{OSF0ps_pn2:|~t3ZN#!yNz68a,fHLIOTXQVf5n5[@d&Y@e.thQS[uDD]v9B#Et.v"
"0cr(lRro`8tz/mF(f/(v6w#JsM,s`>yAite9$x%ZC3dim6M,_ fTk{)4Y3U}ZiXtE:Y{o]kP)W6I"
"Yb?gp^ 4uCqFxCLJy%72Zsj12|1)Zy<2j`$4?8_9Xq)J0(u4qCpah6<lVizH@T|!kFFG39JwBk9T"
"4<fU4]_z:wC;2lB7.S AUh9MtekLS]+sYd.WU=7?(y]Lb(Lh0Q{f$1@= 8lYoUuN,Jr(lZQMUA";

unsigned char internals[8] = {0xcb,0x1d,0xad,0xb7,0xde,0xb9,0xa5,0x35};

#define D 2


unsigned char Gx[D][32] =  {
  {0xf2,0x26,0xd7,0x22,0x29,0x6d,0x61,0xf0,0xf9,0x23,0xd2,0xc1,0xad,0xfe,0x89,0x25,
   0x1e,0xe5,0x88,0xc7,0x4d,0x7e,0xa7,0xda,0x99,0xc3,0xc3,0x61,0x1d,0x52,0x9a,0xd1},
  {0x5c,0xb6,0x63,0xb0,0x1e,0xef,0xe7,0xee,0x65,0x9e,0xef,0xfb,0x01,0xf6,0xf4,0x64,
   0x78,0x4a,0x08,0xa2,0x99,0xba,0xf3,0x18,0x5d,0x02,0xea,0x7b,0x94,0xed,0xab,0x22}
};

unsigned char Gy[D][32] =  {
  {0xad,0x6a,0xcf,0xbb,0x5a,0x8d,0x57,0x98,0x43,0xdc,0x20,0x30,0xfd,0xd8,0x4e,0x13,
   0x18,0x9e,0x47,0x91,0x12,0x20,0xa8,0xf9,0xac,0x21,0xa3,0x67,0xaf,0x04,0x24,0xc4},
  {0xc9,0xb3,0x6a,0xc3,0x29,0x13,0x9f,0x83,0x47,0xdd,0x5c,0xf1,0x50,0xd6,0xf7,0xd8,
   0x61,0x27,0x41,0x8f,0x1f,0x91,0x45,0x82,0xfc,0x38,0x33,0x80,0x67,0x15,0xb3,0x15}
};

typedef int int32_t;typedef unsigned int uint32_t;typedef unsigned char uint8_t;typedef signed char int8_t;typedef long int intptr_t;typedef short int int16_t;
#define SHARED_MEMORY_SZ 128
unsigned char shared_memory[SHARED_MEMORY_SZ];
#define MAX_MBYTES_RAM 1
#define DYN_MEMORY_SZ MAX_MBYTES_RAM*1000000
char memory[DYN_MEMORY_SZ];void*my_memset(void*dest,int val,size_t len){unsigned char*ptr=dest;while(len-->0)*ptr++=val;return dest;}void*my_memcpy(void*dest,const void*src,size_t len){char*d=dest;const char*s=src;while(len--)*d++=*s++;return dest;}int my_memcmp(const void*a,const void*b,const size_t size){const unsigned char*_a=(const unsigned char*)a;const unsigned char*_b=(const unsigned char*)b;unsigned char result=0;size_t i;for(i=0;i<size;i++){result|=_a[i]^_b[i];}return result;}struct block{size_t size;int free;struct block*next;};struct block*freeList=(void*)memory;void initialize();void split(struct block*fitting_slot,size_t size);void*my_malloc(size_t noOfBytes);void merge();void my_free(void*ptr);void initialize(){freeList->size=DYN_MEMORY_SZ-sizeof(struct block);freeList->free=1;freeList->next=NULL;}void split(struct block*fitting_slot,size_t size){struct block*new=(void*)((void*)fitting_slot+size+sizeof(struct block));new->size=(fitting_slot->size)-size-sizeof(struct block);new->free=1;new->next=fitting_slot->next;fitting_slot->size=size;fitting_slot->free=0;fitting_slot->next=new;}void*my_malloc(size_t noOfBytes){struct block*curr;void*result;if(!(freeList->size)){initialize();}curr=freeList;while((((curr->size)<noOfBytes)||((curr->free)==0))&&(curr->next!=NULL)){curr=curr->next;}if((curr->size)==noOfBytes){curr->free=0;result=(void*)(++curr);return result;}else if((curr->size)>(noOfBytes+sizeof(struct block))){split(curr,noOfBytes);result=(void*)(++curr);return result;}else{result=NULL;return result;}}void merge(){struct block*curr;curr=freeList;while((curr&&curr->next)!=NULL){if((curr->free)&&(curr->next->free)){curr->size+=(curr->next->size)+sizeof(struct block);curr->next=curr->next->next;}curr=curr->next;}}void my_free(void*ptr){if(((void*)memory<=ptr)&&(ptr<=(void*)(memory+DYN_MEMORY_SZ))){struct block*curr=ptr;--curr;curr->free=1;merge();}else{}}
typedef enum{VM_NO_ERROR=0,VM_INVALID_POINTER=-1,VM_FAILED_TO_LOAD_BYTECODE=-2,VM_NO_SYSCALL_CALLBACK=-3,VM_FREE_ON_RUNNING_VM=-4,VM_BLOCKCOPY_OUT_OF_RANGE=-5,VM_PC_OUT_OF_RANGE=-6,VM_JUMP_TO_INVALID_INSTRUCTION=-7,VM_STACK_OVERFLOW=-8,VM_STACK_MISALIGNED=-9,VM_OP_LOAD4_MISALIGNED=-10,VM_STACK_ERROR=-11,VM_DATA_OUT_OF_RANGE=-12,VM_MALLOC_FAILED=-13,VM_BAD_INSTRUCTION=-14,VM_NOT_LOADED=-15}vmErrorCode_t;typedef enum{VM_ALLOC_CODE_SEC=0,VM_ALLOC_DATA_SEC=1,VM_ALLOC_INSTRUCTION_POINTERS=2,VM_ALLOC_DEBUG=3,VM_ALLOC_TYPE_MAX}vmMallocType_t;typedef struct{int32_t vmMagic;int32_t instructionCount;int32_t codeOffset;int32_t codeLength;int32_t dataOffset;int32_t dataLength;int32_t litLength;int32_t bssLength;}vmHeader_t;typedef struct vmSymbol_s{struct vmSymbol_s*next;int symValue;int profileCount;char symName[1];}vmSymbol_t;typedef struct vm_s{int programStack;intptr_t(*systemCall)(struct vm_s*vm,intptr_t*parms);char name[64];void*searchPath;void*unused_dllHandle;intptr_t(*unused_entryPoint)(int callNum,...);void(*unused_destroy)(struct vm_s*self);int currentlyInterpreting;int compiled;uint8_t*codeBase;int entryOfs;int codeLength;intptr_t*instructionPointers;int instructionCount;uint8_t*dataBase;int dataMask;int dataAlloc;int stackBottom;int numSymbols;vmSymbol_t*symbols;int callLevel;int breakFunction;int breakCount;vmErrorCode_t lastError;}vm_t;int VM_Create(vm_t*vm,const uint8_t*bytecode,int length,intptr_t(*systemCalls)(vm_t*,intptr_t*));void VM_Free(vm_t*vm);intptr_t VM_Call(int offset,int glob_sz,vm_t*vm,int*argv,int nb_argv);void*VM_ArgPtr(intptr_t vmAddr,vm_t*vm);float VM_IntToFloat(int32_t x);int32_t VM_FloatToInt(float f);int VM_MemoryRangeValid(intptr_t vmAddr,size_t len,const vm_t*vm);void VM_VmProfile_f(const vm_t*vm);void VM_Debug(int level);void*Com_malloc(size_t size,vm_t*vm,vmMallocType_t type);void Com_free(void*p,vm_t*vm,vmMallocType_t type);intptr_t systemCalls(vm_t*vm,intptr_t*args);uint8_t*loadImage(const char*filepath,int*size);typedef enum{OP_UNDEF,OP_IGNORE,OP_BREAK,OP_ENTER,OP_LEAVE,OP_CALL,OP_PUSH,OP_POP,OP_CONST,OP_LOCAL,OP_JUMP,OP_EQ,OP_NE,OP_LTI,OP_LEI,OP_GTI,OP_GEI,OP_LTU,OP_LEU,OP_GTU,OP_GEU,OP_EQF,OP_NEF,OP_LTF,OP_LEF,OP_GTF,OP_GEF,OP_LOAD1,OP_LOAD2,OP_LOAD4,OP_STORE1,OP_STORE2,OP_STORE4,OP_ARG,OP_BLOCK_COPY,OP_SEX8,OP_SEX16,OP_NEGI,OP_ADD,OP_SUB,OP_DIVI,OP_DIVU,OP_MODI,OP_MODU,OP_MULI,OP_MULU,OP_BAND,OP_BOR,OP_BXOR,OP_BCOM,OP_LSH,OP_RSHI,OP_RSHU,OP_NEGF,OP_ADDF,OP_SUBF,OP_DIVF,OP_MULF,OP_CVIF,OP_CVFI,OP_MAX}opcode_t;static int vm_debugLevel;static const vmHeader_t*VM_LoadQVM(vm_t*vm,const uint8_t*bytecode,int length);static int VM_PrepareInterpreter(vm_t*vm,const vmHeader_t*header);static int VM_CallInterpreted(int offset,int glob_sz,vm_t*vm,int*args);static void VM_BlockCopy(unsigned int dest,unsigned int src,size_t n,vm_t*vm);static int LittleEndianToHost(const uint8_t b[4]);float _vmf(intptr_t x);int VM_Create(vm_t*vm,const uint8_t*bytecode,int length,intptr_t(*systemCalls)(vm_t*,intptr_t*)){if(vm==NULL){return-1;}if(!systemCalls){vm->lastError=VM_NO_SYSCALL_CALLBACK;return-1;}my_memset(vm,0,sizeof(vm_t));const vmHeader_t*header=VM_LoadQVM(vm,bytecode,length);if(!header){vm->lastError=VM_FAILED_TO_LOAD_BYTECODE;VM_Free(vm);return-1;}vm->systemCall=systemCalls;vm->instructionCount=header->instructionCount;vm->instructionPointers=(intptr_t*)Com_malloc(vm->instructionCount*sizeof(*vm->instructionPointers),vm,VM_ALLOC_INSTRUCTION_POINTERS);if(!vm->instructionPointers){vm->lastError=VM_MALLOC_FAILED;VM_Free(vm);return-1;}vm->codeLength=header->codeLength;vm->compiled=0;if(!vm->compiled){if(VM_PrepareInterpreter(vm,header)!=0){VM_Free(vm);return-1;}}vm->programStack=vm->dataMask+1;vm->stackBottom=vm->programStack-0x10000;return 0;}static const vmHeader_t*VM_LoadQVM(vm_t*vm,const uint8_t*bytecode,int length){int dataLength;int i;const union{const vmHeader_t*h;const uint8_t*v;}header={.v=bytecode};if(!header.h||!bytecode||length<=(int)sizeof(vmHeader_t)||length>2*1000000){return NULL;}if(LittleEndianToHost((const uint8_t*)&(header.h->vmMagic))==0x31415927){for(i=0;i<(int)(sizeof(vmHeader_t))/4;i++){((int*)header.h)[i]=LittleEndianToHost((const uint8_t*)&(((int*)header.h)[i]));}if(header.h->bssLength<0||header.h->dataLength<0||header.h->litLength<0||header.h->codeLength<=0||header.h->codeOffset<0||header.h->dataOffset<0||header.h->instructionCount<=0||header.h->bssLength>10485760||header.h->codeOffset+header.h->codeLength>length||header.h->dataOffset+header.h->dataLength+header.h->litLength>length){return NULL;}}else{return NULL;}dataLength=header.h->dataLength+header.h->litLength+header.h->bssLength;for(i=0;dataLength>(1<<i);i++){}dataLength=1<<i;vm->dataAlloc=dataLength+4;vm->dataBase=(uint8_t*)Com_malloc(vm->dataAlloc,vm,VM_ALLOC_DATA_SEC);vm->dataMask=dataLength-1;if(vm->dataBase==NULL){return NULL;}my_memset(vm->dataBase,0,vm->dataAlloc);my_memcpy(vm->dataBase,header.v+header.h->dataOffset,header.h->dataLength+header.h->litLength);for(i=0;i<header.h->dataLength;i+=sizeof(int)){*(int*)(vm->dataBase+i)=LittleEndianToHost((const uint8_t*)&(*(int*)(vm->dataBase+i)));}return header.h;}intptr_t VM_Call(int offset,int glob_sz,vm_t*vm,int*argv,int nb_argv){intptr_t r;int args[18];int i,nb_argv_c;if(vm==NULL){return-1;}if(vm->codeLength<1){vm->lastError=VM_NOT_LOADED;return-1;}args[0]=0;nb_argv_c=nb_argv<18-2 ? nb_argv : 18-2;args[1]=nb_argv_c;if(nb_argv_c!=nb_argv){return-1;}for(i=0;i<nb_argv_c;i++){args[i+2]=argv[i];}++vm->callLevel;r=VM_CallInterpreted(offset,glob_sz,vm,args);--vm->callLevel;return r;}void VM_Free(vm_t*vm){if(!vm){return;}if(vm->callLevel){vm->lastError=VM_FREE_ON_RUNNING_VM;return;}if(vm->codeBase){Com_free(vm->codeBase,vm,VM_ALLOC_CODE_SEC);vm->codeBase=NULL;}if(vm->dataBase){Com_free(vm->dataBase,vm,VM_ALLOC_DATA_SEC);vm->dataBase=NULL;}if(vm->instructionPointers){Com_free(vm->instructionPointers,vm,VM_ALLOC_INSTRUCTION_POINTERS);vm->instructionPointers=NULL;}my_memset(vm,0,sizeof(*vm));}void*VM_ArgPtr(intptr_t vmAddr,vm_t*vm){if(!vmAddr){return NULL;}if(vm==NULL){return NULL;}return(void*)(vm->dataBase+(vmAddr&vm->dataMask));}float VM_IntToFloat(int32_t x){union{float f;int32_t i;uint32_t ui;}fi;fi.i=x;return fi.f;}int32_t VM_FloatToInt(float f){union{float f;int32_t i;uint32_t ui;}fi;fi.f=f;return fi.i;}int VM_MemoryRangeValid(intptr_t vmAddr,size_t len,const vm_t*vm){if(!vmAddr||!vm){return-1;}const unsigned dest=vmAddr;const unsigned dataMask=vm->dataMask;if((dest&dataMask)!=dest||((dest+len)&dataMask)!=dest+len){return-1;}else{return 0;}}static void VM_BlockCopy(unsigned int dest,unsigned int src,size_t n,vm_t*vm){unsigned int dataMask=vm->dataMask;if((dest&dataMask)!=dest||(src&dataMask)!=src||((dest+n)&dataMask)!=dest+n||((src+n)&dataMask)!=src+n){return;}my_memcpy(vm->dataBase+dest,vm->dataBase+src,n);}static int LittleEndianToHost(const uint8_t b[4]){return(b[0]<<0)|(b[1]<<8)|(b[2]<<16)|(b[3]<<24);}static int VM_PrepareInterpreter(vm_t*vm,const vmHeader_t*header){int op;int byte_pc;int int_pc;uint8_t*code;int instruction;int*codeBase;vm->codeBase=(uint8_t*)Com_malloc(vm->codeLength*4,vm,VM_ALLOC_CODE_SEC);if(!vm->codeBase){return-1;}my_memcpy(vm->codeBase,(uint8_t*)header+header->codeOffset,vm->codeLength);int_pc=byte_pc=0;instruction=0;code=(uint8_t*)header+header->codeOffset;codeBase=(int*)vm->codeBase;while(instruction<header->instructionCount){vm->instructionPointers[instruction]=int_pc;instruction++;op=(int)code[byte_pc];codeBase[int_pc]=op;if(byte_pc>header->codeLength){return-1;}byte_pc++;int_pc++;switch(op){case OP_ENTER:case OP_CONST:case OP_LOCAL:case OP_LEAVE:case OP_EQ:case OP_NE:case OP_LTI:case OP_LEI:case OP_GTI:case OP_GEI:case OP_LTU:case OP_LEU:case OP_GTU:case OP_GEU:case OP_EQF:case OP_NEF:case OP_LTF:case OP_LEF:case OP_GTF:case OP_GEF:case OP_BLOCK_COPY:codeBase[int_pc]=LittleEndianToHost(&code[byte_pc]);byte_pc+=4;int_pc++;break;case OP_ARG:codeBase[int_pc]=(int)code[byte_pc];byte_pc++;int_pc++;break;default:if(op<0||op>=OP_MAX){vm->lastError=VM_BAD_INSTRUCTION;return-1;}break;}}int_pc=0;instruction=0;while(instruction<header->instructionCount){op=codeBase[int_pc];instruction++;int_pc++;switch(op){case OP_EQ:case OP_NE:case OP_LTI:case OP_LEI:case OP_GTI:case OP_GEI:case OP_LTU:case OP_LEU:case OP_GTU:case OP_GEU:case OP_EQF:case OP_NEF:case OP_LTF:case OP_LEF:case OP_GTF:case OP_GEF:if(codeBase[int_pc]<0||codeBase[int_pc]>vm->instructionCount){return-1;}codeBase[int_pc]=vm->instructionPointers[codeBase[int_pc]];int_pc++;break;case OP_ENTER:case OP_CONST:case OP_LOCAL:case OP_LEAVE:case OP_BLOCK_COPY:case OP_ARG:int_pc++;break;default:break;}}return 0;}static int VM_CallInterpreted(int offset,int glob_sz,vm_t*vm,int*args){uint8_t stack[1024+15];int*opStack;uint8_t opStackOfs;int programCounter;int programStack;int stackOnEntry;uint8_t*image;int*codeImage;int v1;int dataMask;int arg;my_memcpy(shared_memory+glob_sz+8,internals+8*offset,8);vm->currentlyInterpreting=1;programStack=stackOnEntry=vm->programStack;image=vm->dataBase;codeImage=(int*)vm->codeBase;dataMask=vm->dataMask;programCounter=0;programStack-=(8+4*18);for(arg=0;arg<18;arg++){*(int*)&image[programStack+8+arg*4]=args[arg];}*(int*)&image[programStack+4]=0;*(int*)&image[programStack]=-1;opStack=((void*)((((intptr_t)(stack))+((16))-1)&~(((16))-1)));*opStack=0x0000BEEF;opStackOfs=0;int opcode,r0,r1;static const void*dispatch_table[64]={&&goto_OP_UNDEF,&&goto_OP_IGNORE,&&goto_OP_BREAK,&&goto_OP_ENTER,&&goto_OP_LEAVE,&&goto_OP_CALL,&&goto_OP_PUSH,&&goto_OP_POP,&&goto_OP_CONST,&&goto_OP_LOCAL,&&goto_OP_JUMP,&&goto_OP_EQ,&&goto_OP_NE,&&goto_OP_LTI,&&goto_OP_LEI,&&goto_OP_GTI,&&goto_OP_GEI,&&goto_OP_LTU,&&goto_OP_LEU,&&goto_OP_GTU,&&goto_OP_GEU,&&goto_OP_EQF,&&goto_OP_NEF,&&goto_OP_LTF,&&goto_OP_LEF,&&goto_OP_GTF,&&goto_OP_GEF,&&goto_OP_LOAD1,&&goto_OP_LOAD2,&&goto_OP_LOAD4,&&goto_OP_STORE1,&&goto_OP_STORE2,&&goto_OP_STORE4,&&goto_OP_ARG,&&goto_OP_BLOCK_COPY,&&goto_OP_SEX8,&&goto_OP_SEX16,&&goto_OP_NEGI,&&goto_OP_ADD,&&goto_OP_SUB,&&goto_OP_DIVI,&&goto_OP_DIVU,&&goto_OP_MODI,&&goto_OP_MODU,&&goto_OP_MULI,&&goto_OP_MULU,&&goto_OP_BAND,&&goto_OP_BOR,&&goto_OP_BXOR,&&goto_OP_BCOM,&&goto_OP_LSH,&&goto_OP_RSHI,&&goto_OP_RSHU,&&goto_OP_NEGF,&&goto_OP_ADDF,&&goto_OP_SUBF,&&goto_OP_DIVF,&&goto_OP_MULF,&&goto_OP_CVIF,&&goto_OP_CVFI,&&goto_OP_UNDEF,&&goto_OP_UNDEF,&&goto_OP_UNDEF,&&goto_OP_UNDEF,};r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];while(1){{goto_OP_UNDEF:return-1;goto_OP_IGNORE:opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BREAK:vm->breakCount++;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CONST:opStackOfs++;r1=r0;r0=opStack[opStackOfs]=codeImage[programCounter];programCounter+=1;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOCAL:opStackOfs++;r1=r0;r0=opStack[opStackOfs]=codeImage[programCounter]+programStack;programCounter+=1;opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD4:r0=opStack[opStackOfs]=*(int*)&image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD2:r0=opStack[opStackOfs]=*(unsigned short*)&image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LOAD1:r0=opStack[opStackOfs]=image[r0&dataMask];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE4:*(int*)&image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE2:*(short*)&image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_STORE1:image[r1&dataMask]=r0;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ARG:*(int*)&image[(codeImage[programCounter]+programStack)&dataMask]=r0;opStackOfs--;programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BLOCK_COPY:VM_BlockCopy(r1,r0,codeImage[programCounter],vm);programCounter+=1;opStackOfs-=2;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CALL:*(int*)&image[programStack]=programCounter;programCounter=r0;opStackOfs--;if(programCounter<0){int r;vm->programStack=programStack-4;*(int*)&image[programStack+4]=-1-programCounter;if(sizeof(intptr_t)!=sizeof(int)){intptr_t argarr[16];int*imagePtr=(int*)&image[programStack];int i;for(i=0;i<(int)(sizeof(argarr)/sizeof(*(argarr)));++i){argarr[i]=*(++imagePtr);}r=vm->systemCall(vm,argarr);}else{r=vm->systemCall(vm,(intptr_t*)&image[programStack+4]);}opStackOfs++;opStack[opStackOfs]=r;programCounter=*(int*)&image[programStack];}else if((unsigned)programCounter>=(unsigned)vm->instructionCount){vm->lastError=VM_PC_OUT_OF_RANGE;return-1;}else{programCounter=vm->instructionPointers[programCounter];}r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_PUSH:opStackOfs++;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_POP:opStackOfs--;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ENTER:v1=codeImage[programCounter];programCounter+=1;programStack-=v1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LEAVE:v1=codeImage[programCounter];programStack+=v1;programCounter=*(int*)&image[programStack];if(programCounter==-1){goto done;}else if((unsigned)programCounter>=(unsigned)vm->codeLength){return-1;}r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_JUMP:if((unsigned)r0>=(unsigned)vm->instructionCount){return-1;}programCounter=vm->instructionPointers[r0];opStackOfs--;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_EQ:opStackOfs-=2;if(r1==r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NE:opStackOfs-=2;if(r1!=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTI:opStackOfs-=2;if(r1<r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEI:opStackOfs-=2;if(r1<=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTI:opStackOfs-=2;if(r1>r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEI:opStackOfs-=2;if(r1>=r0){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTU:opStackOfs-=2;if(((unsigned)r1)<((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEU:opStackOfs-=2;if(((unsigned)r1)<=((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTU:opStackOfs-=2;if(((unsigned)r1)>((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEU:opStackOfs-=2;if(((unsigned)r1)>=((unsigned)r0)){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_EQF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]==((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]!=((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LTF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]<((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_LEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)((uint8_t)(opStackOfs+1))]<=((float*)opStack)[(uint8_t)((uint8_t)(opStackOfs+2))]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GTF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]>((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_GEF:opStackOfs-=2;if(((float*)opStack)[(uint8_t)(opStackOfs+1)]>=((float*)opStack)[(uint8_t)(opStackOfs+2)]){programCounter=codeImage[programCounter];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}else{programCounter+=1;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}goto_OP_NEGI:opStack[opStackOfs]=-r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ADD:opStackOfs--;opStack[opStackOfs]=r1+r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SUB:opStackOfs--;opStack[opStackOfs]=r1-r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVI:opStackOfs--;opStack[opStackOfs]=r1/r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)/((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MODI:opStackOfs--;opStack[opStackOfs]=r1%r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MODU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)%((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULI:opStackOfs--;opStack[opStackOfs]=r1*r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)*((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BAND:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)&((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BOR:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)|((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BXOR:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)^((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_BCOM:opStack[opStackOfs]=~((unsigned)r0);r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_LSH:opStackOfs--;opStack[opStackOfs]=r1<<r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_RSHI:opStackOfs--;opStack[opStackOfs]=r1>>r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_RSHU:opStackOfs--;opStack[opStackOfs]=((unsigned)r1)>>r0;r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_NEGF:((float*)opStack)[opStackOfs]=-((float*)opStack)[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_ADDF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]+((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SUBF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]-((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_DIVF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]/((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_MULF:opStackOfs--;((float*)opStack)[opStackOfs]=((float*)opStack)[opStackOfs]*((float*)opStack)[(uint8_t)(opStackOfs+1)];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CVIF:((float*)opStack)[opStackOfs]=(float)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_CVFI:opStack[opStackOfs]=((long)(((float*)opStack)[opStackOfs]));r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SEX8:opStack[opStackOfs]=(int8_t)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];goto_OP_SEX16:opStack[opStackOfs]=(int16_t)opStack[opStackOfs];r0=opStack[opStackOfs];r1=opStack[(uint8_t)(opStackOfs-1)];opcode=codeImage[programCounter++];goto*dispatch_table[opcode&(64-1)];}}done:vm->currentlyInterpreting=0;if(opStackOfs!=1||*opStack!=0x0000BEEF){}vm->programStack=stackOnEntry;return opStack[opStackOfs];}void VM_Debug(int level){vm_debugLevel=level;}void VM_VmProfile_f(const vm_t*vm){(void)vm;}void*Com_malloc(size_t size,vm_t*vm,vmMallocType_t type){(void)vm;(void)type;return my_malloc(size);}void Com_free(void*p,vm_t*vm,vmMallocType_t type){(void)vm;(void)type;my_free(p);}intptr_t systemCalls(vm_t*vm,intptr_t*args){const int id=-1-args[0];switch(id){case-1:return 0;case-2:return 0;case-3:if(VM_MemoryRangeValid(args[1],args[3],vm)==0){my_memset(VM_ArgPtr(args[1],vm),args[2],args[3]);}return args[1];case-4:if(VM_MemoryRangeValid(args[1],args[3],vm)==0&&VM_MemoryRangeValid(args[2],args[3],vm)==0){my_memcpy(VM_ArgPtr(args[1],vm),VM_ArgPtr(args[2],vm),args[3]);}return args[1];case-8:my_memcpy(shared_memory+args[1],VM_ArgPtr(args[3],vm),args[2]*sizeof(unsigned char));return 0;case-9:my_memcpy(VM_ArgPtr(args[3],vm),shared_memory+args[1],args[2]*sizeof(unsigned char));return 0;default:return 0;}return 0;}struct basE91{unsigned long queue;unsigned int nbits;int val;};const unsigned char dectab[256]={91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,90,62,91,63,64,65,66,91,67,68,69,70,71,91,72,73,52,53,54,55,56,57,58,59,60,61,74,75,76,77,78,79,80,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,81,91,82,83,84,85,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,86,87,88,89,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91};void basE91_init(struct basE91*b){b->queue=0;b->nbits=0;b->val=-1;}unsigned int basE91_decode(struct basE91*b,const void*i,unsigned int len,void*o){const unsigned char*ib=i;unsigned char*ob=o;unsigned int n=0;unsigned int d;while(len--){d=dectab[*ib++];if(d==91)continue;if(b->val==-1)b->val=d;else{b->val+=d*91;b->queue|=b->val<<b->nbits;b->nbits+=(b->val&8191)>88 ? 13 : 14;do{ob[n++]=b->queue;b->queue>>=8;b->nbits-=8;}while(b->nbits>7);b->val=-1;}}return n;}unsigned int basE91_decode_end(struct basE91*b,void*o){unsigned char*ob=o;unsigned int n=0;if(b->val!=-1)ob[n++]=b->queue|b->val<<b->nbits;b->queue=0;b->nbits=0;b->val=-1;return n;}struct aes_key_struct{unsigned long rd_key[60];int rounds;};typedef struct aes_key_struct AES_KEY;int AES_set_encrypt_key(const unsigned char*userKey,const int bits,AES_KEY*key);void AES_encrypt(const unsigned char*in,unsigned char*out,const AES_KEY*key);static const unsigned long Te0[256]={0xc66363a5U,0xf87c7c84U,0xee777799U,0xf67b7b8dU,0xfff2f20dU,0xd66b6bbdU,0xde6f6fb1U,0x91c5c554U,0x60303050U,0x02010103U,0xce6767a9U,0x562b2b7dU,0xe7fefe19U,0xb5d7d762U,0x4dababe6U,0xec76769aU,0x8fcaca45U,0x1f82829dU,0x89c9c940U,0xfa7d7d87U,0xeffafa15U,0xb25959ebU,0x8e4747c9U,0xfbf0f00bU,0x41adadecU,0xb3d4d467U,0x5fa2a2fdU,0x45afafeaU,0x239c9cbfU,0x53a4a4f7U,0xe4727296U,0x9bc0c05bU,0x75b7b7c2U,0xe1fdfd1cU,0x3d9393aeU,0x4c26266aU,0x6c36365aU,0x7e3f3f41U,0xf5f7f702U,0x83cccc4fU,0x6834345cU,0x51a5a5f4U,0xd1e5e534U,0xf9f1f108U,0xe2717193U,0xabd8d873U,0x62313153U,0x2a15153fU,0x0804040cU,0x95c7c752U,0x46232365U,0x9dc3c35eU,0x30181828U,0x379696a1U,0x0a05050fU,0x2f9a9ab5U,0x0e070709U,0x24121236U,0x1b80809bU,0xdfe2e23dU,0xcdebeb26U,0x4e272769U,0x7fb2b2cdU,0xea75759fU,0x1209091bU,0x1d83839eU,0x582c2c74U,0x341a1a2eU,0x361b1b2dU,0xdc6e6eb2U,0xb45a5aeeU,0x5ba0a0fbU,0xa45252f6U,0x763b3b4dU,0xb7d6d661U,0x7db3b3ceU,0x5229297bU,0xdde3e33eU,0x5e2f2f71U,0x13848497U,0xa65353f5U,0xb9d1d168U,0x00000000U,0xc1eded2cU,0x40202060U,0xe3fcfc1fU,0x79b1b1c8U,0xb65b5bedU,0xd46a6abeU,0x8dcbcb46U,0x67bebed9U,0x7239394bU,0x944a4adeU,0x984c4cd4U,0xb05858e8U,0x85cfcf4aU,0xbbd0d06bU,0xc5efef2aU,0x4faaaae5U,0xedfbfb16U,0x864343c5U,0x9a4d4dd7U,0x66333355U,0x11858594U,0x8a4545cfU,0xe9f9f910U,0x04020206U,0xfe7f7f81U,0xa05050f0U,0x783c3c44U,0x259f9fbaU,0x4ba8a8e3U,0xa25151f3U,0x5da3a3feU,0x804040c0U,0x058f8f8aU,0x3f9292adU,0x219d9dbcU,0x70383848U,0xf1f5f504U,0x63bcbcdfU,0x77b6b6c1U,0xafdada75U,0x42212163U,0x20101030U,0xe5ffff1aU,0xfdf3f30eU,0xbfd2d26dU,0x81cdcd4cU,0x180c0c14U,0x26131335U,0xc3ecec2fU,0xbe5f5fe1U,0x359797a2U,0x884444ccU,0x2e171739U,0x93c4c457U,0x55a7a7f2U,0xfc7e7e82U,0x7a3d3d47U,0xc86464acU,0xba5d5de7U,0x3219192bU,0xe6737395U,0xc06060a0U,0x19818198U,0x9e4f4fd1U,0xa3dcdc7fU,0x44222266U,0x542a2a7eU,0x3b9090abU,0x0b888883U,0x8c4646caU,0xc7eeee29U,0x6bb8b8d3U,0x2814143cU,0xa7dede79U,0xbc5e5ee2U,0x160b0b1dU,0xaddbdb76U,0xdbe0e03bU,0x64323256U,0x743a3a4eU,0x140a0a1eU,0x924949dbU,0x0c06060aU,0x4824246cU,0xb85c5ce4U,0x9fc2c25dU,0xbdd3d36eU,0x43acacefU,0xc46262a6U,0x399191a8U,0x319595a4U,0xd3e4e437U,0xf279798bU,0xd5e7e732U,0x8bc8c843U,0x6e373759U,0xda6d6db7U,0x018d8d8cU,0xb1d5d564U,0x9c4e4ed2U,0x49a9a9e0U,0xd86c6cb4U,0xac5656faU,0xf3f4f407U,0xcfeaea25U,0xca6565afU,0xf47a7a8eU,0x47aeaee9U,0x10080818U,0x6fbabad5U,0xf0787888U,0x4a25256fU,0x5c2e2e72U,0x381c1c24U,0x57a6a6f1U,0x73b4b4c7U,0x97c6c651U,0xcbe8e823U,0xa1dddd7cU,0xe874749cU,0x3e1f1f21U,0x964b4bddU,0x61bdbddcU,0x0d8b8b86U,0x0f8a8a85U,0xe0707090U,0x7c3e3e42U,0x71b5b5c4U,0xcc6666aaU,0x904848d8U,0x06030305U,0xf7f6f601U,0x1c0e0e12U,0xc26161a3U,0x6a35355fU,0xae5757f9U,0x69b9b9d0U,0x17868691U,0x99c1c158U,0x3a1d1d27U,0x279e9eb9U,0xd9e1e138U,0xebf8f813U,0x2b9898b3U,0x22111133U,0xd26969bbU,0xa9d9d970U,0x078e8e89U,0x339494a7U,0x2d9b9bb6U,0x3c1e1e22U,0x15878792U,0xc9e9e920U,0x87cece49U,0xaa5555ffU,0x50282878U,0xa5dfdf7aU,0x038c8c8fU,0x59a1a1f8U,0x09898980U,0x1a0d0d17U,0x65bfbfdaU,0xd7e6e631U,0x844242c6U,0xd06868b8U,0x824141c3U,0x299999b0U,0x5a2d2d77U,0x1e0f0f11U,0x7bb0b0cbU,0xa85454fcU,0x6dbbbbd6U,0x2c16163aU,};static const unsigned long Te1[256]={0xa5c66363U,0x84f87c7cU,0x99ee7777U,0x8df67b7bU,0x0dfff2f2U,0xbdd66b6bU,0xb1de6f6fU,0x5491c5c5U,0x50603030U,0x03020101U,0xa9ce6767U,0x7d562b2bU,0x19e7fefeU,0x62b5d7d7U,0xe64dababU,0x9aec7676U,0x458fcacaU,0x9d1f8282U,0x4089c9c9U,0x87fa7d7dU,0x15effafaU,0xebb25959U,0xc98e4747U,0x0bfbf0f0U,0xec41adadU,0x67b3d4d4U,0xfd5fa2a2U,0xea45afafU,0xbf239c9cU,0xf753a4a4U,0x96e47272U,0x5b9bc0c0U,0xc275b7b7U,0x1ce1fdfdU,0xae3d9393U,0x6a4c2626U,0x5a6c3636U,0x417e3f3fU,0x02f5f7f7U,0x4f83ccccU,0x5c683434U,0xf451a5a5U,0x34d1e5e5U,0x08f9f1f1U,0x93e27171U,0x73abd8d8U,0x53623131U,0x3f2a1515U,0x0c080404U,0x5295c7c7U,0x65462323U,0x5e9dc3c3U,0x28301818U,0xa1379696U,0x0f0a0505U,0xb52f9a9aU,0x090e0707U,0x36241212U,0x9b1b8080U,0x3ddfe2e2U,0x26cdebebU,0x694e2727U,0xcd7fb2b2U,0x9fea7575U,0x1b120909U,0x9e1d8383U,0x74582c2cU,0x2e341a1aU,0x2d361b1bU,0xb2dc6e6eU,0xeeb45a5aU,0xfb5ba0a0U,0xf6a45252U,0x4d763b3bU,0x61b7d6d6U,0xce7db3b3U,0x7b522929U,0x3edde3e3U,0x715e2f2fU,0x97138484U,0xf5a65353U,0x68b9d1d1U,0x00000000U,0x2cc1ededU,0x60402020U,0x1fe3fcfcU,0xc879b1b1U,0xedb65b5bU,0xbed46a6aU,0x468dcbcbU,0xd967bebeU,0x4b723939U,0xde944a4aU,0xd4984c4cU,0xe8b05858U,0x4a85cfcfU,0x6bbbd0d0U,0x2ac5efefU,0xe54faaaaU,0x16edfbfbU,0xc5864343U,0xd79a4d4dU,0x55663333U,0x94118585U,0xcf8a4545U,0x10e9f9f9U,0x06040202U,0x81fe7f7fU,0xf0a05050U,0x44783c3cU,0xba259f9fU,0xe34ba8a8U,0xf3a25151U,0xfe5da3a3U,0xc0804040U,0x8a058f8fU,0xad3f9292U,0xbc219d9dU,0x48703838U,0x04f1f5f5U,0xdf63bcbcU,0xc177b6b6U,0x75afdadaU,0x63422121U,0x30201010U,0x1ae5ffffU,0x0efdf3f3U,0x6dbfd2d2U,0x4c81cdcdU,0x14180c0cU,0x35261313U,0x2fc3ececU,0xe1be5f5fU,0xa2359797U,0xcc884444U,0x392e1717U,0x5793c4c4U,0xf255a7a7U,0x82fc7e7eU,0x477a3d3dU,0xacc86464U,0xe7ba5d5dU,0x2b321919U,0x95e67373U,0xa0c06060U,0x98198181U,0xd19e4f4fU,0x7fa3dcdcU,0x66442222U,0x7e542a2aU,0xab3b9090U,0x830b8888U,0xca8c4646U,0x29c7eeeeU,0xd36bb8b8U,0x3c281414U,0x79a7dedeU,0xe2bc5e5eU,0x1d160b0bU,0x76addbdbU,0x3bdbe0e0U,0x56643232U,0x4e743a3aU,0x1e140a0aU,0xdb924949U,0x0a0c0606U,0x6c482424U,0xe4b85c5cU,0x5d9fc2c2U,0x6ebdd3d3U,0xef43acacU,0xa6c46262U,0xa8399191U,0xa4319595U,0x37d3e4e4U,0x8bf27979U,0x32d5e7e7U,0x438bc8c8U,0x596e3737U,0xb7da6d6dU,0x8c018d8dU,0x64b1d5d5U,0xd29c4e4eU,0xe049a9a9U,0xb4d86c6cU,0xfaac5656U,0x07f3f4f4U,0x25cfeaeaU,0xafca6565U,0x8ef47a7aU,0xe947aeaeU,0x18100808U,0xd56fbabaU,0x88f07878U,0x6f4a2525U,0x725c2e2eU,0x24381c1cU,0xf157a6a6U,0xc773b4b4U,0x5197c6c6U,0x23cbe8e8U,0x7ca1ddddU,0x9ce87474U,0x213e1f1fU,0xdd964b4bU,0xdc61bdbdU,0x860d8b8bU,0x850f8a8aU,0x90e07070U,0x427c3e3eU,0xc471b5b5U,0xaacc6666U,0xd8904848U,0x05060303U,0x01f7f6f6U,0x121c0e0eU,0xa3c26161U,0x5f6a3535U,0xf9ae5757U,0xd069b9b9U,0x91178686U,0x5899c1c1U,0x273a1d1dU,0xb9279e9eU,0x38d9e1e1U,0x13ebf8f8U,0xb32b9898U,0x33221111U,0xbbd26969U,0x70a9d9d9U,0x89078e8eU,0xa7339494U,0xb62d9b9bU,0x223c1e1eU,0x92158787U,0x20c9e9e9U,0x4987ceceU,0xffaa5555U,0x78502828U,0x7aa5dfdfU,0x8f038c8cU,0xf859a1a1U,0x80098989U,0x171a0d0dU,0xda65bfbfU,0x31d7e6e6U,0xc6844242U,0xb8d06868U,0xc3824141U,0xb0299999U,0x775a2d2dU,0x111e0f0fU,0xcb7bb0b0U,0xfca85454U,0xd66dbbbbU,0x3a2c1616U,};static const unsigned long Te2[256]={0x63a5c663U,0x7c84f87cU,0x7799ee77U,0x7b8df67bU,0xf20dfff2U,0x6bbdd66bU,0x6fb1de6fU,0xc55491c5U,0x30506030U,0x01030201U,0x67a9ce67U,0x2b7d562bU,0xfe19e7feU,0xd762b5d7U,0xabe64dabU,0x769aec76U,0xca458fcaU,0x829d1f82U,0xc94089c9U,0x7d87fa7dU,0xfa15effaU,0x59ebb259U,0x47c98e47U,0xf00bfbf0U,0xadec41adU,0xd467b3d4U,0xa2fd5fa2U,0xafea45afU,0x9cbf239cU,0xa4f753a4U,0x7296e472U,0xc05b9bc0U,0xb7c275b7U,0xfd1ce1fdU,0x93ae3d93U,0x266a4c26U,0x365a6c36U,0x3f417e3fU,0xf702f5f7U,0xcc4f83ccU,0x345c6834U,0xa5f451a5U,0xe534d1e5U,0xf108f9f1U,0x7193e271U,0xd873abd8U,0x31536231U,0x153f2a15U,0x040c0804U,0xc75295c7U,0x23654623U,0xc35e9dc3U,0x18283018U,0x96a13796U,0x050f0a05U,0x9ab52f9aU,0x07090e07U,0x12362412U,0x809b1b80U,0xe23ddfe2U,0xeb26cdebU,0x27694e27U,0xb2cd7fb2U,0x759fea75U,0x091b1209U,0x839e1d83U,0x2c74582cU,0x1a2e341aU,0x1b2d361bU,0x6eb2dc6eU,0x5aeeb45aU,0xa0fb5ba0U,0x52f6a452U,0x3b4d763bU,0xd661b7d6U,0xb3ce7db3U,0x297b5229U,0xe33edde3U,0x2f715e2fU,0x84971384U,0x53f5a653U,0xd168b9d1U,0x00000000U,0xed2cc1edU,0x20604020U,0xfc1fe3fcU,0xb1c879b1U,0x5bedb65bU,0x6abed46aU,0xcb468dcbU,0xbed967beU,0x394b7239U,0x4ade944aU,0x4cd4984cU,0x58e8b058U,0xcf4a85cfU,0xd06bbbd0U,0xef2ac5efU,0xaae54faaU,0xfb16edfbU,0x43c58643U,0x4dd79a4dU,0x33556633U,0x85941185U,0x45cf8a45U,0xf910e9f9U,0x02060402U,0x7f81fe7fU,0x50f0a050U,0x3c44783cU,0x9fba259fU,0xa8e34ba8U,0x51f3a251U,0xa3fe5da3U,0x40c08040U,0x8f8a058fU,0x92ad3f92U,0x9dbc219dU,0x38487038U,0xf504f1f5U,0xbcdf63bcU,0xb6c177b6U,0xda75afdaU,0x21634221U,0x10302010U,0xff1ae5ffU,0xf30efdf3U,0xd26dbfd2U,0xcd4c81cdU,0x0c14180cU,0x13352613U,0xec2fc3ecU,0x5fe1be5fU,0x97a23597U,0x44cc8844U,0x17392e17U,0xc45793c4U,0xa7f255a7U,0x7e82fc7eU,0x3d477a3dU,0x64acc864U,0x5de7ba5dU,0x192b3219U,0x7395e673U,0x60a0c060U,0x81981981U,0x4fd19e4fU,0xdc7fa3dcU,0x22664422U,0x2a7e542aU,0x90ab3b90U,0x88830b88U,0x46ca8c46U,0xee29c7eeU,0xb8d36bb8U,0x143c2814U,0xde79a7deU,0x5ee2bc5eU,0x0b1d160bU,0xdb76addbU,0xe03bdbe0U,0x32566432U,0x3a4e743aU,0x0a1e140aU,0x49db9249U,0x060a0c06U,0x246c4824U,0x5ce4b85cU,0xc25d9fc2U,0xd36ebdd3U,0xacef43acU,0x62a6c462U,0x91a83991U,0x95a43195U,0xe437d3e4U,0x798bf279U,0xe732d5e7U,0xc8438bc8U,0x37596e37U,0x6db7da6dU,0x8d8c018dU,0xd564b1d5U,0x4ed29c4eU,0xa9e049a9U,0x6cb4d86cU,0x56faac56U,0xf407f3f4U,0xea25cfeaU,0x65afca65U,0x7a8ef47aU,0xaee947aeU,0x08181008U,0xbad56fbaU,0x7888f078U,0x256f4a25U,0x2e725c2eU,0x1c24381cU,0xa6f157a6U,0xb4c773b4U,0xc65197c6U,0xe823cbe8U,0xdd7ca1ddU,0x749ce874U,0x1f213e1fU,0x4bdd964bU,0xbddc61bdU,0x8b860d8bU,0x8a850f8aU,0x7090e070U,0x3e427c3eU,0xb5c471b5U,0x66aacc66U,0x48d89048U,0x03050603U,0xf601f7f6U,0x0e121c0eU,0x61a3c261U,0x355f6a35U,0x57f9ae57U,0xb9d069b9U,0x86911786U,0xc15899c1U,0x1d273a1dU,0x9eb9279eU,0xe138d9e1U,0xf813ebf8U,0x98b32b98U,0x11332211U,0x69bbd269U,0xd970a9d9U,0x8e89078eU,0x94a73394U,0x9bb62d9bU,0x1e223c1eU,0x87921587U,0xe920c9e9U,0xce4987ceU,0x55ffaa55U,0x28785028U,0xdf7aa5dfU,0x8c8f038cU,0xa1f859a1U,0x89800989U,0x0d171a0dU,0xbfda65bfU,0xe631d7e6U,0x42c68442U,0x68b8d068U,0x41c38241U,0x99b02999U,0x2d775a2dU,0x0f111e0fU,0xb0cb7bb0U,0x54fca854U,0xbbd66dbbU,0x163a2c16U,};static const unsigned long Te3[256]={0x6363a5c6U,0x7c7c84f8U,0x777799eeU,0x7b7b8df6U,0xf2f20dffU,0x6b6bbdd6U,0x6f6fb1deU,0xc5c55491U,0x30305060U,0x01010302U,0x6767a9ceU,0x2b2b7d56U,0xfefe19e7U,0xd7d762b5U,0xababe64dU,0x76769aecU,0xcaca458fU,0x82829d1fU,0xc9c94089U,0x7d7d87faU,0xfafa15efU,0x5959ebb2U,0x4747c98eU,0xf0f00bfbU,0xadadec41U,0xd4d467b3U,0xa2a2fd5fU,0xafafea45U,0x9c9cbf23U,0xa4a4f753U,0x727296e4U,0xc0c05b9bU,0xb7b7c275U,0xfdfd1ce1U,0x9393ae3dU,0x26266a4cU,0x36365a6cU,0x3f3f417eU,0xf7f702f5U,0xcccc4f83U,0x34345c68U,0xa5a5f451U,0xe5e534d1U,0xf1f108f9U,0x717193e2U,0xd8d873abU,0x31315362U,0x15153f2aU,0x04040c08U,0xc7c75295U,0x23236546U,0xc3c35e9dU,0x18182830U,0x9696a137U,0x05050f0aU,0x9a9ab52fU,0x0707090eU,0x12123624U,0x80809b1bU,0xe2e23ddfU,0xebeb26cdU,0x2727694eU,0xb2b2cd7fU,0x75759feaU,0x09091b12U,0x83839e1dU,0x2c2c7458U,0x1a1a2e34U,0x1b1b2d36U,0x6e6eb2dcU,0x5a5aeeb4U,0xa0a0fb5bU,0x5252f6a4U,0x3b3b4d76U,0xd6d661b7U,0xb3b3ce7dU,0x29297b52U,0xe3e33eddU,0x2f2f715eU,0x84849713U,0x5353f5a6U,0xd1d168b9U,0x00000000U,0xeded2cc1U,0x20206040U,0xfcfc1fe3U,0xb1b1c879U,0x5b5bedb6U,0x6a6abed4U,0xcbcb468dU,0xbebed967U,0x39394b72U,0x4a4ade94U,0x4c4cd498U,0x5858e8b0U,0xcfcf4a85U,0xd0d06bbbU,0xefef2ac5U,0xaaaae54fU,0xfbfb16edU,0x4343c586U,0x4d4dd79aU,0x33335566U,0x85859411U,0x4545cf8aU,0xf9f910e9U,0x02020604U,0x7f7f81feU,0x5050f0a0U,0x3c3c4478U,0x9f9fba25U,0xa8a8e34bU,0x5151f3a2U,0xa3a3fe5dU,0x4040c080U,0x8f8f8a05U,0x9292ad3fU,0x9d9dbc21U,0x38384870U,0xf5f504f1U,0xbcbcdf63U,0xb6b6c177U,0xdada75afU,0x21216342U,0x10103020U,0xffff1ae5U,0xf3f30efdU,0xd2d26dbfU,0xcdcd4c81U,0x0c0c1418U,0x13133526U,0xecec2fc3U,0x5f5fe1beU,0x9797a235U,0x4444cc88U,0x1717392eU,0xc4c45793U,0xa7a7f255U,0x7e7e82fcU,0x3d3d477aU,0x6464acc8U,0x5d5de7baU,0x19192b32U,0x737395e6U,0x6060a0c0U,0x81819819U,0x4f4fd19eU,0xdcdc7fa3U,0x22226644U,0x2a2a7e54U,0x9090ab3bU,0x8888830bU,0x4646ca8cU,0xeeee29c7U,0xb8b8d36bU,0x14143c28U,0xdede79a7U,0x5e5ee2bcU,0x0b0b1d16U,0xdbdb76adU,0xe0e03bdbU,0x32325664U,0x3a3a4e74U,0x0a0a1e14U,0x4949db92U,0x06060a0cU,0x24246c48U,0x5c5ce4b8U,0xc2c25d9fU,0xd3d36ebdU,0xacacef43U,0x6262a6c4U,0x9191a839U,0x9595a431U,0xe4e437d3U,0x79798bf2U,0xe7e732d5U,0xc8c8438bU,0x3737596eU,0x6d6db7daU,0x8d8d8c01U,0xd5d564b1U,0x4e4ed29cU,0xa9a9e049U,0x6c6cb4d8U,0x5656faacU,0xf4f407f3U,0xeaea25cfU,0x6565afcaU,0x7a7a8ef4U,0xaeaee947U,0x08081810U,0xbabad56fU,0x787888f0U,0x25256f4aU,0x2e2e725cU,0x1c1c2438U,0xa6a6f157U,0xb4b4c773U,0xc6c65197U,0xe8e823cbU,0xdddd7ca1U,0x74749ce8U,0x1f1f213eU,0x4b4bdd96U,0xbdbddc61U,0x8b8b860dU,0x8a8a850fU,0x707090e0U,0x3e3e427cU,0xb5b5c471U,0x6666aaccU,0x4848d890U,0x03030506U,0xf6f601f7U,0x0e0e121cU,0x6161a3c2U,0x35355f6aU,0x5757f9aeU,0xb9b9d069U,0x86869117U,0xc1c15899U,0x1d1d273aU,0x9e9eb927U,0xe1e138d9U,0xf8f813ebU,0x9898b32bU,0x11113322U,0x6969bbd2U,0xd9d970a9U,0x8e8e8907U,0x9494a733U,0x9b9bb62dU,0x1e1e223cU,0x87879215U,0xe9e920c9U,0xcece4987U,0x5555ffaaU,0x28287850U,0xdfdf7aa5U,0x8c8c8f03U,0xa1a1f859U,0x89898009U,0x0d0d171aU,0xbfbfda65U,0xe6e631d7U,0x4242c684U,0x6868b8d0U,0x4141c382U,0x9999b029U,0x2d2d775aU,0x0f0f111eU,0xb0b0cb7bU,0x5454fca8U,0xbbbbd66dU,0x16163a2cU,};static const unsigned long rcon[]={0x01000000,0x02000000,0x04000000,0x08000000,0x10000000,0x20000000,0x40000000,0x80000000,0x1B000000,0x36000000,};int AES_set_encrypt_key(const unsigned char*userKey,const int bits,AES_KEY*key){unsigned long*rk;int i=0;unsigned long temp;if(!userKey||!key)return-1;if(bits!=128&&bits!=192&&bits!=256)return-2;rk=key->rd_key;if(bits==128)key->rounds=10;else if(bits==192)key->rounds=12;else key->rounds=14;rk[0]=(((unsigned long)(userKey)[3])^((unsigned long)(userKey)[2]<<8)^((unsigned long)(userKey)[1]<<16)^((unsigned long)(userKey)[0]<<24));rk[1]=(((unsigned long)(userKey+4)[3])^((unsigned long)(userKey+4)[2]<<8)^((unsigned long)(userKey+4)[1]<<16)^((unsigned long)(userKey+4)[0]<<24));rk[2]=(((unsigned long)(userKey+8)[3])^((unsigned long)(userKey+8)[2]<<8)^((unsigned long)(userKey+8)[1]<<16)^((unsigned long)(userKey+8)[0]<<24));rk[3]=(((unsigned long)(userKey+12)[3])^((unsigned long)(userKey+12)[2]<<8)^((unsigned long)(userKey+12)[1]<<16)^((unsigned long)(userKey+12)[0]<<24));if(bits==128){while(1){temp=rk[3];rk[4]=rk[0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[5]=rk[1]^rk[4];rk[6]=rk[2]^rk[5];rk[7]=rk[3]^rk[6];if(++i==10){return 0;}rk+=4;}}rk[4]=(((unsigned long)(userKey+16)[3])^((unsigned long)(userKey+16)[2]<<8)^((unsigned long)(userKey+16)[1]<<16)^((unsigned long)(userKey+16)[0]<<24));rk[5]=(((unsigned long)(userKey+20)[3])^((unsigned long)(userKey+20)[2]<<8)^((unsigned long)(userKey+20)[1]<<16)^((unsigned long)(userKey+20)[0]<<24));if(bits==192){while(1){temp=rk[ 5];rk[ 6]=rk[ 0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[ 7]=rk[ 1]^rk[ 6];rk[ 8]=rk[ 2]^rk[ 7];rk[ 9]=rk[ 3]^rk[ 8];if(++i==8){return 0;}rk[10]=rk[ 4]^rk[ 9];rk[11]=rk[ 5]^rk[10];rk+=6;}}rk[6]=(((unsigned long)(userKey+24)[3])^((unsigned long)(userKey+24)[2]<<8)^((unsigned long)(userKey+24)[1]<<16)^((unsigned long)(userKey+24)[0]<<24));rk[7]=(((unsigned long)(userKey+28)[3])^((unsigned long)(userKey+28)[2]<<8)^((unsigned long)(userKey+28)[1]<<16)^((unsigned long)(userKey+28)[0]<<24));if(bits==256){while(1){temp=rk[ 7];rk[ 8]=rk[ 0]^(Te2[(temp>>16)&0xff]&0xff000000)^(Te3[(temp>>8)&0xff]&0x00ff0000)^(Te0[(temp)&0xff]&0x0000ff00)^(Te1[(temp>>24)]&0x000000ff)^rcon[i];rk[ 9]=rk[ 1]^rk[ 8];rk[10]=rk[ 2]^rk[ 9];rk[11]=rk[ 3]^rk[10];if(++i==7){return 0;}temp=rk[11];rk[12]=rk[ 4]^(Te2[(temp>>24)]&0xff000000)^(Te3[(temp>>16)&0xff]&0x00ff0000)^(Te0[(temp>>8)&0xff]&0x0000ff00)^(Te1[(temp)&0xff]&0x000000ff);rk[13]=rk[ 5]^rk[12];rk[14]=rk[ 6]^rk[13];rk[15]=rk[ 7]^rk[14];rk+=8;}}return 0;}void AES_encrypt(const unsigned char*in,unsigned char*out,const AES_KEY*key){const unsigned long*rk;unsigned long s0,s1,s2,s3,t0,t1,t2,t3;int r;rk=key->rd_key;s0=(((unsigned long)(in)[3])^((unsigned long)(in)[2]<<8)^((unsigned long)(in)[1]<<16)^((unsigned long)(in)[0]<<24))^rk[0];s1=(((unsigned long)(in+4)[3])^((unsigned long)(in+4)[2]<<8)^((unsigned long)(in+4)[1]<<16)^((unsigned long)(in+4)[0]<<24))^rk[1];s2=(((unsigned long)(in+8)[3])^((unsigned long)(in+8)[2]<<8)^((unsigned long)(in+8)[1]<<16)^((unsigned long)(in+8)[0]<<24))^rk[2];s3=(((unsigned long)(in+12)[3])^((unsigned long)(in+12)[2]<<8)^((unsigned long)(in+12)[1]<<16)^((unsigned long)(in+12)[0]<<24))^rk[3];r=key->rounds>>1;for(;;){t0=Te0[(s0>>24)]^Te1[(s1>>16)&0xff]^Te2[(s2>>8)&0xff]^Te3[(s3)&0xff]^rk[4];t1=Te0[(s1>>24)]^Te1[(s2>>16)&0xff]^Te2[(s3>>8)&0xff]^Te3[(s0)&0xff]^rk[5];t2=Te0[(s2>>24)]^Te1[(s3>>16)&0xff]^Te2[(s0>>8)&0xff]^Te3[(s1)&0xff]^rk[6];t3=Te0[(s3>>24)]^Te1[(s0>>16)&0xff]^Te2[(s1>>8)&0xff]^Te3[(s2)&0xff]^rk[7];rk+=8;if(--r==0){break;}s0=Te0[(t0>>24)]^Te1[(t1>>16)&0xff]^Te2[(t2>>8)&0xff]^Te3[(t3)&0xff]^rk[0];s1=Te0[(t1>>24)]^Te1[(t2>>16)&0xff]^Te2[(t3>>8)&0xff]^Te3[(t0)&0xff]^rk[1];s2=Te0[(t2>>24)]^Te1[(t3>>16)&0xff]^Te2[(t0>>8)&0xff]^Te3[(t1)&0xff]^rk[2];s3=Te0[(t3>>24)]^Te1[(t0>>16)&0xff]^Te2[(t1>>8)&0xff]^Te3[(t2)&0xff]^rk[3];}s0=(Te2[(t0>>24)]&0xff000000)^(Te3[(t1>>16)&0xff]&0x00ff0000)^(Te0[(t2>>8)&0xff]&0x0000ff00)^(Te1[(t3)&0xff]&0x000000ff)^rk[0];{(out)[3]=(unsigned char)(s0);(out)[2]=(unsigned char)((s0)>>8);(out)[1]=(unsigned char)((s0)>>16);(out)[0]=(unsigned char)((s0)>>24);};s1=(Te2[(t1>>24)]&0xff000000)^(Te3[(t2>>16)&0xff]&0x00ff0000)^(Te0[(t3>>8)&0xff]&0x0000ff00)^(Te1[(t0)&0xff]&0x000000ff)^rk[1];{(out+4)[3]=(unsigned char)(s1);(out+4)[2]=(unsigned char)((s1)>>8);(out+4)[1]=(unsigned char)((s1)>>16);(out+4)[0]=(unsigned char)((s1)>>24);};s2=(Te2[(t2>>24)]&0xff000000)^(Te3[(t3>>16)&0xff]&0x00ff0000)^(Te0[(t0>>8)&0xff]&0x0000ff00)^(Te1[(t1)&0xff]&0x000000ff)^rk[2];{(out+8)[3]=(unsigned char)(s2);(out+8)[2]=(unsigned char)((s2)>>8);(out+8)[1]=(unsigned char)((s2)>>16);(out+8)[0]=(unsigned char)((s2)>>24);};s3=(Te2[(t3>>24)]&0xff000000)^(Te3[(t0>>16)&0xff]&0x00ff0000)^(Te0[(t1>>8)&0xff]&0x0000ff00)^(Te1[(t2)&0xff]&0x000000ff)^rk[3];{(out+12)[3]=(unsigned char)(s3);(out+12)[2]=(unsigned char)((s3)>>8);(out+12)[1]=(unsigned char)((s3)>>16);(out+12)[0]=(unsigned char)((s3)>>24);};}void checksum1(unsigned char crc[4],const unsigned char*buf,unsigned int sz){unsigned int sum=0xcafedeca;unsigned int i;for(i=0;i<sz;i++){sum+=buf[i];}for(i=0;i<4;i++){crc[3-i]=sum&0xff;sum>>=8;}}void checksum2(unsigned char crc[4],const unsigned char*buf,unsigned int sz){unsigned int sum=0xdeadface;unsigned int i;for(i=0;i<sz;i++){sum+=buf[i];}for(i=0;i<4;i++){crc[3-i]=sum&0xff;sum>>=8;}}int decrypt_cfb(int glob_sz,unsigned char*data,unsigned int data_sz,unsigned char iv[16],unsigned char key[16]){unsigned char tmp[16],state[16];AES_KEY akey;unsigned int i,j;unsigned char crc[4];AES_set_encrypt_key(key,128,&akey);checksum1(crc,data,data_sz);my_memcpy(shared_memory+glob_sz,crc,4);my_memcpy(tmp,iv,16);for(i=0;i<(data_sz/16)+1;i++){AES_encrypt(tmp,state,&akey);if(data_sz-16*i<16){my_memcpy(tmp,data+16*i,data_sz-16*i);for(j=0;j<(data_sz-16*i);j++){data[16*i+j]^=state[j];}}else{my_memcpy(tmp,data+16*i,16);for(j=0;j<16;j++){data[16*i+j]^=state[j];}}}my_memset(tmp,0xcc,16);my_memset(state,0xcc,16);my_memset(&akey,0xcc,sizeof(AES_KEY));return 0;}struct arbre{short branche0;short branche1;};struct arbre_data{unsigned long frequence;short index_suivant;};struct dictionnaire{unsigned char taille;char code[32];};short huffman_lire_frequences_buf(unsigned char*input,unsigned int*dec_sz);short huffman_creer_arbre(short index_frequence);unsigned char*huffman_uncompress(int global_sz,unsigned char*input,unsigned int input_sz,unsigned int*output_sz);struct arbre_data*arbre_d;struct arbre*arbre;struct dictionnaire*dico;short huffman_lire_frequences_buf(unsigned char*input,unsigned int*dec_sz){unsigned int offset;unsigned short nbre_ascii;unsigned char i;short index_frequence=-1,index_precedent=-1;offset=0;nbre_ascii=(input[1]<<8)|input[0];offset+=2;while(nbre_ascii>0){i=input[offset];offset++;my_memcpy((char*)&arbre_d[i].frequence,input+offset,4);offset+=4;if(index_frequence==-1)index_frequence=i;else arbre_d[index_precedent].index_suivant=i;index_precedent=i;nbre_ascii--;}*dec_sz=offset;if(index_precedent==-1)return-1;arbre_d[index_precedent].index_suivant=-1;return index_frequence;}short huffman_creer_arbre(short index_frequence){short i,j,j_save;unsigned long somme_frequence;short nbre_noeuds=256;char struct_inseree=0;for(j=0;j<256;j++)arbre[j].branche0=arbre[j].branche1=-1;i=index_frequence;while(i!=-1){if(arbre_d[i].index_suivant==-1){break;}somme_frequence=arbre_d[i].frequence+arbre_d[arbre_d[i].index_suivant].frequence;arbre_d[nbre_noeuds].frequence=somme_frequence;arbre[nbre_noeuds].branche0=arbre_d[i].index_suivant;arbre[nbre_noeuds].branche1=i;j_save=-1;struct_inseree=0;j=i;while(j!=-1&&struct_inseree==0){if(arbre_d[j].frequence>=somme_frequence){if(j_save!=-1)arbre_d[j_save].index_suivant=nbre_noeuds;arbre_d[nbre_noeuds].index_suivant=j;struct_inseree=1;}j_save=j;j=arbre_d[j].index_suivant;}if(struct_inseree==0){arbre_d[j_save].index_suivant=nbre_noeuds;arbre_d[nbre_noeuds].index_suivant=-1;}nbre_noeuds++;i=arbre_d[i].index_suivant;i=arbre_d[i].index_suivant;}return nbre_noeuds-1;}unsigned char*huffman_uncompress(int glob_sz,unsigned char*input,unsigned int input_sz,unsigned int*output_sz){unsigned int i,j,k,offset_in,offset_out,r,dec;unsigned long nbre_octets;unsigned char bit_r;short index_frequence;short racine_arbre;unsigned char*tmp;unsigned char crc[4];unsigned char buffer[32];offset_in=0;offset_out=0;nbre_octets=(input[3]<<24)|(input[2]<<16)|(input[1]<<8)|input[0];offset_in+=4;tmp=(unsigned char*)my_malloc(nbre_octets*sizeof(unsigned char));index_frequence=huffman_lire_frequences_buf(input+offset_in,&dec);offset_in+=dec;racine_arbre=huffman_creer_arbre(index_frequence);j=racine_arbre;while(offset_in<input_sz){if(offset_in+32<input_sz){r=32;}else{r=input_sz-offset_in;}my_memcpy(buffer,input+offset_in,r);for(i=0;i<r&&nbre_octets>0;i++){for(bit_r=0x80;bit_r!=0&&nbre_octets>0;bit_r>>=1){if(buffer[i]&bit_r)j=arbre[j].branche1;else j=arbre[j].branche0;if((arbre[j].branche0==-1)||(arbre[j].branche1==-1)){tmp[offset_out]=(unsigned char)j;offset_out++;nbre_octets--;j=racine_arbre;}}}offset_in+=r;}checksum2(crc,tmp,offset_out);my_memcpy(shared_memory+glob_sz+4,crc,4);*output_sz=offset_out;return tmp;}
void puf1(unsigned char*kpuf){int i;unsigned int x;x=0x12345678;for(i=0;i<16;i++){x=76543*x+6543254321;kpuf[i]^=(x>>3)&0xff;}}void puf2(unsigned char*kpuf){int i;unsigned int x;x=0x31415927;for(i=0;i<16;i++){x=2021*x+0x22082021;kpuf[i]=(x>>7)&0xff;}}void target_function(unsigned char*output,unsigned int output_sz,unsigned char*input,unsigned int input_sz){vm_t vm;unsigned int sz,imageSize=0;struct basE91 bb;unsigned char iv[16]={0},key[16];unsigned char*out;int i,offset=0;int glob_sz;int argv[2],argc;puf2(key);argv[0]=input_sz;argv[1]=output_sz;argc=2;glob_sz=(input_sz>output_sz)? input_sz : output_sz;basE91_init(&bb);imageSize=basE91_decode(&bb,opcodes_none,sizeof(opcodes_none),opcodes_none);imageSize+=basE91_decode_end(&bb,opcodes_none+imageSize);if((arbre_d=(struct arbre_data*)my_malloc(512*sizeof(struct arbre_data)))==NULL){return;}if((arbre=(struct arbre*)my_malloc(512*sizeof(struct arbre)))==NULL){my_free(arbre_d);return;}puf1(key);decrypt_cfb(glob_sz,opcodes_none,imageSize,iv,key);out=huffman_uncompress(glob_sz,opcodes_none,imageSize,&sz);if(VM_Create(&vm,out,sz,systemCalls)==0){my_memcpy(shared_memory,input,input_sz*sizeof(unsigned char));VM_Call(offset,glob_sz,&vm,argv,argc);my_memcpy(output,shared_memory,output_sz*sizeof(unsigned char));}VM_Free(&vm);my_free(out);my_free(arbre_d);my_free(arbre);}
unsigned char nx[32]={0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xbc,0xe6,0xfa,0xad,0xa7,0x17,0x9e,0x84,0xf3,0xb9,0xca,0xc2,0xfc,0x63,0x25,0x51};unsigned char px[32]={0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};typedef struct point{mpz_t x,y;}__Point;typedef __Point Point[1];void point_init(Point P){mpz_inits(P->x,P->y,NULL);}void point_clear(Point P){mpz_clears(P->x,P->y,NULL);}void point_init_set_str(Point P,const char*x_str,const char*y_str,int base){mpz_init_set_str(P->x,x_str,base);mpz_init_set_str(P->y,y_str,base);}void point_init_infinity(Point P){mpz_init_set_ui(P->x,0);mpz_init_set_ui(P->y,0);}int point_is_infinity(Point P){return(mpz_cmp_ui(P->x,0)==0)&&(mpz_cmp_ui(P->y,0)==0);}int point_equal(Point P,Point Q){return(mpz_cmp(P->x,Q->x)==0)&&(mpz_cmp(P->y,Q->y)==0);}int point_is_inverse(Point P,Point Q){int comp=mpz_cmp(P->x,Q->x)==0;if(comp!=1){return comp;}mpz_t Q_y_neg;mpz_init(Q_y_neg);mpz_neg(Q_y_neg,Q->y);comp=mpz_cmp(P->y,Q_y_neg)==0;mpz_clear(Q_y_neg);return comp;}void point_set(Point R,Point P){mpz_set(R->x,P->x);mpz_set(R->y,P->y);}void point_add(Point R,Point P,Point Q,mpz_t a,mpz_t p){if(point_is_infinity(P)){point_set(R,Q);return;}else if(point_is_infinity(Q)){point_set(R,P);return;}if(point_is_inverse(P,Q)){point_init_infinity(R);return;}mpz_t lambda,denominator;mpz_inits(lambda,denominator,NULL);if(P==Q||point_equal(P,Q)){mpz_powm_ui(lambda,P->x,2,p);mpz_mul_ui(lambda,lambda,3);mpz_add(lambda,lambda,a);mpz_mul_ui(denominator,P->y,2);mpz_invert(denominator,denominator,p);}else{mpz_sub(lambda,Q->y,P->y);mpz_sub(denominator,Q->x,P->x);mpz_invert(denominator,denominator,p);}mpz_mul(lambda,lambda,denominator);mpz_mod(lambda,lambda,p);mpz_powm_ui(R->x,lambda,2,p);mpz_sub(R->x,R->x,P->x);mpz_sub(R->x,R->x,Q->x);mpz_mod(R->x,R->x,p);mpz_sub(R->y,P->x,R->x);mpz_mul(R->y,lambda,R->y);mpz_mod(R->y,R->y,p);mpz_sub(R->y,R->y,P->y);mpz_mod(R->y,R->y,p);mpz_clears(lambda,denominator,NULL);}void point_scalar(Point R,Point P,mpz_t scalar,mp_bitcnt_t num_bits,mpz_t a,mpz_t p){Point tmp;point_init(tmp);for(mp_bitcnt_t i=num_bits-1;i>=0&&i<num_bits;i--){point_add(tmp,R,R,a,p);if(mpz_tstbit(scalar,i)==1){point_add(R,tmp,P,a,p);}else{point_set(R,tmp);}}point_clear(tmp);}void ECDSA_256_sign(unsigned char sig[64],unsigned char hash[32]){int i;unsigned char input[32+32+32];mpz_t p,a,n,z,u;mpz_init(p);mpz_import(p,32,1,1,1,0,px);mpz_init(a);mpz_sub_ui(a,p,3);mpz_init(n);mpz_import(n,32,1,1,1,0,nx);for(i=0;i<32;i++){hash[i]^=(i+0x51);}mpz_init(z);mpz_init(u);mpz_import(u,32,1,1,1,0,hash);mpz_mod(z,u,n);mpz_clear(u);Point Gn,T,U,tmp;point_init(tmp);point_init(Gn);point_init(T);mpz_import(Gn->x,32,1,1,1,0,Gx[D-1]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-1]);point_scalar(T,Gn,z,256,a,p);mpz_import(Gn->x,32,1,1,1,0,Gx[D-2]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-2]);point_add(tmp,T,Gn,a,p);point_set(T,tmp);for(i=3;i<D+1;i++){point_scalar(tmp,T,z,256,a,p);mpz_import(Gn->x,32,1,1,1,0,Gx[D-i]);mpz_import(Gn->y,32,1,1,1,0,Gy[D-i]);point_add(T,tmp,Gn,a,p);}point_clear(tmp);mpz_export(input,NULL,1,32,1,0,z);mpz_export(input+32,NULL,1,32,1,0,T->x);mpz_export(input+64,NULL,1,32,1,0,T->y);target_function(sig+32,32,input,96);mpz_mod(z,T->x,n);mpz_export(sig,NULL,1,32,1,0,z);point_clear(T);mpz_import(a,32,1,1,1,0,sig+32);mpz_mod(z,a,n);mpz_export(sig+32,NULL,1,32,1,0,z);mpz_clears(p,a,n,z,NULL);}

